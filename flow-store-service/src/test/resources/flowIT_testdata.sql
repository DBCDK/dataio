--
-- PostgreSQL database dump
--

-- Dumped from database version 9.5.4
-- Dumped by pg_dump version 9.5.4

SET statement_timeout = 0;
SET lock_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SET check_function_bodies = false;
SET client_min_messages = warning;
SET row_security = off;

SET search_path = public, pg_catalog;

--
-- Data for Name: flow_components; Type: TABLE DATA; Schema: public; Owner: ja7
--

INSERT INTO flow_components VALUES (2152, '{"name": "smaTest9", "description": "Test af oprettelse med \"next\"", "javascripts": [], "svnRevision": 87446, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'smaTest9', 2, '{"name": "smaTest9", "description": "Test af oprettelse med \"next\"", "javascripts": [], "svnRevision": 87446, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (1001, '{"name": "flowK nr 1", "description": "første flowkomponent til flow mere flere flowkomponenter", "javascripts": [], "svnRevision": 82807, "requireCache": "", "invocationMethod": "flowComponentOne", "invocationJavascriptName": "trunk/flowcomponentOne.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}', 'flowK nr 1', 5, '{"name": "flowK nr 1", "description": "første flowkomponent til flow mere flere flowkomponenter", "javascripts": [], "svnRevision": 82807, "requireCache": "", "invocationMethod": "flowComponentOne", "invocationJavascriptName": "trunk/flowcomponentOne.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}');
INSERT INTO flow_components VALUES (901, '{"name": "Steens Nye Flowkomponent", "javascripts": [], "svnRevision": 82608, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'Steens Nye Flowkomponent', 1, '{"name": "Steens Nye Flowkomponent", "javascripts": [], "svnRevision": 82608, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (2851, '{"name": "sma test", "description": "testing", "javascripts": [], "svnRevision": 91492, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/xml_datawell_3.0.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'sma test', 2, '{"name": "sma test", "description": "testing", "javascripts": [], "svnRevision": 91492, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/xml_datawell_3.0.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (651, '{"name": "smaTest12", "description": "Dette er en ny fin beskrivelse", "javascripts": [], "svnRevision": 78955, "requireCache": "", "invocationMethod": "funA", "invocationJavascriptName": "trunk/integration-test/gui-selenium/src/test/test-projects/main/trunk/main.js", "svnProjectForInvocationJavascript": "dataio"}', 'smaTest12', 13, '{"name": "smaTest12", "description": "Dette er en ny fin beskrivelse", "javascripts": [], "svnRevision": 78955, "requireCache": "", "invocationMethod": "funA", "invocationJavascriptName": "trunk/integration-test/gui-selenium/src/test/test-projects/main/trunk/main.js", "svnProjectForInvocationJavascript": "dataio"}');
INSERT INTO flow_components VALUES (801, '{"name": "HiveFejl", "description": "til fremprovokering af fejl i hive", "javascripts": [], "svnRevision": 79125, "requireCache": "", "invocationMethod": "createHiveErrorFromFbsRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'HiveFejl', 2, '{"name": "HiveFejl", "description": "til fremprovokering af fejl i hive", "javascripts": [], "svnRevision": 79125, "requireCache": "", "invocationMethod": "createHiveErrorFromFbsRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (855, '{"name": "ØKP test", "description": "skal slettes", "javascripts": [], "svnRevision": 81689, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'ØKP test', 4, '{"name": "ØKP test", "description": "skal slettes", "javascripts": [], "svnRevision": 81689, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (753, '{"name": "RR2BrøndExttest - skal slettes", "description": "skal slettes", "javascripts": [], "svnRevision": 83662, "requireCache": "", "invocationMethod": "convertRawRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'RR2BrøndExttest - skal slettes', 6, '{"name": "RR2BrøndExttest - skal slettes", "description": "skal slettes", "javascripts": [], "svnRevision": 83662, "requireCache": "", "invocationMethod": "convertRawRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (854, '{"name": "FFU forbehandling", "description": "Forbehandling af poster fra FFU-bibliotekerne på vej til råpost repo", "javascripts": [], "svnRevision": 102019, "requireCache": "", "invocationMethod": "prepareResearchRecordForRawRepo", "invocationJavascriptName": "trunk/js/marcx_io_raw_repo.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'FFU forbehandling', 64, '{"name": "FFU forbehandling", "description": "Forbehandling af poster fra FFU-bibliotekerne på vej til råpost repo", "javascripts": [], "svnRevision": 102019, "requireCache": "", "invocationMethod": "prepareResearchRecordForRawRepo", "invocationJavascriptName": "trunk/js/marcx_io_raw_repo.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (701, '{"name": "rtrt", "description": "skal slettes", "javascripts": [], "svnRevision": 78828, "requireCache": "", "invocationMethod": "createDatawellXmlFromTS1001", "invocationJavascriptName": "trunk/js/xml_datawell_3.0.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'rtrt', 6, '{"name": "rtrt", "description": "skal slettes", "javascripts": [], "svnRevision": 78828, "requireCache": "", "invocationMethod": "createDatawellXmlFromTS1001", "invocationJavascriptName": "trunk/js/xml_datawell_3.0.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (52, '{"name": "tracer-bullet-component", "description": "Minimalt script til basal system test", "javascripts": [], "svnRevision": 1, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "tracer-bullet-javascript", "svnProjectForInvocationJavascript": "svnprojectforinvocationjavascript"}', 'tracer-bullet-component', 1, '{"name": "tracer-bullet-component", "description": "Minimalt script til basal system test", "javascripts": [], "svnRevision": 1, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "tracer-bullet-javascript", "svnProjectForInvocationJavascript": "svnprojectforinvocationjavascript"}');
INSERT INTO flow_components VALUES (2859, '{"name": "sma special test", "description": "test test", "javascripts": [], "svnRevision": 91492, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/xml_datawell_3.0.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'sma special test', 2, '{"name": "sma special test", "description": "test test", "javascripts": [], "svnRevision": 91492, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/xml_datawell_3.0.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (2054, '{"name": "smaTest4", "description": "test noget mere", "javascripts": [], "svnRevision": 87332, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}', 'smaTest4', 2, '{"name": "smaTest4", "description": "test noget mere", "javascripts": [], "svnRevision": 87332, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}');
INSERT INTO flow_components VALUES (652, '{"name": "smaTest2", "description": "Description.", "javascripts": [], "svnRevision": 78580, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/xml_datawell_3.0.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'smaTest2', 2, '{"name": "smaTest2", "description": "Description.", "javascripts": [], "svnRevision": 78580, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/xml_datawell_3.0.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (2, '{"name": "RR2FBS", "description": "Poster der skal til FBS Webservice - næsten uændret - vi fjerner DBCs bogstavfelter", "javascripts": [], "svnRevision": 96972, "requireCache": "", "invocationMethod": "transportRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'RR2FBS', 20, '{"name": "RR2FBS", "description": "Poster der skal til FBS Webservice - næsten uændret - vi fjerner DBCs bogstavfelter", "javascripts": [], "svnRevision": 96972, "requireCache": "", "invocationMethod": "transportRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (4903, '{"name": "FBS_Edu_forbehandling", "description": "Flowkomponent som forbehandler en post til FBS Uddannelsessystemet", "javascripts": [], "svnRevision": 100233, "requireCache": "", "invocationMethod": "prepareFbsEducationRecordForRawRepo", "invocationJavascriptName": "trunk/js/marcx_io_raw_repo.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'FBS_Edu_forbehandling', 4, '{"name": "FBS_Edu_forbehandling", "description": "Flowkomponent som forbehandler en post til FBS Uddannelsessystemet", "javascripts": [], "svnRevision": 100233, "requireCache": "", "invocationMethod": "prepareFbsEducationRecordForRawRepo", "invocationJavascriptName": "trunk/js/marcx_io_raw_repo.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (7, '{"name": "RR2Brønd", "description": "Almindeligt brøndkonverteringsflow fra Råpost Repo til displaybrønden", "javascripts": [], "svnRevision": 101424, "requireCache": "", "invocationMethod": "convertRawRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'RR2Brønd', 50, '{"name": "RR2Brønd", "description": "Almindeligt brøndkonverteringsflow fra Råpost Repo til displaybrønden", "javascripts": [], "svnRevision": 101424, "requireCache": "", "invocationMethod": "convertRawRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (851, '{"name": "ÅKP test", "description": "skal slettes.", "javascripts": [], "svnRevision": 81689, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'ÅKP test', 3, '{"name": "ÅKP test", "description": "skal slettes.", "javascripts": [], "svnRevision": 81689, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (853, '{"name": "ZKP test", "description": "skal slettes", "javascripts": [], "svnRevision": 81689, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'ZKP test', 4, '{"name": "ZKP test", "description": "skal slettes", "javascripts": [], "svnRevision": 81689, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (852, '{"name": "AKP test", "description": "skal slettes", "javascripts": [], "svnRevision": 81689, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'AKP test', 7, '{"name": "AKP test", "description": "skal slettes", "javascripts": [], "svnRevision": 81689, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (2255, '{"name": "smaTest1", "description": "Test af markering af nyoprettet flow komponent i oversigten.", "javascripts": [], "svnRevision": 87519, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'smaTest1', 2, '{"name": "smaTest1", "description": "Test af markering af nyoprettet flow komponent i oversigten.", "javascripts": [], "svnRevision": 87519, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (1901, '{"name": "E4X-brønd", "description": "Brøndkonvertering stadig med E4X", "javascripts": [], "svnRevision": 83776, "requireCache": "", "invocationMethod": "convertRawRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'E4X-brønd', 12, '{"name": "E4X-brønd", "description": "Brøndkonvertering stadig med E4X", "javascripts": [], "svnRevision": 83776, "requireCache": "", "invocationMethod": "convertRawRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (1907, '{"name": "demo1", "description": "test komponent", "javascripts": [], "svnRevision": 87060, "requireCache": "", "invocationMethod": "jeg_kan_lige_saa_godt_sige_det_som_det_er", "invocationJavascriptName": "trunk/demo_script.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}', 'demo1', 17, '{"name": "demo1", "description": "test komponent", "javascripts": [], "svnRevision": 87060, "requireCache": "", "invocationMethod": "jeg_kan_lige_saa_godt_sige_det_som_det_er", "invocationJavascriptName": "trunk/demo_script.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}');
INSERT INTO flow_components VALUES (1951, '{"name": "kbp demo", "description": "demo skal settes", "javascripts": [], "svnRevision": 87060, "requireCache": "", "invocationMethod": "jeg_kan_lige_saa_godt_sige_det_som_det_er", "invocationJavascriptName": "trunk/demo_script.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}', 'kbp demo', 1, '{"name": "kbp demo", "description": "demo skal settes", "javascripts": [], "svnRevision": 87060, "requireCache": "", "invocationMethod": "jeg_kan_lige_saa_godt_sige_det_som_det_er", "invocationJavascriptName": "trunk/demo_script.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}');
INSERT INTO flow_components VALUES (653, '{"name": "smaTest3", "description": "Bør slettes....", "javascripts": [], "svnRevision": 78665, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'smaTest3', 12, '{"name": "smaTest3", "description": "Bør slettes....", "javascripts": [], "svnRevision": 78665, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (2051, '{"name": "sma", "description": "test more because javaScriptProjectFetcher is sloooow", "javascripts": [], "svnRevision": 87332, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}', 'sma', 6, '{"name": "sma", "description": "test more because javaScriptProjectFetcher is sloooow", "javascripts": [], "svnRevision": 87332, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}');
INSERT INTO flow_components VALUES (2052, '{"name": "smaTest", "description": "Skal slettes", "javascripts": [], "svnRevision": 87332, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}', 'smaTest', 2, '{"name": "smaTest", "description": "Skal slettes", "javascripts": [], "svnRevision": 87332, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}');
INSERT INTO flow_components VALUES (1201, '{"name": "require-tracebullet", "description": "tracebullet der bruge require", "javascripts": [], "svnRevision": 83597, "requireCache": "", "invocationMethod": "tracerbullet_xmldom", "invocationJavascriptName": "trunk/tracerBulletXmlDom.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}', 'require-tracebullet', 7, '{"name": "require-tracebullet", "description": "tracebullet der bruge require", "javascripts": [], "svnRevision": 83597, "requireCache": "", "invocationMethod": "tracerbullet_xmldom", "invocationJavascriptName": "trunk/tracerBulletXmlDom.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}');
INSERT INTO flow_components VALUES (2061, '{"name": "smaTest5", "description": "testing", "javascripts": [], "svnRevision": 87339, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}', 'smaTest5', 1, '{"name": "smaTest5", "description": "testing", "javascripts": [], "svnRevision": 87339, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}');
INSERT INTO flow_components VALUES (102, '{"name": "Bibzoom Album", "description": "Konvertering af bibzoom album poster til brønd", "javascripts": [], "svnRevision": 77345, "requireCache": "", "invocationMethod": "createDatawellXmlFromBibzoomAlbums", "invocationJavascriptName": "trunk/js/xml_datawell_3.0.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'Bibzoom Album', 4, '{"name": "Bibzoom Album", "description": "Konvertering af bibzoom album poster til brønd", "javascripts": [], "svnRevision": 77345, "requireCache": "", "invocationMethod": "createDatawellXmlFromBibzoomAlbums", "invocationJavascriptName": "trunk/js/xml_datawell_3.0.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (1002, '{"name": "flowK nr 2", "description": "anden flowkomponent til flow mere flere flowkomponenter", "javascripts": [], "svnRevision": 82808, "requireCache": "", "invocationMethod": "flowComponentTwo", "invocationJavascriptName": "trunk/flowcomponentTwo.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}', 'flowK nr 2', 6, '{"name": "flowK nr 2", "description": "anden flowkomponent til flow mere flere flowkomponenter", "javascripts": [], "svnRevision": 82808, "requireCache": "", "invocationMethod": "flowComponentTwo", "invocationJavascriptName": "trunk/flowcomponentTwo.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}');
INSERT INTO flow_components VALUES (2062, '{"name": "smaTest6", "description": "Jeg ønsker mig en slet knap...", "javascripts": [], "svnRevision": 87339, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}', 'smaTest6', 1, '{"name": "smaTest6", "description": "Jeg ønsker mig en slet knap...", "javascripts": [], "svnRevision": 87339, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}');
INSERT INTO flow_components VALUES (4053, '{"name": "nashorn test", "description": "nashorn performance test", "javascripts": [], "svnRevision": 97750, "requireCache": "", "invocationMethod": "main", "invocationJavascriptName": "trunk/nashorn_test.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}', 'nashorn test', 2, '{"name": "nashorn test", "description": "nashorn performance test", "javascripts": [], "svnRevision": 97750, "requireCache": "", "invocationMethod": "main", "invocationJavascriptName": "trunk/nashorn_test.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}');
INSERT INTO flow_components VALUES (3402, '{"name": "SLET MIG", "description": "SLET DENNE!", "javascripts": [], "svnRevision": 94625, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}', 'SLET MIG', 4, '{"name": "SLET MIG", "description": "SLET DENNE!", "javascripts": [], "svnRevision": 94625, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}');
INSERT INTO flow_components VALUES (4056, '{"name": "nashorn single script test", "description": "nashorn uden brug af dbc modul system", "javascripts": [], "svnRevision": 97757, "requireCache": "", "invocationMethod": "main", "invocationJavascriptName": "trunk/nashorn_single_script_test.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}', 'nashorn single script test', 2, '{"name": "nashorn single script test", "description": "nashorn uden brug af dbc modul system", "javascripts": [], "svnRevision": 97757, "requireCache": "", "invocationMethod": "main", "invocationJavascriptName": "trunk/nashorn_single_script_test.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}');
INSERT INTO flow_components VALUES (1451, '{"name": "specialTegnstest_2-3 4", "description": "skal slettes", "javascripts": [], "svnRevision": 84603, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'specialTegnstest_2-3 4', 3, '{"name": "specialTegnstest_2-3 4", "description": "skal slettes", "javascripts": [], "svnRevision": 84603, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (1601, '{"name": "RR2basis", "description": "almindeligt flow fra Råpost Repo til basis - posten kører uændret igennem men der sættes flag for at posten skal konverteres til iso2709 i sinken", "javascripts": [], "svnRevision": 96972, "requireCache": "", "invocationMethod": "convertRawRecordToBasis", "invocationJavascriptName": "trunk/js/marc_basis.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'RR2basis', 6, '{"name": "RR2basis", "description": "almindeligt flow fra Råpost Repo til basis - posten kører uændret igennem men der sættes flag for at posten skal konverteres til iso2709 i sinken", "javascripts": [], "svnRevision": 96972, "requireCache": "", "invocationMethod": "convertRawRecordToBasis", "invocationJavascriptName": "trunk/js/marc_basis.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (2063, '{"name": "smaTest7", "description": "Skal slettes", "javascripts": [], "svnRevision": 87278, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'smaTest7', 10, '{"name": "smaTest7", "description": "Skal slettes", "javascripts": [], "svnRevision": 87278, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (2351, '{"name": "diff-test", "description": "Simpelt sandkasse projekt benyttet i forbindelse med afprøvning af diff funktionalitet.", "javascripts": [], "svnRevision": 87987, "requireCache": "", "invocationMethod": "convert", "invocationJavascriptName": "trunk/js/converter.js", "svnProjectForInvocationJavascript": "dataio-diff-test"}', 'diff-test', 7, '{"name": "diff-test", "description": "Simpelt sandkasse projekt benyttet i forbindelse med afprøvning af diff funktionalitet.", "javascripts": [], "svnRevision": 87987, "requireCache": "", "invocationMethod": "convert", "invocationJavascriptName": "trunk/js/converter.js", "svnProjectForInvocationJavascript": "dataio-diff-test"}');
INSERT INTO flow_components VALUES (1751, '{"name": "TestCreateWithDescription", "description": "Testing description field.", "javascripts": [], "svnRevision": 86242, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}', 'TestCreateWithDescription', 1, '{"name": "TestCreateWithDescription", "description": "Testing description field.", "javascripts": [], "svnRevision": 86242, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "trunk/performance-test/src/test/resources/jda.js", "svnProjectForInvocationJavascript": "dataio"}');
INSERT INTO flow_components VALUES (1902, '{"name": "XMLDOM-brønd", "description": "Brøndkonvertering nu med XMLDOM og ikke længere E4X. ", "javascripts": [], "svnRevision": 87727, "requireCache": "", "invocationMethod": "convertRawRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'XMLDOM-brønd', 13, '{"name": "XMLDOM-brønd", "description": "Brøndkonvertering nu med XMLDOM og ikke længere E4X. ", "javascripts": [], "svnRevision": 87727, "requireCache": "", "invocationMethod": "convertRawRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}');
INSERT INTO flow_components VALUES (2064, '{"name": "smaTest8", "description": "Test af update med \"Next\"", "javascripts": [], "svnRevision": 87278, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}', 'smaTest8', 26, '{"name": "smaTest8", "description": "Test af update med \"Next\"", "javascripts": [], "svnRevision": 87278, "requireCache": "", "invocationMethod": "begin", "invocationJavascriptName": "trunk/js/cql_xml_to_html.js", "svnProjectForInvocationJavascript": "datawell-convert"}');


--
-- Data for Name: flows; Type: TABLE DATA; Schema: public; Owner: ja7
--

INSERT INTO flows VALUES (2352, '{"name": "diff-test", "components": [{"id": 2351, "next": {"name": "diff-test", "description": "Simpelt sandkasse projekt benyttet i forbindelse med afprøvning af diff funktionalitet.", "javascripts": [], "svnRevision": 88145, "requireCache": "", "invocationMethod": "convert", "invocationJavascriptName": "trunk/js/converter.js", "svnProjectForInvocationJavascript": "dataio-diff-test"}, "content": {"name": "diff-test", "description": "Simpelt sandkasse projekt benyttet i forbindelse med afprøvning af diff funktionalitet.", "javascripts": [], "svnRevision": 87987, "requireCache": "", "invocationMethod": "convert", "invocationJavascriptName": "trunk/js/converter.js", "svnProjectForInvocationJavascript": "dataio-diff-test"}, "version": 7}], "description": "Simpelt test flow benyttet i forbindelse med afprøvning af diff funktionalitet."}', 5);
INSERT INTO flows VALUES (9, '{"name": "RR2Brønd", "components": [{"id": 7, "next": {"name": "RR2Brønd", "description": "Almindeligt brøndkonverteringsflow fra Råpost Repo til displaybrønden", "javascripts": [], "svnRevision": 101436, "requireCache": "", "invocationMethod": "convertRawRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}, "content": {"name": "RR2Brønd", "description": "Almindeligt brøndkonverteringsflow fra Råpost Repo til displaybrønden", "javascripts": [], "svnRevision": 101424, "requireCache": "", "invocationMethod": "convertRawRecord", "invocationJavascriptName": "trunk/js/marc_fbs.js", "svnProjectForInvocationJavascript": "datawell-convert"}, "version": 50}], "description": "Jacascriptbehandling af poster fra RR til Brønd 3.5"}', 30);
INSERT INTO flows VALUES (4054, '{"name": "nashorn test", "components": [{"id": 4053, "next": {"name": "nashorn test", "description": "nashorn performance test", "javascripts": [], "svnRevision": 97750, "requireCache": "", "invocationMethod": "main", "invocationJavascriptName": "trunk/nashorn_test.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}, "content": {"name": "nashorn test", "description": "nashorn performance test", "javascripts": [], "svnRevision": 97750, "requireCache": "", "invocationMethod": "main", "invocationJavascriptName": "trunk/nashorn_test.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}, "version": 2}], "description": "nashorn performance test"}', 1);
INSERT INTO flows VALUES (1602, '{"name": "RR2basis", "components": [{"id": 1601, "next": {"name": "RR2basis", "description": "almindeligt flow fra Råpost Repo til basis - posten kører uændret igennem men der sættes flag for at posten skal konverteres til iso2709 i sinken", "javascripts": [], "svnRevision": 96972, "requireCache": "", "invocationMethod": "convertRawRecordToBasis", "invocationJavascriptName": "trunk/js/marc_basis.js", "svnProjectForInvocationJavascript": "datawell-convert"}, "content": {"name": "RR2basis", "description": "almindeligt flow fra Råpost Repo til basis - posten kører uændret igennem men der sættes flag for at posten skal konverteres til iso2709 i sinken", "javascripts": [], "svnRevision": 96972, "requireCache": "", "invocationMethod": "convertRawRecordToBasis", "invocationJavascriptName": "trunk/js/marc_basis.js", "svnProjectForInvocationJavascript": "datawell-convert"}, "version": 6}], "description": "flow der kun pakker en post fra RR i addi-format, så den kan overleveres til en ES-basis-sink og videre derfra til Basis"}', 3);
INSERT INTO flows VALUES (4057, '{"name": "nashorn single script test", "components": [{"id": 4056, "next": {"name": "nashorn single script test", "description": "nashorn uden brug af dbc modul system", "javascripts": [], "svnRevision": 97757, "requireCache": "", "invocationMethod": "main", "invocationJavascriptName": "trunk/nashorn_single_script_test.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}, "content": {"name": "nashorn single script test", "description": "nashorn uden brug af dbc modul system", "javascripts": [], "svnRevision": 97757, "requireCache": "", "invocationMethod": "main", "invocationJavascriptName": "trunk/nashorn_single_script_test.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}, "version": 2}], "description": "nashorn uden brug af dbc modul system"}', 1);
INSERT INTO flows VALUES (3151, '{"name": "FFU2RR", "components": [{"id": 854, "next": {"name": "FFU forbehandling", "description": "Forbehandling af poster fra FFU-bibliotekerne på vej til råpost repo", "javascripts": [], "svnRevision": 102019, "requireCache": "", "invocationMethod": "prepareResearchRecordForRawRepo", "invocationJavascriptName": "trunk/js/marcx_io_raw_repo.js", "svnProjectForInvocationJavascript": "datawell-convert"}, "content": {"name": "FFU forbehandling", "description": "Forbehandling af poster fra FFU-bibliotekerne på vej til råpost repo", "javascripts": [], "svnRevision": 102019, "requireCache": "", "invocationMethod": "prepareResearchRecordForRawRepo", "invocationJavascriptName": "trunk/js/marcx_io_raw_repo.js", "svnProjectForInvocationJavascript": "datawell-convert"}, "version": 64}], "description": "Forbehandling af FFU-poster på vej til Råpost Repo"}', 23);
INSERT INTO flows VALUES (53, '{"name": "tracer-bullet-flow", "components": [{"id": 52, "next": null, "content": {"name": "tracer-bullet-component", "description": "Minimalt script til basal system test", "javascripts": [], "svnRevision": 1, "requireCache": "", "invocationMethod": "invocationFunction", "invocationJavascriptName": "tracer-bullet-javascript", "svnProjectForInvocationJavascript": "svnprojectforinvocationjavascript"}, "version": 1}], "description": "description"}', 2);
INSERT INTO flows VALUES (1003, '{"name": "Flere flowkomponenter", "components": [{"id": 1001, "next": {"name": "flowK nr 1", "description": "første flowkomponent til flow mere flere flowkomponenter", "javascripts": [], "svnRevision": 87684, "requireCache": "", "invocationMethod": "flowComponentOne", "invocationJavascriptName": "trunk/flowcomponentOne.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}, "content": {"name": "flowK nr 1", "description": "første flowkomponent til flow mere flere flowkomponenter", "javascripts": [], "svnRevision": 82807, "requireCache": "", "invocationMethod": "flowComponentOne", "invocationJavascriptName": "trunk/flowcomponentOne.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}, "version": 5}, {"id": 1002, "next": null, "content": {"name": "flowK nr 2", "description": "anden flowkomponent til flow mere flere flowkomponenter", "javascripts": [{"javascript": "dXNlKCAiTG9nIiApOyAKCmZ1bmN0aW9uIGZsb3dDb21wb25lbnRUd28oIHJlY29yZCwgc3VibWl0dGVyX2Zvcm1hdCApIHsKICAgIExvZy5pbmZvKCAiRW50ZXJpbmc6IGZsb3dDb21wb25lbnRUd28gZnVuY3Rpb24iICk7CgogICAgTG9nLmluZm8gKCAiVGhlIHJlY29yZCBpcz0gIiwgcmVjb3JkICk7CgogICAgaWYgKCB1bmRlZmluZWQgIT09IHN1Ym1pdHRlcl9mb3JtYXQgKSB7CiAgICAgICAgTG9nLmluZm8oICJUaGUgc3VibWl0dGVyIGFuZCBmb3JtYXQgYXJlIGFsc28gcGFzc2VkIGZyb20gb25lIGNvbXBvbmVudCB0byB0aGUgb3RoZXIgIiApOwogICAgICAgIExvZy5pbmZvKCAiU3VibWl0dGVyID0gIiwgc3VibWl0dGVyX2Zvcm1hdC5zdWJtaXR0ZXIgKTsKICAgICAgICBMb2cuaW5mbyggIkZvcm1hdCA9ICIsIHN1Ym1pdHRlcl9mb3JtYXQuZm9ybWF0ICk7IAogICAgfSBlbHNlIHsKICAgICAgICBMb2cuaW5mbyggIlN1Ym1pdHRlcl9mb3JtYXQgaXMgdW5kZWZpbmVkIiApOwogICAgfQogICAgTG9nLmluZm8oICJMZWF2aW5nOiBmbG93Q29tcG9uZW50VHdvIGZ1bmN0aW9uIiApOwoKIHJldHVybiAiV2UgZ290IHRocnUgdHdvIGZsb3cgY29tcG9uZW50cyAtIHlheSI7Cn0KCg==", "moduleName": ""}, {"javascript": "LyoqIEBmaWxlIE1vZHVsZXNJbmZvIG1vZHVsZS4gR2V0IGluZm9ybWF0aW9uIGFib3V0IGxvYWRlZCBtb2R1bGVzICovCgovLyBXQVJOSU5HOiBJZiB5b3UgYnJlYWsgdGhpcyBmaWxlLCB0aGUgbW9kdWxlIHN5c3RlbSB3aWxsIHN0b3Agd29ya2luZyEgCgovLyBqc2xpYiBkZXBlbmRzIG9uIGFuZCBsb2FkcyB0aGlzIG1vZHVsZS4KLy8gVGhlIGJpbmFyeSB1c2VzIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb25zOgovLyAKLy8gX19Nb2R1bGVzSW5mby5jaGVja0RlcEFscmVhZHlMb2FkZWQKLy8gX19Nb2R1bGVzSW5mby5hZGRQdXNoTW9kdWxlCi8vIF9fTW9kdWxlc0luZm8ucG9wTW9kdWxlTG9hZFN0YWNrCi8vIF9fTW9kdWxlc0luZm8ucmVtb3ZlTW9kdWxlCi8vCi8vIEl0IGlzIGFsc28gdXNlZCBpbmRpcmVjdGx5IGJ5IFVzZS51c2UuanMKLy8gCgovLyBWYXJpb3VzIGZpbGVzIGluIHNjcmlwdHMvKi51c2UuanMgZGVwZW5kcyBvbiB0aGUgaW50ZXJmYWNlIGluIHRoaXMgZmlsZS4KCi8vIE5vdGUsIGZvciB2YXJpb3VzIG1vcmUgb3IgbGVzcyBvYnZpb3VzIHJlYXNvbnMsIHlvdSBjYW4gKm5vdCogdXNlIGFueSBvdGhlciBtb2R1bGVzCi8vIGZyb20gdGhpcyBmaWxlLiBNa2F5PwoKLy8gVGhpcyBpcyBub3QgbWVhbnQgdG8gYmUgZXh0ZXJuYWxseSBleHBvc2VkLgp2YXIgX19Nb2R1bGVzSW5mbyA9IGZ1bmN0aW9uKCApIHsKICAgIHZhciB0aGF0ID0ge307CgogICAgLy8gSGFzaCBmcm9tIG1vZHVsZU5hbWUgdG8gbW9kdWxlSW5mbzogbmFtZSwgdXJsLCBzeW1ib2xzLCBwb3NzaWJseSBvdGhlcnMgYXQgYSBsYXRlciB0aW1lLgogICAgdmFyIF9fbW9kdWxlcyA9IHt9OwoKICAgIC8vIFN0YWNrIG9mIG1vZHVsZXMgdGhhdCBhcmUgY3VycmVudGx5IGJlZWluZyBsb2FkZWQKICAgIHZhciBfX21vZHVsZUxvYWRTdGFjayA9IFsgXTsKCiAgICAvLyBDb3B5IG9mIHNlYXJjaFBhdGhzIGFzIHRoZXkgbG9va2VkLCB3aGVuIHRoZSBNb2R1bGVzSW5mbyBtb2R1bGUgd2FzIGxvYWRlZCwgYnkgdGhlIHVzZSBzeXN0ZW0uCiAgICB2YXIgX19zZWFyY2hQYXRocyA9IFsgXTsKICAgIAogICAgdGhhdC5hZGRTZWFyY2hQYXRoID0gZnVuY3Rpb24oIHBhdGggKSB7CiAgICAgICAgX19zZWFyY2hQYXRocy5wdXNoKCBwYXRoICk7CiAgICB9OwogICAgCiAgICAvLyBSZXR1cm4gcmVmZXJlbmNlIHRvIHRoZSBzZWFyY2hwYXRocyBpbiB1c2Ugd2hlbiB0aGUgbW9kdWxlc0luZm8gbW9kdWxlIHdhcyBsb2FkZWQuCiAgICAvLyBBIGNvcHkgaXMgcmV0dXJuZWQuCiAgICB0aGF0LmdldFNlYXJjaFBhdGhzID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF9fc2VhcmNoUGF0aHMuc2xpY2UoMCk7CiAgICB9CiAgICAKICAgIC8qIERlYnVnIGZ1bmN0aW9uCiAgICB0aGF0LnByaW50X2J1ZmZlciA9ICIiOwogICAgdmFyIG15cHJpbnQgPSBmdW5jdGlvbigpIHsKICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyArK2kgKSB7CiAgICAgICAgICAgIHRoYXQucHJpbnRfYnVmZmVyICs9IGFyZ3VtZW50c1tpXTsKICAgICAgICB9CiAgICB9CiovCiAgICAvLyBUaGlzIGZ1bmN0aW9uIGRvZXMgdHdvIHRoaW5ncy4gRmlyc3QgaXQgY2hlY2tzIGlmIHdlIGFyZSBjdXJyZW50bHkgbG9hZGluZyBhIG1vZHVsZS4KICAgIC8vIElmIHRoYXQgaXMgdGhlIGNhc2UsIHRoZW4gaXQgYXNzdW1lcyB0aGF0IHRoZSBtb2R1bGUgbmVlZCB0byB1c2UgdGhlIG1vZHVsZU5hbWUsIGFuZCBhZGRzIGl0CiAgICAvLyB0byB0aGUgbGlzdCBvZiB1c2VzIGZvciB0aGUgY3VycmVudGx5IGxvYWRpbmcgbW9kdWxlLgogICAgLy8gU2Vjb25kbHksIGl0IGNoZWNrcyBpZiB0aGUgbW9kdWxlIGhhcyBhbHJlYWR5IGJlZW4gbG9hZGVkIGFuZCByZXR1cm5zIHRydWUgb2YgZmFsc2UKICAgIC8vISBcdG9kbyBUaGlzIGlzIGFsbW9zdCBhbHdheXMgY2FsbGVkIG9uY2Ugd2l0aCB0aGUgbW9kdWxlIGl0IHNlbGYsIHdoaWxlIHdlIGFyZSBsb2FkaW5nIGl0LiBJIGFtIG5vdCBzdXJlIHdoeT8KICAgIHRoYXQuY2hlY2tEZXBBbHJlYWR5TG9hZGVkID0gZnVuY3Rpb24oIG1vZHVsZU5hbWUgKSB7CiAgICAgICAgLy8gICAgICAgIG15cHJpbnQoICJjaGVja0RlcEFscmVhZHlMb2FkZWQoICIgKyBtb2R1bGVOYW1lICsgIik7XG4iICk7CiAgICAgICAgaWYgKCB0aGlzLmlzTG9hZGluZ01vZHVsZSggKSApIHsKICAgICAgICAgICAgdmFyIGN1cnJlbnRfbW9kdWxlID0gdGhpcy5jdXJyZW50TG9hZGluZ01vZHVsZSggKTsKICAgICAgICAgICAgaWYgKCBjdXJyZW50X21vZHVsZSAhPT0gbW9kdWxlTmFtZSApIHsgLy8gTm90IHN1cmUgd2h5IHRoaXMgaGFwcGVucy4KICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIG15cHJpbnQoICIgIGlzTG9hZGluZ01vZHVsZTogIiArIHRoaXMuY3VycmVudExvYWRpbmdNb2R1bGUoKSArICIgaGFzIHVzZXM6ICIgKyBfX21vZHVsZXNbIHRoaXMuY3VycmVudExvYWRpbmdNb2R1bGUoKSBdLnVzZXMgKyAiXG4iICk7CiAgICAgICAgICAgICAgICBpZiAoIC0xID09IF9fbW9kdWxlc1sgdGhpcy5jdXJyZW50TG9hZGluZ01vZHVsZSggKSBdLnVzZXMuaW5kZXhPZiggbW9kdWxlTmFtZSApICkgewogICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICBteXByaW50KCAiICAgIHB1c2hpbmcgIiArIHRoaXMuY3VycmVudExvYWRpbmdNb2R1bGUoKSArICIgPT0+ICIgKyBtb2R1bGVOYW1lICsgIlxuIiApOwogICAgICAgICAgICAgICAgICAgIF9fbW9kdWxlc1sgdGhpcy5jdXJyZW50TG9hZGluZ01vZHVsZSggKSBdLnVzZXMucHVzaCggbW9kdWxlTmFtZSApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzLmhhc01vZHVsZSggbW9kdWxlTmFtZSApOwogICAgfTsKCiAgICB0aGF0Lmhhc01vZHVsZSA9IGZ1bmN0aW9uKCBtb2R1bGVOYW1lICkgewogICAgICAgIHJldHVybiBtb2R1bGVOYW1lIGluIF9fbW9kdWxlczsKICAgIH0KCiAgICB0aGF0LmdldE1vZHVsZSA9IGZ1bmN0aW9uKCBtb2R1bGVOYW1lICkgewogICAgICAgIGlmICggIXRoaXMuaGFzTW9kdWxlKCBtb2R1bGVOYW1lICkgKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvciggImdldE1vZHVsZTogTW9kdWxlICciICsgbW9kdWxlTmFtZSArICInIGlzIG5vdCByZWdpc3RlcmVkIiApOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX19tb2R1bGVzWyBtb2R1bGVOYW1lIF07CiAgICB9OwoKICAgIHRoYXQuYWRkUHVzaE1vZHVsZSA9IGZ1bmN0aW9uKCBtb2R1bGVOYW1lLCB1cmwgKSB7CiAgICAgICAgaWYgKCB0aGlzLmhhc01vZHVsZSggbW9kdWxlTmFtZSApICkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoICJhZGRQdXNoTW9kdWxlOiBNb2R1bGUgJyIgKyBtb2R1bGVOYW1lICsgIicgaXMgYWxyZWFkeSByZWdpc3RlcmVkIHdpdGggdXJsOiAnIiArIHRoaXMuZ2V0TW9kdWxlKCBtb2R1bGVOYW1lICkudXJsICsgIiciICk7CiAgICAgICAgfQogICAgICAgIF9fbW9kdWxlc1sgbW9kdWxlTmFtZSBdID0gewogICAgICAgICAgICBuYW1lOiBtb2R1bGVOYW1lLAogICAgICAgICAgICB1cmw6IHVybCwKICAgICAgICAgICAgc3ltYm9sczogWyBdLAogICAgICAgICAgICB1c2VzOiBbIF0KICAgICAgICB9OwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIF9fbW9kdWxlTG9hZFN0YWNrLnB1c2goIG1vZHVsZU5hbWUgKTsKICAgICAgICB9IGNhdGNoICggZSApIHsKICAgICAgICAgICAgZGVsZXRlIF9fbW9kdWxlc1sgbW9kdWxlTmFtZSBdOwogICAgICAgICAgICB0aHJvdyBlOwogICAgICAgIH0KICAgIH07CgogICAgLy8gU2V0IHRoZSB1cmwgb24gYSBtb2R1bGUuIFRoaXMgaXMgdXNlZCB0byBzZXQgdGhlIFVSTCBmb3IgYSBtb2R1bGUsIGFmdGVyIGxvYWRpbmcuLi4KICAgIC8vIFVzZSBjYXNlIGlzIHRoZSBNb2R1bGVzSW5mbyB1cmwuLi4KICAgIHRoYXQuc2V0TW9kdWxlVXJsID0gZnVuY3Rpb24oIG1vZHVsZU5hbWUsIHVybCApIHsKICAgICAgICBpZiAoICF0aGlzLmhhc01vZHVsZSggbW9kdWxlTmFtZSApICkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoICJzZXRNb2R1bGVVcmw6IE1vZHVsZSAnIiArIG1vZHVsZU5hbWUgKyAiJyBpcyBub3QgcmVnaXN0ZXJlZCIgKTsKICAgICAgICB9CiAgICAgICAgX19tb2R1bGVzWyBtb2R1bGVOYW1lIF0udXJsID0gdXJsOwogICAgfQoKICAgIHRoYXQucmVtb3ZlTW9kdWxlID0gZnVuY3Rpb24oIG1vZHVsZU5hbWUgKSB7CiAgICAgICAgaWYgKCAhdGhpcy5oYXNNb2R1bGUoIG1vZHVsZU5hbWUgKSApIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCAicmVtb3ZlTW9kdWxlOiBNb2R1bGUgJyIgKyBtb2R1bGVOYW1lICsgIicgaXMgbm90IHJlZ2lzdGVyZWQiICk7CiAgICAgICAgfQogICAgICAgIGRlbGV0ZSBfX21vZHVsZXNbIG1vZHVsZU5hbWUgXTsKICAgIH07CgogICAgdGhhdC5wb3BNb2R1bGVMb2FkU3RhY2sgPSBmdW5jdGlvbiggKSB7CiAgICAgICAgcmV0dXJuIF9fbW9kdWxlTG9hZFN0YWNrLnBvcCggKTsKICAgIH07CgogICAgdGhhdC5pc0xvYWRpbmdNb2R1bGUgPSBmdW5jdGlvbiggKSB7CiAgICAgICAgcmV0dXJuIF9fbW9kdWxlTG9hZFN0YWNrLmxlbmd0aCAhPT0gMDsKICAgIH07CgogICAgdGhhdC5jdXJyZW50TG9hZGluZ01vZHVsZSA9IGZ1bmN0aW9uKCApIHsKICAgICAgICBpZiAoICF0aGlzLmlzTG9hZGluZ01vZHVsZSggKSApIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCAiY3VycmVudExvYWRNb2R1bGU6IE5vdCBjdXJyZW50bHkgbG9hZGluZyBhIG1vZHVsZSIgKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9fbW9kdWxlTG9hZFN0YWNrWyBfX21vZHVsZUxvYWRTdGFjay5sZW5ndGggLSAxIF07CiAgICB9OwoKICAgIC8vIFRoZSBzeW1ib2xzIGFycmF5IHBhc3NlZCwgaXMgY29waWVkCiAgICB0aGF0LmFkZFN5bWJvbHMgPSBmdW5jdGlvbiggbW9kdWxlTmFtZSwgc3ltYm9scyApIHsKICAgICAgICBpZiAoICF0aGlzLmhhc01vZHVsZSggbW9kdWxlTmFtZSApICkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoICJhZGRTeW1ib2xzOiBNb2R1bGUgJyIgKyBtb2R1bGVOYW1lICsgIicgaXMgbm90IHJlZ2lzdGVyZWQiICk7CiAgICAgICAgfQogICAgICAgIHRoaXMuZ2V0TW9kdWxlKCBtb2R1bGVOYW1lICkuc3ltYm9scyA9IHN5bWJvbHMubWFwKCBmdW5jdGlvbiggeCApIHsKICAgICAgICAgICAgICAgIHJldHVybiB4OwogICAgICAgICAgICB9ICk7CiAgICB9OwoKICAgIHRoYXQubW9kdWxlTmFtZXMgPSBmdW5jdGlvbiggKSB7CiAgICAgICAgdmFyIHJlcyA9IFsgXTsKICAgICAgICBmb3IgKCB2YXIgbSBpbiBfX21vZHVsZXMgKSB7CiAgICAgICAgICAgIGlmICggX19tb2R1bGVzLmhhc093blByb3BlcnR5KCBtICkgKSB7CiAgICAgICAgICAgICAgICByZXMucHVzaCggX19tb2R1bGVzWyBtIF0ubmFtZSApOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXM7CiAgICB9OwoKICAgIHRoYXQuc2V0VmVyc2lvbiA9IGZ1bmN0aW9uKCBtb2R1bGVOYW1lLCB2ZXJzaW9uICkgewogICAgICAgIHRoaXMuZ2V0TW9kdWxlKCBtb2R1bGVOYW1lICkudmVyc2lvbiA9IHZlcnNpb247CiAgICB9OwoKICAgIHRoYXQuZ2V0VmVyc2lvbiA9IGZ1bmN0aW9uKCBtb2R1bGVOYW1lICkgewogICAgICAgIHJldHVybiB0aGlzLmdldE1vZHVsZSggbW9kdWxlTmFtZSApLnZlcnNpb247CiAgICB9OwoKICAgIC8vIFRoaXMgaXMgYSBiaXQgc2lsbHksIGl0IGluc2VydHMgaXRzZWxmLCB0aGVuIHJlbHkgb24gdGhlIAogICAgLy8gbW9kdWxlIHN5c3RlbSB0byBjb3JyZWN0IHRoZSB1cmwsIGlmIG5lZWRlZC4gCiAgICAvLyBUaGVyZSBhcmUgaGlzdG9yaWNhbCByZWFzb25zIHdoeSBpdCBlbmRlZCB1cCBsaWtlIHRoaXMKICAgIC8vIFJpZ2h0IG5vdywgaXQgaXMgaGFyZCB0byBjaGFuZ2UsIGJlY2F1c2UgaXQgd2lsbCBicmVhawogICAgLy8gaWYgbm90IGNvb3JkaW5hdGVkLCBzbyBsZWF2ZSBpdCBsaWtlIHRoaXMuCiAgICB0aGF0LmFkZFB1c2hNb2R1bGUoICJNb2R1bGVzSW5mbyIsICJ0aGUgaW5mbyBtb2R1bGUgaXRzZWxmIiApOwogICAgdGhhdC5wb3BNb2R1bGVMb2FkU3RhY2soICk7CgogICAgcmV0dXJuIHRoYXQ7Cn0oICk7CgovLyBBbiBpbnRlcmZhY2UgdGhhdCBjYW4gYmUgcHVibGljYWxseSB1c2VkCi8qKiAKICogTW9kdWxlIHRvIGdldCBpbmZvcm1hdGlvbiBhYm91dCBtb2R1bGVzLgogKgogKiBUaGlzIG5hbWVzcGFjZSBjdXJyZW50bHkgb25seSBzdXBwb3J0cyBhIGNvdXBsZSBvZiBtZXRob2RzLCB0aGF0CiAqIHJldHVybnMgaW5mb3JtYXRpb24gZGVzY3JpYmluZyB3aGVyZSBtb2R1bGVzIHdlcmUgbG9hZGVkIGZyb20uCiAqCiAqIEBuYW1lc3BhY2UgCiAqIEBuYW1lIE1vZHVsZXNJbmZvICovCnZhciBNb2R1bGVzSW5mbyA9IGZ1bmN0aW9uKCApIHsKICAgIHZhciB0aGF0ID0ge307CiAgICB2YXIgbW9kdWxlc19pbmZvID0gX19Nb2R1bGVzSW5mbzsKCiAgICAvKioKICAgICAqIFJldHVybnMgYSBzdHJpbmcgd2l0aCBhbiB1cmwgZm9yIGFsbCBsb2FkZWQgbW9kdWxlcy4KICAgICAqIAogICAgICogVGhpcyBtZXRob2QgaXMgbWVhbnQgYXMgYW4gYWlkIGZvciBlLmcuIHNlcnZlciBwcm9ncmFtcywgdGhhdCBjYW4KICAgICAqIHJlcG9ydCwgdXNpbmcgdGhlaXIgbG9nIG9yIHNpbWlsYXIsIHdoZXJlIG1vZHVsZXMgd2hlcmUgbG9hZGVkIGZyb20uCiAgICAgKiAKICAgICAqIEBzeW50YXggTW9kdWxlc0luZm8uZ2V0TW9kdWxlVXJscygpOwogICAgICogQHJldHVybiB7U3RyaW5nfSBBIHN0cmluZyBvZiBtb2R1bGUgbmFtZXMgYW5kIHRoZWlyIGFzc29jaWF0ZWQgdXJscwogICAgICogQG1ldGhvZAogICAgICogQG5hbWUgTW9kdWxlc0luZm8uZ2V0TW9kdWxlVXJscyAqLwogICAgdGhhdC5nZXRNb2R1bGVVcmxzID0gZnVuY3Rpb24oICkgewogICAgICAgIHZhciBrZXlzID0gbW9kdWxlc19pbmZvLm1vZHVsZU5hbWVzKCApLnNvcnQoICk7CiAgICAgICAgdmFyIHJlcyA9ICIiOwogICAgICAgIHZhciBwcmUgPSAiIjsKICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgKytpICkgewogICAgICAgICAgICByZXMgKz0gcHJlICsga2V5c1sgaSBdICsgIiA9PiAiICsgbW9kdWxlc19pbmZvLmdldE1vZHVsZSgga2V5c1sgaSBdICkudXJsOwogICAgICAgICAgICBwcmUgPSAiXG4iOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzOwogICAgfTsKICAgIAogICAgLyoqIFJldHVybnMgYSBzdHJpbmcgd2l0aCB0aGUgdXJsIGZvciBhIHNpbmdsZSwgbmFtZWQgbW9kdWxlLgogICAgICoKICAgICAqIFRoaXMgbWV0aG9kIHJldHVybnMgdGhlIHVybCBvZiBhIHNpbmdsZSBuYW1lIG1vZHVsZSwgb3IgYW4KICAgICAqIGV4Y2VwdGlvbiwgaWYgdGhlIG1vZHVsZSBpcyBub3QgZm91bmQuCiAgICAgKgogICAgICogQHN5bnRheCBNb2R1bGVzSW5mby5nZXRNb2R1bGVVcmwoIG1vZHVsZSApCiAgICAgKiBAcmV0dXJuIFRoZSBVUkwgZm9yIHRoZSBtb2R1bGUKICAgICAqIEBwYXJhbSB7U3RyaW5nfSBUaGUgbmFtZSBvZiB0aGUgbW9kdWxlCiAgICAgKiBAbWV0aG9kCiAgICAgKiBAbmFtZSBNb2R1bGVzSW5mby5nZXRNb2R1bGVVcmwgKi8KICAgIHRoYXQuZ2V0TW9kdWxlVXJsID0gZnVuY3Rpb24oIG1vZHVsZSApIHsKICAgICAgICByZXR1cm4gbW9kdWxlc19pbmZvLmdldE1vZHVsZSggbW9kdWxlICkudXJsOwogICAgfQoKICAgIHJldHVybiB0aGF0Owp9KCApOwo=", "moduleName": "ModulesInfo"}, {"javascript": "LyoqIEBmaWxlIENvcmUgdXNlIGZ1bmN0aW9uYWxpdHkgKi8KLy8gV0FSTklORzogSWYgeW91IGJyZWFrIHRoaXMgZmlsZSwgdGhlIG1vZHVsZSBzeXN0ZW0gd2lsbCBzdG9wIHdvcmtpbmchCgovLyBUaGlzIGZpbGUgZGVmaW5lcyB0aGUgZnVuY3Rpb24gYHVzZShtb2R1bGUtbmFtZSwgdmVyc2lvbi1udW1iZXIpYCwKLy8gd2hpY2ggaXMgdXNlZCBmb3IgbG9hZGluZyBtb2R1bGVzLgovLyBUaGUgbW9kdWxlLW5hbWUgaXMgcmVzb2x2ZWQsIGFuZCB0aGUgbW9kdWxlIGlzIGxvYWRlZCwgCi8vIGlmIG5vdCBhbHJlYWR5IGF2YWlsYWJsZS4KLy8gVGhlIHZlcnNpb24tbnVtYmVyIGlzIG9wdGlvbmFsIGFuZCBpbmRpY2F0ZXMgd2hpY2ggdmVyc2lvbiBvZiAKLy8gdGhlIG1vZHVsZSB0aGF0IGlzIHJlcXVpcmVkLCBhbmQgdXNlZCB0byBjaGVjayBpZiB0aGUgbW9kdWxlCi8vIGlzIGNvbXBhdGlibGUgd2l0aCB0aGUgY29kZS4KLy8KLy8gQSBtb2R1bGUgbXVzdCBkZWZpbmUgYSBnbG9iYWwgdmFyaWFibGUgYEVYUE9SVEVEX1NZTUJPTFNgCi8vIHdoaWNoIGxpc3RzIHRoZSBnbG9iYWwgdmFyaWFibGUgaXQgZXhwb3J0cy4KLy8gVGhlIG9wdGlvbmFsIGdsb2JhbCB2YXJpYWJsZSBgSUdOT1JFRF9TWU1CT0xTYCBjYW4gYmUgYWRkZWQsCi8vIHdoaWNoIHN1cHByZXNzZXMgd2FybmluZ3MgaWYgdGhvc2Ugc3ltYm9scyBhcmUgd3JpdHRlbiB0by4KLy8gSXQgYWxzbyBoYXMgdGhlIG9wdGlvbiBvZiBhZGRpbmcgYSB0aHJlZS1wYXJ0IHN0cmluZyB2ZXJzaW9uIG51bWJlcgovLyBhIGxhOiAiMS40LjU3IiBpbiBhIGBWRVJTSU9OYCB2YXJpYWJsZSB3aGljaCBjYW4gYmUgY2hlY2tlZCBmb3IuCi8vCi8vIEl0IGFsc28gZW5zdXJlcyB0aGF0IGEgZ2l2ZW4gbW9kdWxlIGlzIG9ubHkgbG9hZGVkIG9uY2UsCi8vIGFuZCBtYWtlcyBzb21lIGNoZWNrcyBvbiB2ZXJzaW9uIG51bWJlcnMgYW5kIHdoZXRoZXIKLy8gZ2xvYmFsIHZhcmlhYmxlcyBhcmUgd3JpdHRlbgovLwovLyBSZXNvbHV0aW9uIG9mIG1vZHVsZSBuYW1lIGlzIGN1cnJlbnRseSBkb25lIGluCi8vIHRoZSBuYXRpdmUgZW1iZWRkaW5nIGNvZGUuCi8vCi8vIGpzbGliIGRlcGVuZHMgb24sIGFuZCBsb2FkcyB0aGlzIG1vZHVsZS4KCnVzZSA9ICggZnVuY3Rpb24oICkgewoKICAgICAgICAvLyB0aGlzIG9iamVjdCBjb250YWlucyBhbGwgdmFyaWFibGVzIGV4cG9ydGVkIGZyb20gbW9kdWxlcwogICAgICAgIC8vIGFuZCBpcyBzdGF0aWMsIHZpYSBjbG9zdXJlCiAgICAgICAgdmFyIGV4cG9ydHMgPSB7fTsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oIG5hbWUsIHZlcnNpb24gKSB7CiAgICAgICAgICAgIHZhciBlbGVtLCBpOwoKICAgICAgICAgICAgLy8gc3ltYm9scyB0aGF0IGFyZSBpZ25vcmVkIHdoZW4gY2hlY2tpbmcgZm9yCiAgICAgICAgICAgIC8vIG1vZHVsZS13cml0ZXMgdG8gdGhlIGdsb2JhbCBzY29wZQogICAgICAgICAgICB2YXIgaWdub3JlID0gewogICAgICAgICAgICAgICAgJ0VYUE9SVEVEX1NZTUJPTFMnOiB0cnVlLAogICAgICAgICAgICAgICAgJ0lHTk9SRURfU1lNQk9MUyc6IHRydWUsCiAgICAgICAgICAgICAgICAnVkVSU0lPTic6IHRydWUKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIC8vIGdsb2JhbCBzY29wZQogICAgICAgICAgICB2YXIgZ2xvYmFscyA9ICggZnVuY3Rpb24oICkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgICAgICAgfSApKCApOwoKICAgICAgICAgICAgLy8gcXVpdCBpZiBtb2R1bGUgaXMgYWxyZWFkeSBsb2FkZWQKICAgICAgICAgICAgaWYgKCBnbG9iYWxzLmhhc093blByb3BlcnR5KCAnX19Nb2R1bGVzSW5mbycgKSAmJiBfX01vZHVsZXNJbmZvLmNoZWNrRGVwQWxyZWFkeUxvYWRlZCggbmFtZSApICkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBzaGFsbG93IGNvcHkgb2YgZ2xvYmFsIHNjb3BlLCB1c2VkIHRvIGNoZWNrIGZvciB3cml0ZXMgCiAgICAgICAgICAgIHZhciBvbGRHbG9iYWxzID0ge307CiAgICAgICAgICAgIGZvciAoIGVsZW0gaW4gZ2xvYmFscyApIHsKICAgICAgICAgICAgICAgIGlmICggZ2xvYmFscy5oYXNPd25Qcm9wZXJ0eSggZWxlbSApICkgewogICAgICAgICAgICAgICAgICAgIG9sZEdsb2JhbHNbIGVsZW0gXSA9IGdsb2JhbHNbIGVsZW0gXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gbmFtZSByZXNvbHV0aW9uIGlzIGRvbmUgaW4gdGhlIG5hdGl2ZSBmdW5jdGlvbiBgX19idWlsdGluX3VzZWAKICAgICAgICAgICAgLy8KICAgICAgICAgICAgLy8gRm9yIHRoZSBTcGlkZXJNb25rZXkgaW1wbGVtZW50YXRpb24sIHdlIHdhbnQgdG8gcmV0aHJvdyBwb3NzaWJsZSBleGNlcHRpb24gCiAgICAgICAgICAgIC8vIHRvIGdldCBmaWxlIG5hbWUgZXRjLiB3aXRoIGVycm9yIGFzIHRoZSBuYXRpdmUgZXJyb3IgZG9lc24ndCBpbmNsdWRlIHRoYXQuCiAgICAgICAgICAgIC8vIFdlIGRvIG5vdCBoYXZlIGEgZ29vZCB3YXkgdG8gZGV0ZXJtaW5lIG9uZSBvciB0aGUgb3RoZXIsIHRoaXMgaXMga2luZCBvZiAKICAgICAgICAgICAgLy8gaGFja2lzaDogcmVseSBvbiBQYWNrYWdlcy5qYXZhIC0gaWYgcHJlc2VudCBhbmQgb2JqZWN0LCB0aGlzIGlzIFJoaW5vL0phdmEgYmFja2VuZAogICAgICAgICAgICAvLyBJZiBub3QsIHRoaXMgaXMgc3BpZGVybW9ua2V5CiAgICAgICAgICAgIC8vIE5vdGU6IFRoaXMgbW9kdWxlIGNhbiBub3QgcmVseSBvbiBhbnkgb3RoZXIgbW9kdWxlcywgYXMgaXQgaXMKICAgICAgICAgICAgLy8gdGhlIGxvYWRlciBtb2R1bGUuLi4uIGNhcGlzaD8KICAgICAgICAgICAgaWYgKCAoIHR5cGVvZiBQYWNrYWdlcyA9PT0gIm9iamVjdCIgKSAmJiAoIHR5cGVvZiBQYWNrYWdlcy5qYXZhID09PSAib2JqZWN0IiApICkgewogICAgICAgICAgICAgICAgLy8gUmhpbm8vSmF2YSBwYXRoCiAgICAgICAgICAgICAgICBfX2J1aWx0aW5fdXNlKCBuYW1lICk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBTcGlkZXJNb25rZXkvQy9DKysgcGF0aAogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBfX2J1aWx0aW5fdXNlKCBuYW1lICk7CiAgICAgICAgICAgICAgICB9IGNhdGNoICggZSApIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBtb2R1bGVzIG11c3QgaW5pdGlhbGlzZSBhbiBFWFBPUlRFRF9TWU1CT0xTIHZhcmlhYmxlLgogICAgICAgICAgICAvLyBUaGlzIGlzIGluc3BpcmVkZSBieSBtb3ppbGxhJ3MgbW9kdWxlIHN5c3RlbSwgc2VlIGFsc28KICAgICAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vSmF2YVNjcmlwdF9jb2RlX21vZHVsZXMvVXNpbmcKICAgICAgICAgICAgLy8KICAgICAgICAgICAgLy8gdGhpcyBjb2RlIHRocm93cyBpZiB0aGUgdmFyaWFibGUgaXMgbm90IGRlZmluZWQgCiAgICAgICAgICAgIC8vIG9yIGlmIGl0IGlzIG5vdCBvZiB0aGUgcHJvcGVyIHR5cGUuCiAgICAgICAgICAgIGlmICggIWdsb2JhbHMuaGFzT3duUHJvcGVydHkoICdFWFBPUlRFRF9TWU1CT0xTJyApIHx8IHR5cGVvZiBFWFBPUlRFRF9TWU1CT0xTICE9PSAnb2JqZWN0JyB8fCBFWFBPUlRFRF9TWU1CT0xTLmNvbnN0cnVjdG9yICE9PSBBcnJheSApIHsKICAgICAgICAgICAgICAgIHRocm93ICdVc2UgZXJyb3I6IG1vZHVsZSAiJyArIG5hbWUgKyAnIiBkb2VzIG5vdCBpbml0aWFsaXNlIGFycmF5IEVYUE9SVEVEX1NZTUJPTFMuJzsKICAgICAgICAgICAgfQoKCiAgICAgICAgICAgIC8vIHZlcnNpb24gb2YgdGhlIG1vZHVsZQogICAgICAgICAgICBnbG9iYWxzLlZFUlNJT04gPSBnbG9iYWxzLlZFUlNJT04gfHwgIjAuMC4wIgoKCiAgICAgICAgICAgIC8vIGlmIGB1c2UoLi4uKWAgcmVxdWlyZXMgYSBjZXJ0YWluIHZlcnNpb24sCiAgICAgICAgICAgIC8vIHRlc3QgaWYgdGhlIG1vZHVsZSBzdXBwbGllcyB0aGF0CiAgICAgICAgICAgIC8vIG9yIG90aGVyd2lzZSB0aHJvdyBhbiBlcnJvcgogICAgICAgICAgICBpZiAoIHZlcnNpb24gKSB7CiAgICAgICAgICAgICAgICB2YXIgdmVyc2lvbmVycm9yID0gIlJlcXVlc3RpbmcgdmVyc2lvbiAiICsgdW5ldmFsKCB2ZXJzaW9uICkgKyAiIG9mIG1vZHVsZSAiICsgbmFtZSArICIgd2hpY2ggaXMgdmVyc2lvbiAiICsgdW5ldmFsKCBWRVJTSU9OICk7CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gc3BsaXR2ZXJzaW9uKCB2ICkgewogICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSAoIHR5cGVvZiggdiApID09PSAic3RyaW5nIiApICYmIHYuc3BsaXQoICIuIiApLm1hcCggZnVuY3Rpb24oIHMgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoIHMsIDEwICkKICAgICAgICAgICAgICAgICAgICAgICAgfSApOwogICAgICAgICAgICAgICAgICAgIGlmICggcmVzdWx0LmNvbnN0cnVjdG9yICE9PSBBcnJheSB8fCByZXN1bHQubGVuZ3RoICE9PSAzIHx8IHJlc3VsdC5qb2luKCAiLiIgKSAhPT0gdiApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgdmVyc2lvbmVycm9yOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIG1vZHVsZXZlcnNpb24gPSBzcGxpdHZlcnNpb24oIFZFUlNJT04gKTsKICAgICAgICAgICAgICAgIHZlcnNpb24gPSBzcGxpdHZlcnNpb24oIHZlcnNpb24gKTsKICAgICAgICAgICAgICAgIGlmICggISggbW9kdWxldmVyc2lvblsgMCBdID09IHZlcnNpb25bIDAgXSAmJiAoIG1vZHVsZXZlcnNpb25bIDEgXSA+IHZlcnNpb25bIDEgXSB8fCAoIG1vZHVsZXZlcnNpb25bIDEgXSA9PT0gdmVyc2lvblsgMSBdICYmIG1vZHVsZXZlcnNpb25bIDIgXSA+PSB2ZXJzaW9uWyAyIF0gKSApICkgKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgdmVyc2lvbmVycm9yOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8qIFRPRE86IHNlZW1zIGxpa2Ugd2UgZG9udCBjaGVjayB2ZXJzaW9uIG51bWJlcgogICAgICAgICAgIGlmIG1vZHVsZSBpcyBhbHJlYWR5IGxvYWRlZC4uLiAqLwogICAgICAgICAgICBfX01vZHVsZXNJbmZvLnNldFZlcnNpb24oIG5hbWUsIFZFUlNJT04gKTsKCiAgICAgICAgICAgIC8vIG1iZDogQWRkIHN5bWJvbHMgdG8gTW9kdWxlc0luZm8KICAgICAgICAgICAgX19Nb2R1bGVzSW5mby5hZGRTeW1ib2xzKCBuYW1lLCBFWFBPUlRFRF9TWU1CT0xTICk7CgogICAgICAgICAgICAvLyBtYmQ6IEkgd29uZGVyIHdoeSB0aGlzIGlzIG5lZWRlZD8KICAgICAgICAgICAgLy8gcmplOiBXaGVuIGxvYWRpbmcgYSBtb2R1bGUsIHdlIGNyZWF0ZSAob3IgY2hhbmdlKSB0aGUgZ2xvYmFsIHZhcmlhYmxlIF9fTW9kdWxlc0luZm8KICAgICAgICAgICAgLy8gcmplOiBhbmQgdGh1cyBpdCBuZWVkcyB0byBleHBvcnRlZCwgb3Igd2Ugd291bGQgZ2V0IGEgd2FybmluZyBmcm9tIHRoZSBtb2R1bGUgc3lzdGVtLiAKICAgICAgICAgICAgLy8gcmplOiBDb3VsZCBiZSBoYW5kbGVkIGFzIGEgc3BlY2lhbCBjYXNlIGluIHRoZSBjb2RlIGluc3RlYWQsIGJ1dCBJIGZpbmQgaXQgc2ltcGxlcgogICAgICAgICAgICAvLyByamU6IGp1c3QgdG8gYWRkIGl0IHRvIHRoZSBleHBvcnRlZCBzeW1ib2xzLgogICAgICAgICAgICBFWFBPUlRFRF9TWU1CT0xTLnB1c2goICdfX01vZHVsZXNJbmZvJyApOwoKICAgICAgICAgICAgLy8gYXBwZW5kIGBJR05PUkVEX1NZTUJPTFNgIHRvIGBpZ25vcmVgIGxpc3QKICAgICAgICAgICAgaWYgKCBnbG9iYWxzLmhhc093blByb3BlcnR5KCAnSUdOT1JFRF9TWU1CT0xTJyApICkgewogICAgICAgICAgICAgICAgZm9yICggaSA9IDA7IGkgPCBJR05PUkVEX1NZTUJPTFMubGVuZ3RoOyArK2kgKSB7CiAgICAgICAgICAgICAgICAgICAgZWxlbSA9IElHTk9SRURfU1lNQk9MU1sgaSBdOwogICAgICAgICAgICAgICAgICAgIGlnbm9yZVsgZWxlbSBdID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gd2FybiBpZiBgRVhQT1JURURfU1lNQk9MU2AgaXMgbm90IGV4cG9ydGVkCiAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgRVhQT1JURURfU1lNQk9MUy5sZW5ndGg7ICsraSApIHsKICAgICAgICAgICAgICAgIGVsZW0gPSBFWFBPUlRFRF9TWU1CT0xTWyBpIF07CiAgICAgICAgICAgICAgICBpZiAoIGdsb2JhbHMuaGFzT3duUHJvcGVydHkoICdwcmludCcgKSAmJiAhZ2xvYmFscy5oYXNPd25Qcm9wZXJ0eSggZWxlbSApICkgewogICAgICAgICAgICAgICAgICAgIHByaW50KCAnV2FybmluZzogbW9kdWxlICInICsgbmFtZSArICciIHNheXMgaXQgZXhwb3J0cyBnbG9iYWwgIicgKyBlbGVtICsgJyIgd2hpY2ggZG9lcyBub3QgZXhpc3RcbicgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGV4cG9ydHNbIGVsZW0gXSA9IGdsb2JhbHNbIGVsZW0gXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gd2FybiBpZiBtb2R1bGUgY3JlYXRlcyBvciBjaGFuZ2VzIGdsb2JhbCBzeW1ib2wKICAgICAgICAgICAgLy8gd2hpY2ggaXMgbm90IGluIGBJR05PUkVEX1NZTUJPTFNgIG9yIGBFWFBPUlRFRF9TWU1CT0xTYAogICAgICAgICAgICAvLyBhbmQgZGVsZXRlIHRoZW0gaWYgY3JlYXRlZAogICAgICAgICAgICBmb3IgKCBlbGVtIGluIGdsb2JhbHMgKSB7CiAgICAgICAgICAgICAgICBpZiAoIGdsb2JhbHMuaGFzT3duUHJvcGVydHkoIGVsZW0gKSApIHsKCiAgICAgICAgICAgICAgICAgICAgaWYgKCBvbGRHbG9iYWxzLmhhc093blByb3BlcnR5KCBlbGVtICkgJiYgb2xkR2xvYmFsc1sgZWxlbSBdICE9PSBnbG9iYWxzWyBlbGVtIF0gKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggZ2xvYmFscy5oYXNPd25Qcm9wZXJ0eSggJ3ByaW50JyApICYmICFpZ25vcmVbIGVsZW0gXSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCAnV2FybmluZzogbW9kdWxlICInICsgbmFtZSArICciIG92ZXJ3cml0ZXMgZ2xvYmFsIHZhcmlhYmxlICcgKyBlbGVtICsgJ1xuJyApOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoICFleHBvcnRzLmhhc093blByb3BlcnR5KCBlbGVtICkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggb2xkR2xvYmFscy5oYXNPd25Qcm9wZXJ0eSggZWxlbSApICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsc1sgZWxlbSBdID0gb2xkR2xvYmFsc1sgZWxlbSBdOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBnbG9iYWxzLmhhc093blByb3BlcnR5KCAncHJpbnQnICkgJiYgIWlnbm9yZVsgZWxlbSBdICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoICdXYXJuaW5nOiBtb2R1bGUgIicgKyBuYW1lICsgJyIgY3JlYXRlcyBub24tZXhwb3J0ZWQgZ2xvYmFsIHZhcmlhYmxlICcgKyBlbGVtICsgJ1xuJyApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhZGVsZXRlIGdsb2JhbHNbIGVsZW0gXSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxzWyBlbGVtIF0gPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9ICkoICk7Cg==", "moduleName": "Use"}, {"javascript": "LyoqIEBmaWxlIEltcGxlbWVudGF0aW9uIG9mIGEgTG9nIG1vZHVsZS4gKi8KLy8gVGhpcyBtb2R1bGUgZGVwZW5kcyBvbiBhIHByb3ZpZGVkIExvZ0NvcmUgbW9kdWxlLCB3aGljaCBtdXN0Ci8vIHByb3ZpZGUgYSBmdW5jdGlvbiBfX0xvZ0NvcmVfbG9nIHRoYXQgdGFrZXMgdHdvIHN0cmluZyBhcmd1bWVudHMKLy8gYSBsZXZlbCwgYW5kIGFuIGFscmVhZHkgZm9ybWF0dGVkIG1lc3NhZy4gCi8vIEEgc2ltcGxlIExvZ0NvcmUgbW9kdWxlIHRoYXQgZG9lcyBsb2dnaW5nIHVzaW5nIFByaW50IHdpbGwgc3VmZmljZSwgb3IKLy8gaW4gbW9zdCBjYXNlcyBhIExvZ0NvcmUgbW9kdWxlIHByb3ZpZGVkIGJ5IHRoZSBlbnZpcm9ubWVudC4KdXNlKCAiTG9nQ29yZSIgKTsKdXNlKCAiVW5kZXJzY29yZSIgKTsgLy8gRm9yIHRoZSAnbWFnaWMnIGV4cGVyaW1lbnRhbCBmdW5jdGlvbi4KdXNlKCAiVW5pdFRlc3QiICk7CnVzZSggIkdsb2JhbCIgKTsKCkVYUE9SVEVEX1NZTUJPTFMgPSBbICdMb2cnIF07CgovKioKICogTmFtZXNwYWNlIHRoYXQgY29udGFpbnMgZnVuY3Rpb25zIHRvIExvZyB3aXRoLgogKiAKICogVGhpcyBuYW1lc3BhY2UgY29udGFpbnMgZnVuY3Rpb25zIHVzZWQgZm9yIGxvZ2dpbmcuIEVhY2ggZnVuY3Rpb24KICogcmVmbGVjdHMgYSBjZXJ0YWluIGxldmVsIG9mIHVyZ2VuY3kgb2YgdGhlIG1lc3NhZ2UgdG8gYmUgbG9nZ2VkLgogKiBBbGwgbG9nZ2luZyBtZXRob2RzIHN1cHBvcnRzIHBhc3NpbmcgYSB2YXJpYWJsZSBudW1iZXIgb2YgYXJndW1lbnRzLiBJZiB0aGUgbG9nIHN0YXRlbWVudCBsZXZlbCBpcyBlbmFibGVkCiAqIGVhY2ggcGFyYW1ldGVyIHdpbGwgYmUgY29udmVydGVkIHRvIGEgU3RyaW5nIChieSBjYWxsaW5nIGl0cyB0b1N0cmluZyBtZXRob2QpLCBhbmQgdGhlIHN0cmluZ3Mgd2lsbCBiZSBjb25jYXRlbmF0ZWQuCiAqCiAqICoqQSBub3RlIG9uIHRoZSBsZXZlbHMqKiAgCiAqIAogKiBUaGUgbG9nIGxldmVscyBhcmUsIGZyb20gbG93L3VuaW1wb3J0YW50IHRvIGhpZ2gvaW1wb3J0YW50OiBgdHJhY2VgLAogKiBgZGVidWdgLCBgaW5mb2AsIGB3YXJuYCwgYGVycm9yYCwgYW5kIGBmYXRhbGAuIFRoZXkgYXJlIHVzZWQgcm91Z2hseSBhcyBzdWNoOgogKiAKICogKiBgdHJhY2VgOiBWZXJ5IGRldGFpbGVkLCBmdW5jdGlvbiBlbnRlci9leGl0LCBwYXJhbWV0ZXIgZHVtcHMsIHVzdWFsbHkgb25seSB1c2VkIGZvciB0cmFjaW5nIGZ1bmN0aW9ucywgYW5kIHNwZWNpZmljIGJ1ZyBzb2x2aW5nLgogKiAKICogKiBgZGVidWdgOiBGb3Igb3JkaW5hcnkgZGV2ZWxvcG1lbnQsIHByb2dyYW0gZmxvdywgZHVtcGluZyBpbXBvcnRhbnQgdmFsdWVzLCBldGMuCiAqIAogKiAqIGBpbmZvYDogSW5mb3JtYXRpb24gYWJvdXQgdGhlIHJ1bm5pbmcgcHJvZ3JhbS9zeXN0ZW0gb2YgYSBtb3JlIHN0YXR1cy1saWtlIGNoYXJhY3RlciwgZS5nLiBob3cgZmFyIHRoZSBwcm9ncmFtIGlzIGluIGEgZ2l2ZW4gcHJvY2VzcywgdGhhdCBzb21ldGhpbmcgc3RhcnRlZCBvciBzdG9wcGVkLCBvciBzaW1pbGFyLgogKiAKICogKiBgd2FybmA6IEV4cGVjdGF0aW9ucyB0aGUgcHJvZ3JhbSBoYWQgYWJvdXQgZmxvdyBvciBkYXRhIGhhcyBub3QgYmVlbiBtZXQsIGJ1dCB0aGUgcHJvZ3JhbSBpcyBjYXBhYmxlIG9mIGNvbnRpbnVpbmcuIEl0IG1pZ2h0IGluZGljYXRlIHRoYXQgdGhlIHVzZXIvb3BlcmF0b3IgaGFzIHRvIGxvb2sgaW50byBhbiBpc3N1ZSBhbmQgc29sdmUgYSBwcm9ibGVtLgogKiAKICogKiBgZXJyb3JgOiBBbiB1bmV4cGVjdGVkIHNpdHVhdGlvbiB0aGF0IHRoZSBwcm9ncmFtIGlzIHVuYWJsZSB0byBjb3JyZWN0bHkgaGFuZGxlLCBoYXMgb2NjdXJyZWQuIFRoZSBjdXJyZW50IHByb2Nlc3MgY2FuIG5vdCBydW4gdW50aWwgY29tcGxldGlvbi4gVGhpcyBtaWdodCBiZSBtaXNzaW5nIGRhdGEsIG9yIHNpbWlsYXIuIFRoZSB1c2VyL29wZXJhdG9yIG11c3QgbG9vayBpbnRvIHRoZSBpc3N1ZSwgYW5kIHNvbHZlIGl0LgogKiAKICogKiBgZmF0YWxgOiBBcyBlcnJvciwgYnV0IHRoZSBwcm9ncmFtIGlzIHVuYWJsZSB0byBjb250aW51ZSBhdCBhbGwsIGFuZCB3aWxsIHNodXQgZG93bi4gKE5vdCB1c2VkIG11Y2ggaW4gSmF2YVNjcmlwdCwgYW5kIG5vdCBzdXBwb3J0ZWQgaW4gYWxsIGZyYW1ld29ya3MpLgogKiAKICogKipBIG5vdGUgb24gcGVyZm9ybWFuY2UqKgogKiAKICogWW91IGFyZSBlbmNvdXJhZ2VkIHRvIHBhc3MgbXVsdGlwbGUgdmFsdWVzLCBpbnN0ZWFkIG9mIAogKiB1c2luZyBzdHJpbmcgY29uY2F0ZW5hdGlvbiBpbiB0aGUgY2FsbCB0byB0aGUgbG9nZ2luZyBtZXRob2QsCiAqICBhcyB0aGUgbG9nIG1vZHVsZSB3aWxsIHNraXAgdGhlIHRvU3RyaW5nIGNvbnZlcnNpb24gcHJvY2VzcyBhbmQgY29uY2F0ZW5hdGlvbiwgdW50aWwgaXQgZGV0ZXJtaW5lcyB0aGF0IGl0IG5lZWRzCiAqIHRvIHBlcmZvcm0gdGhlIGFjdHVhbCBsb2dnaW5nLiBTZWUgdGhlIGV4YW1wbGUuCiAqIAogKiBXaGVuIGxvZ2dpbmcgeG1sIHZhcmlhYmxlcyBmb3IgbGV2ZWxzIHRoYXQgbWlnaHQgYmUgb2Z0ZW4gYmUgb2ZmICh0cmFjZSwgZGVidWcsIGluZm8pIHlvdSBzaG91bGQgY29uc2lkZXIgdXNpbmcKICogIHtAbGluayBYbWxVdGlsLmxvZ1hNTFN0cmluZ30sIGluc3RlYWQgb2YgY2FsbGluZyB0aGUgeG1sIGluc3RhbmNlcyB0b1hNTFN0cmluZyBtZXRob2QuIFRoaXMgZW5zdXJlcyB0aGUgYmVzdCBwZXJmb3JtYW5jZS4gCiAqIAogKiBAZXhhbXBsZQovLyBXaGVuIGxvZ2dpbmcsIHVzZSBtdWx0aXBsZSBwYXJhbWV0ZXJzIHRoYXQgc3VwcG9ydHMgdG9TdHJpbmcsIGluc3RlYWQgb2Ygc3RyaW5nIGNvbmNhdGVuYXRpb24uCi8vIEUuZy4gZG8gdGhpczoKTG9nLmRlYnVnKCAiVmFsdWUgb2YgZm9vLmJhcjogIiwgZm9vLmJhciwgIiwgdmFsdWUgb2YgZm9vLmZvbzogIiwgZm9vLmZvbyApOwovLyBJbnN0ZWFkIG9mIHRoaXM6CkxvZy5kZWJ1ZyggIlZhbHVlIG9mIGZvby5iYXI6ICIgKyBmb28uYmFyICsgIiwgdmFsdWUgb2YgZm9vLmZvbzogIiArIGZvby5mb28gKTsKICogCiAqIEBuYW1lc3BhY2UKICogQG5hbWUgTG9nCiAqLwp2YXIgTG9nID0gZnVuY3Rpb24oICkgewoKICAgIC8vIFN0b3JlIGEgY29weSB0byB0aGUgZnVuY3Rpb24gZnJvbSBMb2dDb3JlIC0gdGhlbiByZW1vdmUgaXQgZnJvbSB0aGUgZ2xvYmFsIHNjb3BlLgogICAgdmFyIExvZ0NvcmVfbG9nID0gX19Mb2dDb3JlX2xvZzsKICAgIGRlbGV0ZSB0aGlzLl9fTG9nQ29yZV9sb2c7CgogICAgLy8gUG9pbnRlciB0byBmdW5jdGlvbiB0aGF0IGNoZWNrcyBpZiBhIGdpdmVuIGxvZyBsZXZlbCBpcyBlbmFibGVkLiBPcHRpb25hbGx5IHN1cHBsaWVkIGJ5IExvZ0NvcmUuCiAgICB2YXIgTG9nQ29yZV9pc0xldmVsRW5hYmxlZCA9IHVuZGVmaW5lZDsKCiAgICAvLyBUaGUgb2JqZWN0IHRvIHJldHVybi4KICAgIHZhciB0aGF0ID0ge307ICAgIAogICAgCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gSGVscGVyIGZ1bmN0aW9uLgogICAgLy8gQ29sbGVjdCBhbiBhcmd1bWVudHMgb2JqZWN0IHRvIGEgc3RyaW5nLiBOb3RlLCBhcmdzIGlzICpub3QqIGFuIGFycmF5LCBidXQgYW4gaW5zdGFuY2Ugb2YgYW4gYXJndW1lbnRzIG9iamVjdC4KICAgIHZhciBjb2xsZWN0ID0gZnVuY3Rpb24oIGFyZ3MgKSB7CiAgICAgICAgc3dpdGNoKCBhcmdzLmxlbmd0aCApIHsKICAgICAgICBjYXNlIDA6IHJldHVybiAiIjsKICAgICAgICBjYXNlIDE6IHJldHVybiBhcmdzWzBdLnRvU3RyaW5nKCk7CiAgICAgICAgY2FzZSAyOiByZXR1cm4gYXJnc1swXS50b1N0cmluZygpICsgYXJnc1sxXS50b1N0cmluZygpOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIHZhciBteXJlcyA9IGFyZ3NbMF07CiAgICAgICAgICAgIGZvciAoIHZhciBpID0gMTsgaSA8IGFyZ3MubGVuZ3RoOyArK2kgKSB7CiAgICAgICAgICAgICAgICBteXJlcyArPSBhcmdzWyBpIF0udG9TdHJpbmcoICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIG15cmVzOwogICAgICAgIH07CiAgICB9OwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBIZWxwZXIgZnVuY3Rpb24uCiAgICAvLyBDb2xsZWN0IGFuIGFyZ3VtZW50cyBvYmplY3QgdG8gYSBzdHJpbmcuIE5vdGUsIGFyZ3MgaXMgKm5vdCogYW4gYXJyYXkuCiAgICAvLyBUaGlzIHZlcnNpb24gZG9lcyBub3QgdGhyb3csIGJ1dCB0cmllcyB0byBjb2xsZWN0IGFzIG11Y2ggYXMgcG9zc2libHkKICAgIHZhciBzYWZlQ29sbGVjdCA9IGZ1bmN0aW9uKCBhcmdzICkgewogICAgICAgIHZhciBteXJlcyA9ICIiOwogICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyArK2kgKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBteXJlcyArPSBhcmdzWyBpIF0udG9TdHJpbmcoICk7CiAgICAgICAgICAgIH0gY2F0Y2ggKCBlICkgewogICAgICAgICAgICAgICAgbXlyZXMgKz0gIltpbGxlZ2FsL251bGwvdW5kZWZpbmVkIHZhbHVlIGF0IHBvc2l0aW9uICIgKyBpICsgIl0iOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBteXJlczsKICAgIH07CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEFjdHVhbCBtZXRob2RzCgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEFjdHVhbCBtZXRob2RzCiAgICAvLyBDb2xsZWN0IHRoZSBhcmdzLCB0aGVuIGxvZyB0aGVtIHVzaW5nIHRoZSBsZXZlbC4KICAgIC8vIE5vdGUsIGFyZ3MgaXMgbm90IGFuIGFycmF5LCBidXQgYW4gaW5zdGFuY2Ugb2YgYW4gYXJndW1lbnRzIG9iamVjdC4KICAgIHZhciBsb2cgPSBmdW5jdGlvbiggbGV2ZWwsIGFyZ3MgKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgTG9nQ29yZV9sb2coIGxldmVsLCBjb2xsZWN0KCBhcmdzICkgKTsKICAgICAgICB9IGNhdGNoICggZXJyb3IgKSB7CiAgICAgICAgICAgIHZhciBtc2cgPSAiRXJyb3Igd2hpbGUgY2FsbGluZyBmb3JtYXR0aW5nIGxvZy4gT25lIG9yIG1vcmUgdmFsdWVzIHBhc3NlZCB0byBsb2cgd2FzIHByb2JhYmx5IG51bGwgb3IgdW5kZWZpbmVkLiBTdWJzdGl0dXRlZCBsaW5lIGZvbGxvd3M6XG4iOwogICAgICAgICAgICBtc2cgKz0gc2FmZUNvbGxlY3QoIGFyZ3MgKSArICJcbiI7CiAgICAgICAgICAgIGlmICggIiIgIT0gZXJyb3Iuc3RhY2sgKSB7CiAgICAgICAgICAgICAgICBtc2cgKz0gIkRpc3BsYXlpbmcgc3RhY2s6ICIgKyBlcnJvci5zdGFjay5yZXBsYWNlKCAvKEBbXjpcW10qOikvZywgIlxuJDEiICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgTG9nQ29yZV9sb2coICJ3YXJuIiwgbXNnICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9OwoKCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEFjdHVhbCB1c2VyIGV4cG9zZWQgZnVuY3Rpb25zL3N0dWZmCiAgICAKICAgIC8vIFNldHRpbmcgdXAgbGV2ZWwgcHJvcGVydGllcwogICAgLyoqIAogICAgICogRW51bSBmb3IgbG9nIGxldmVscy4KICAgICAqIAogICAgICogVXNlIHRoaXMgZW51bSB3aGVuIGNhbGxpbmcgaXNMZXZlbEVuYWJsZWQuCiAgICAgKiAKICAgICAqIFRoaXMgZW51bSBoYXMgcHJvcGVydGllcyBgdHJhY2VgLCBgZGVidWdgLCBgaW5mb2AsIGB3YXJuYCBhbmQgYGVycm9yYC4gVXNlIHRoZW0gd2hlbiBjYWxsaW5nIGlzTGV2ZWxFbmFibGVkLgogICAgICogCiAgICAgKiBAc2VlIHtAbGluayBMb2cuaXNMZXZlbEVuYWJsZWR9CiAgICAgKiBAZXhhbXBsZQovLyBDaGVjayBpZiBpbmZvIGxldmVsIGlzIGVuYWJsZWQsIHRoZW4gbG9nLgppZiAoIExvZy5pc0xldmVsRW5hYmxlZCggTG9nLkxldmVsLmluZm8gKSApIHsKICAgIExvZy5pbmZvKCAiVGhlIHJlc3VsdCBvZiBjYWxsaW5nIHNsb3dfZnVuY3Rpb24gaXMgOiAiLCBzbG93X2Z1bmN0aW9uKCkgKTsKfQogICAgICogCiAgICAgKiBAcmVhZG9ubHkKICAgICAqIEBlbnVtIHtTdHJpbmd9CiAgICAgKiBAbmFtZSBMb2cuTGV2ZWwKICAgICAqLwogICAgdGhhdC5MZXZlbCA9IHsgCiAgICAgICAgICAgIC8qKiBUaGUgdHJhY2UgbGV2ZWwgKi8KICAgICAgICAgICAgdHJhY2UgOiAidHJhY2UiLCAKICAgICAgICAgICAgLyoqIFRoZSBkZWJ1ZyBsZXZlbCAqLwogICAgICAgICAgICBkZWJ1ZyA6ICJkZWJ1ZyIsCiAgICAgICAgICAgIC8qKiBUaGUgaW5mbyBsZXZlbCAqLwogICAgICAgICAgICBpbmZvICA6ICJpbmZvIiwgCiAgICAgICAgICAgIC8qKiBUaGUgd2FybiBsZXZlbCAqLwogICAgICAgICAgICB3YXJuICA6ICJ3YXJuIiwKICAgICAgICAgICAgLyoqIFRoZSBlcnJvciBsZXZlbCAqLwogICAgICAgICAgICBlcnJvciA6ICJlcnJvciIKICAgIH07CiAgICAKICAgLyoqCiAgICAqICBDaGVjayBpZiBhIGxvZyBsZXZlbCBpcyBlbmFibGVkLgogICAgKiAgCiAgICAqICBSZXR1cm4gdHJ1ZSBpZiBhIGxvZyBsZXZlbCBpcyBlbmFibGVkLCBmYWxzZSBvdGhlcndpc2UuCiAgICAqICAKICAgICogIFRoaXMgZnVuY3Rpb24gY2FuIGJlIHVzZWQgd2hlbiBsb2dnaW5nIG9iamVjdHMgdGhhdCBhcmUgZXhwZW5zaXZlIHRvIGV2YWx1YXRlIHdoZW4gcGFzc2luZyB0byB0aGUgbG9nIHN5c3RlbS4KICAgICogIEJ5IG9ubHkgY29uZGl0aW9uYWxseSBldmFsdWF0aW5nLCB5b3UgY2FuIG1ha2UgdGhlIHByb2dyYW0gZ28gZmFzdGVyLCB3aGljaCBjYW4gYmUgaGFuZHkgaW4gc29tZSBzaXR1YXRpb25zLgogICAgKiAgCiAgICAqICAqKk5vdGU6KiogWW91IGRvIG5vdCBuZWVkIHRoaXMgaW4gbW9zdCBzaXR1YXRpb25zLCBvbmx5IHdoZW4geW91IG5lZWQgdG8gY2FsbCBzbG93IGZ1bmN0aW9ucywgb3Igc2ltaWxhciwgaW4gY2FzZSBvZiBsb2dnaW5nLiBUaGUgTG9nIG9iamVjdCBvbmx5IGNhbGxzIHRoZSB1bmRlcmx5aW5nIExvZyBmcmFtZXdvcmssIGlmIGl0IG5lZWRzIHRvLgogICAgKiAgCiAgICAqICAqKk5vdGU6KiogVGhpcyBmdW5jdGlvbmFsaXR5IHJlcXVpcmVzIHRoZSB1bmRlcmx5aW5nIExvZyBmcmFtZXdvcmsgdG8gc3VwcG9ydCByZXRyZWl2aW5nIHRoaXMga2luZCBvZiBpbmZvcm1hdGlvbi4KICAgICogIAogICAgICogQHNlZSB7QGxpbmsgTG9nLkxldmVsfQogICAgKiAgQGV4YW1wbGUKLy8gT25seSBwZXJmb3JtIGV2YWx1YXRpb24sIGlmIGxvZyBsZXZlbCBpcyBlbmFibGVkCmlmICggTG9nLmlzTGV2ZWxFbmFibGVkKCBMb2cuTGV2ZWwuZGVidWcgKSApIHsKICAgIExvZy5kZWJ1ZyggIlRoZSByZXN1bHQgb2YgY2FsbGluZyBzbG93X2Z1bmN0aW9uIGlzIDogIiwgc2xvd19mdW5jdGlvbigpICk7Cn0KICAgICogIAogICAgKiAgQGV4YW1wbGUKLy8gTm8gcmVhc29uIHRvIHVzZSBpbiBvcmRpbmFyeSBjYXNlCi8vIERvbid0IGRvIHRoaXMgbm9ybWFsbHkKaWYgKCBMb2cuaXNMZXZlbEVuYWJsZWQoIExvZy5MZXZlbC5kZWJ1ZyApICkgewogICAgTG9nLmRlYnVnKCAiSSBuZWVkIHRvIGxvZyB0aGUgdmFsdWUgb2Ygc29tZXRoaW5nIDoiLCBzb21lX3ZhbHVlICk7Cn0KLy8gSW5zdGVhZCwgZG8gdGhpcwpMb2cuZGVidWcoICJJIG5lZWQgdG8gbG9nIHRoZSB2YWx1ZSBvZiBzb21ldGhpbmcgOiIsIHNvbWVfdmFsdWUgKTsKICAgICoKICAgICogIEBzeW50YXggTG9nLmlzTGV2ZWxFbmFibGVkKCBsZXZlbCApCiAgICAqICBAcGFyYW0gbGV2ZWwgVGhlIGxldmVsIHRvIGV2YWx1YXRlLiBVc2UgdGhlIExldmVsIHByb3BlcnR5IGNvbnN0YW50cy4KICAgICogIEByZXR1cm4ge0Jvb2xlYW59IFRydWUgaWYgdGhlIGxvZyBsZXZlbCBpcyBlbmFibGVkLCBmYWxzZSBvdGhlcndpc2UuCiAgICAqICAKICAgICogIEBuYW1lIExvZy5pc0xldmVsRW5hYmxlZAogICAgKiAgQG1ldGhvZAogICAgKi8gICAgIAogICAgdGhhdC5pc0xldmVsRW5hYmxlZCA9IGZ1bmN0aW9uKCBsZXZlbCApIHsKICAgICAgICByZXR1cm4gTG9nQ29yZV9pc0xldmVsRW5hYmxlZCggbGV2ZWwgKTsKICAgIH0KICAgIAogICAgCiAgIC8qKgogICAqIExvZyBhIG1lc3NhZ2UgYXQgYHRyYWNlYCBsZXZlbC4KICAgKiAKICAgKiBVc2UgdGhlIHRyYWNlIGZ1bmN0aW9uIHRvIGxvZyB2ZXJ5IGRldGFpbGVkIGluZm9ybWF0aW9uLCBzdWNoIGFzCiAgICogZW50ZXJpbmcvbGVhdmluZyBmdW5jdGlvbnMsIHZhbHVlcyBvZiBwYXJhbWV0ZXJzLCBldGMuIE1vc3Qgb2Z0ZW4gdXNlZAogICAqIGFzIGEgZGV0YWlsZWQgZGVidWcgZmFjaWxpdHkgZm9yIGEgc3BlY2lmaWMgcHJvYmxlbSAKICAgKiAKICAgKiBAc3ludGF4IExvZy50cmFjZSggYXJnLCAuLi4gKQogICAqIEBwYXJhbSB7Li4uT2JqZWN0fSBhcmcgVGhlIGFyZ3VtZW50KHMpIHRvIGxvZy4gTXVzdCBiZSBjb252ZXJ0YWJsZSB0byBTdHJpbmcKICAgKiBAbmFtZSBMb2cudHJhY2UKICAgKiBAbWV0aG9kCiAgICogQGV4YW1wbGUKTG9nLnRyYWNlKCAiRW50ZXJpbmcgZnVuY3Rpb24gZm9vLCB3aXRoIHBhcmFtdGVyIGJhcj0iLCBiYXIgKTsKICAgKi8KICAgIHRoYXQudHJhY2UgPSBmdW5jdGlvbiggKSB7CglpZiAoIExvZ0NvcmVfaXNMZXZlbEVuYWJsZWQoICJ0cmFjZSIgKSApIHsKICAgICAgICAgICAgbG9nKCAidHJhY2UiLCBhcmd1bWVudHMgKTsKCX07CiAgICB9OwogICAgLyoqCiAgICogTG9nIGEgbWVzc2FnZSBhdCBgZGVidWdgIGxldmVsLgogICAqIAogICAqIFVzZSB0aGUgZGVidWcgZnVuY3Rpb24gdG8gbG9nIGRlYnVnIGluZm9ybWF0aW9uLCBzdWNoIGFzIHRvcGxldmVsCiAgICogcHJvZ3JhbSBmbG93LCBpbXBvcnRhbnQgdmFsdWVzIHRoYXQgaW5mbHVlbmNlcyB0aGUgcHJvZ3JhbSwgZXRjLiAKICAgKiAKICAgKiBAc3ludGF4IExvZy5kZWJ1ZyggYXJnLCAuLi4gKQogICAqIEBwYXJhbSB7Li4uT2JqZWN0fSBhcmcgVGhlIGFyZ3VtZW50KHMpIHRvIGxvZy4gTXVzdCBiZSBjb252ZXJ0YWJsZSB0byBTdHJpbmcKICAgKiBAbmFtZSBMb2cuZGVidWcKICAgKiBAbWV0aG9kCiAgICogQGV4YW1wbGUKTG9nLmRlYnVnKCAiU2VydmljZSByZXR1cm5lZCB0aGUgZm9sbG93aW5nIGFuc3dlcjogIiwgc2VydmljZUFuc3dlciApOwogICAqLwogICAgdGhhdC5kZWJ1ZyA9IGZ1bmN0aW9uKCApIHsKCWlmICggTG9nQ29yZV9pc0xldmVsRW5hYmxlZCggImRlYnVnIiApICkgewogICAgICAgICAgICBsb2coICJkZWJ1ZyIsIGFyZ3VtZW50cyApOwoJfTsKICAgIH07CiAgICAvKioKICAgKiBMb2cgYSBtZXNzYWdlIGF0IGBpbmZvYCBsZXZlbC4KICAgKiAKICAgKiBVc2UgdGhlIGluZm8gZnVuY3Rpb24gdG8gbG9nIGluZm9ybWF0aW9uIG9mIGEgJ3N0YXR1cycgbGlrZSB0eXBlLCBzdWNoCiAgICogYXMgc3RhdGUgY2hhbmdlcywgaG93IGZhciBhIGdpdmVuIHByb2Nlc3MgaGFzIHByb2dyZXNzZWQsIGV0Yy4gCiAgICogCiAgICogQHN5bnRheCBMb2cuaW5mbyggYXJnLCAuLi4gKQogICAqIEBwYXJhbSB7Li4uT2JqZWN0fSBhcmcgVGhlIGFyZ3VtZW50KHMpIHRvIGxvZy4gTXVzdCBiZSBjb252ZXJ0YWJsZSB0byBTdHJpbmcKICAgKiBAbmFtZSBMb2cuaW5mbwogICAqIEBtZXRob2QKICAgKiBAZXhhbXBsZQpMb2cuaW5mbyggIlRhc2sgd2l0aCB0YXNrSWQgIiwgdGFza0lkLCAiIG5vdyBkb25lIGFuZCB1bmxvYWRlZCIgKTsKICAgKi8KICAgIHRoYXQuaW5mbyA9IGZ1bmN0aW9uKCApIHsKCWlmICggTG9nQ29yZV9pc0xldmVsRW5hYmxlZCggImluZm8iICkgKSB7CiAgICAgICAgICAgIGxvZyggImluZm8iLCBhcmd1bWVudHMgKTsKCX07CiAgICB9OwogICAgLyoqCiAgICogTG9nIGEgbWVzc2FnZSBhdCBgd2FybmAgbGV2ZWwuCiAgICogCiAgICogVXNlIHRoZSB3YXJuIGZ1bmN0aW9uIHRvIGxvZyB3YXJuaW5ncyBhYm91dCBleHBlY3RhdGlvbnMgdGhhdCBoYXZlIG5vdAogICAqIGJlZW4gbWV0LCBidXQgdGhhdCB0aGUgcHJvZ3JhbSBpcyBzdGlsbCBhYmxlIHRvIHdvcmsgYXJvdW5kLiBUaGUKICAgKiBwcm9ibGVtIHNob3VsZCBub3QgaGF2ZSBhIGJpZyBpbXBhY3Qgb24gdGhlIHByb2Nlc3MsIGJ1dCBhIHdhcm5pbmcKICAgKiBzaG91bGQgaW5kaWNhdGUgdGhhdCB0aGUgdXNlciBtYXkgd2FudCB0byBpbnZlc3RpZ2F0ZSBpZiB0aGUgd2FybmluZyBpcwogICAqIGEgc3ltcHRvbSBvZiBzb21ldGhpbmcgdGhhdCBzaG91bGQgYmUgY29ycmVjdGVkLiAKICAgKiAKICAgKiBAc3ludGF4IExvZy53YXJuKCBhcmcsIC4uLiApCiAgICogQHBhcmFtIHsuLi5PYmplY3R9IGFyZyBUaGUgYXJndW1lbnQocykgdG8gbG9nLiBNdXN0IGJlIGNvbnZlcnRhYmxlIHRvIFN0cmluZwogICAqIEBuYW1lIExvZy53YXJuCiAgICogQG1ldGhvZAogICAqIEBleGFtcGxlCkxvZy53YXJuKCAiTm8gcmVzcG9uc2UgZnJvbSBzZXJ2aWNlIC0gd2lsbCByZXRyeSBpbiA1IG1pbnV0ZXMiICk7CiAgICovCiAgICB0aGF0Lndhcm4gPSBmdW5jdGlvbiggKSB7CglpZiAoIExvZ0NvcmVfaXNMZXZlbEVuYWJsZWQoICJ3YXJuIiApICkgewogICAgICAgICAgICBsb2coICJ3YXJuIiwgYXJndW1lbnRzICk7Cgl9OwogICAgfTsKICAgIC8qKgogICAqIExvZyBhIG1lc3NhZ2UgYXQgYGVycm9yYCBsZXZlbC4KICAgKiAKICAgKiBVc2UgdGhlIGVycm9yIGZ1bmN0aW9uIHRvIGxvZyBlcnJvcnMgZm9yIGEgZ2l2ZW4gcHJvY2VzcyB0aGF0IHRoZQogICAqIHByb2dyYW0gY2FuIG5vdCBjb3JyZWN0LiBBbiBlcnJvciBpbmRpY2F0ZXMgdGhhdCB0aGUgZ2l2ZW4gdGFzayBhdCBoYW5kCiAgICogY2FuIG5vdCBiZSBjb21wbGV0ZWQuIEhvd2V2ZXIsIG90aGVyIHRhc2tzIG1heSB2ZXJ5IHdlbGwgYmUgYWJsZSB0byBiZQogICAqIHByb2Nlc3NlZC4gVGhlIHVzZXIgc2hvdWxkIGRlZmluaXRpdmVseSBpbnZlc3RpZ2F0ZSB0aGUgcmVhc29uIGZvciB0aGUKICAgKiBlcnJvciBhbmQgaWYgcG9zc2libHkgY29ycmVjdCBpdC4gCiAgICogCiAgICogQHN5bnRheCBMb2cuZXJyb3IoIGFyZywgLi4uICkKICAgKiBAcGFyYW0gey4uLk9iamVjdH0gYXJnIFRoZSBhcmd1bWVudChzKSB0byBsb2cuIE11c3QgYmUgY29udmVydGFibGUgdG8gU3RyaW5nCiAgICogQG5hbWUgTG9nLmVycm9yCiAgICogQG1ldGhvZAogICAqIEBleGFtcGxlCkxvZy5lcnJvciggIkVycm9yIHdoZW4gaGFuZGxpbmcgdGFzazogdGFza3R5cGUgd2FzIGVtcHR5LiBUYXNrIGNhbiBub3QgYmUgaGFuZGxlZCIgKTsKICAgKi8KICAgIHRoYXQuZXJyb3IgPSBmdW5jdGlvbiggKSB7CglpZiAoIExvZ0NvcmVfaXNMZXZlbEVuYWJsZWQoICJlcnJvciIgKSApIHsKICAgICAgICAgICAgbG9nKCAiZXJyb3IiLCBhcmd1bWVudHMgKTsKCX07CiAgICB9OwoKICAvKioKICAgKiBMb2cgYSBtZXNzYWdlIGF0IGBmYXRhbGAgbGV2ZWwuCiAgICogCiAgICogVXNlIHRoZSBmYXRhbCBmdW5jdGlvbiB0byBsb2cgYSBmYXRhbCBwcm9ibGVtLCB0aGF0IHN0b3BzIHRoZSBwcm9ncmFtCiAgICogZnJvbSBiZWluZyBhYmxlIHRvIHByb2NlZWQgYXQgYWxsLCBvciB3aXRob3V0IHJpc2sgb2Ygc2V2ZXJlCiAgICogcHJvYmxlbXMvY29ycnVwdGlvbiBvZiBkYXRhLiBJdCBpcyBwcm9iYWJseSBub3QgYSBmdW5jdGlvbiBtdWNoIHVzZWQKICAgKiBmcm9tIEphdmFTY3JpcHQuIAogICAqIAogICAqICoqTm90ZToqKiBOb3QgYWxsIGxvZyBmcmFtZXdvcmtzIHN1cHBvcnRzIHRoZSBmYXRhbCBsZXZlbC4gSW4gdGhhdCBjYXNlLCBpdCB3aWxsIGJlIGNvbnZlcnRlZCB0byBhbiBlcnJvciBsZXZlbC4KICAgKiAKICAgKiBAc3ludGF4IExvZy5mYXRhbCggYXJnLCAuLi4gKQogICAqIEBwYXJhbSB7Li4uT2JqZWN0fSBhcmcgVGhlIGFyZ3VtZW50KHMpIHRvIGxvZy4gTXVzdCBiZSBjb252ZXJ0YWJsZSB0byBTdHJpbmcKICAgKiBAbmFtZSBMb2cuZmF0YWwKICAgKiBAbWV0aG9kCiAgICogQGV4YW1wbGUKTG9nLmZhdGFsKCAiQ29uZmlndXJhdGlvbiBlcnJvciBpbiBzb21lb2JqZWN0LnNvbWV2YWx1ZS4gVGhpcyBvcHRpb24gd2FzIGluY29ycmVjdGx5IHNldC4gQWJvcnRpbmciICk7CiAgICovCiAgICB0aGF0LmZhdGFsID0gZnVuY3Rpb24oICkgewoJaWYgKCBMb2dDb3JlX2lzTGV2ZWxFbmFibGVkKCAiZmF0YWwiICkgKSB7CiAgICAgICAgICAgIGxvZyggImZhdGFsIiwgYXJndW1lbnRzICk7Cgl9OwogICAgfTsKCiAgICAvKioKICAgICAqIExvZyBhIG1lc3NhZ2UgYXQgYG1hZ2ljYCBsZXZlbC4KICAgICAqIAogICAgICogVGhlIG1hZ2ljIGZ1bmN0aW9uIGlzIGEgc3BlY2lhbCBsb2cgZnVuY3Rpb24uIEl0IGlzIHVzZWQgdG8gbG9nIGEKICAgICAqIGZ1bmN0aW9uIGNhbGwgd2l0aCB0aGUgcGFyYW1ldGVycywgd2hlcmUgdGhlIHBhcmFtZXRlcnMgd2lsbCBiZQogICAgICogJ21hZ2ljYWxseScgZXZhbHVhdGVkIGJlZm9yZSBwcmludGVkLiBUaGUgbGV2ZWwgaXMgJ21hZ2ljJywgYW5kIHRoZQogICAgICogZmVhdHVyZSBpcyBleHBlcmltZW50YWwsIGFuZCBtYXkgbm90IG1ha2UgaXQgdG8gcHJvZHVjdGlvbi4gCiAgICAgKiAKICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBpcyBleHBlcmltZW50YWwuCiAgICAgKgogICAgICogQHBhcmFtIHtYTUx9IGFyZyBUaGUgYXJndW1lbnQgdG8gbG9nLiBNdXN0IGJlIFhNTAogICAgICogQG5hbWUgTG9nLm1hZ2ljCiAgICAgKiBAbWV0aG9kCiAgICAgKi8KICAgIHRoYXQubWFnaWMgPSBmdW5jdGlvbiggeG1sICkgewogICAgICAgIC8vIFRoaXMgZnVuY3Rpb24gY2hlY2tzIHRoZSBjb250ZXN0IAogICAgICAgIGlmICggdHlwZW9mIHhtbCAhPT0gInhtbCIgKSB7CiAgICAgICAgICAgIGxvZyggIndhcm4iLCAibWFnaWMgY2FsbGVkIHdpdGggbm9uIHhtbCBhcmd1bWVudDogIiwgeG1sICk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBwYXJhbVRvU3RyaW5nKCApIHsKICAgICAgICAgICAgcmVzID0gWyBdOwogICAgICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyArK2kgKSB7CiAgICAgICAgICAgICAgICAvLyBTcGVjaWFsY2FzZSB1bmRlZmluZWQgLSBpZiBzb21ldGhpbmcgcmV0dXJucyB1bmRlZmluZWQKICAgICAgICAgICAgICAgIGlmICggYXJndW1lbnRzWyBpIF0gPT09IHVuZGVmaW5lZCApIHsKICAgICAgICAgICAgICAgICAgICByZXMucHVzaCggInVuZGVmaW5lZCIgKTsKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIFNwZWNpYWxjYXNlIGFycmF5cywgYXMgdGhlaXIgdG9TdHJpbmcgbWV0aG9kIGlzIGEgYml0IHdhY2t5CiAgICAgICAgICAgICAgICBpZiAoIF8uaXNBcnJheSggYXJndW1lbnRzWyBpIF0gKSApIHsKICAgICAgICAgICAgICAgICAgICByZXMucHVzaCggIlsgIiArIGFyZ3VtZW50c1sgaSBdLnRvU3RyaW5nKCApICsgIiBdIiApOwogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKCB0eXBlb2YgYXJndW1lbnRzWyBpIF0gPT09ICJzdHJpbmciICkgewogICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKCAnIicgKyBhcmd1bWVudHNbIGkgXS50b1N0cmluZyggKSArICciJyApOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXMucHVzaCggYXJndW1lbnRzWyBpIF0udG9TdHJpbmcoICkgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcmVzLmpvaW4oICIsICIgKTsKICAgICAgICB9CgogICAgICAgIGNvbnRlbnQgPSB4bWwudG9TdHJpbmcoICk7CiAgICAgICAgLy8gUmVwbGFjZSB1cHRvIHRoZSBmaXJzdCAoIHdpdGggcGFyYW1Ub1N0cmluZywgZXZhbCBpdCwgYW5kIHByaW50IGl0CiAgICAgICAgLy8gY2JvOiBmZWVsIGZyZWUgdG8gcmVwbGFjZSB0aGlzIHdpdGggc29tZXRoaW5nIGNsZXZlciB1c2luZyByZWdleHBzLi4uCiAgICAgICAgYWxsID0gY29udGVudC5zcGxpdCggIigiICk7CiAgICAgICAgZnVuYyA9IGFsbC5zaGlmdCggKTsKICAgICAgICByZXBsYWNlID0gInBhcmFtVG9TdHJpbmcoIiArIGFsbC5qb2luKCAiKCIgKTsKICAgICAgICBuZXdhcmdzID0gZXZhbCggcmVwbGFjZSApOwogICAgICAgIGNvbXBsZXRlID0gZnVuYyArICIoICIgKyBuZXdhcmdzICsgIiApIjsKICAgICAgICBsb2coICJtYWdpYyIsIFsgIkZ1bmN0aW9uIHdhcyBjYWxsZWQgbGlrZSB0aGlzOlxuIiwgY29udGVudCwgIlxuQWZ0ZXIgcGFyYW1ldGVyIGV2YWx1YXRpbmc6XG4iLCBjb21wbGV0ZSBdICk7CiAgICB9OwoKCiAgICAvLyBTZXR1cCB0aGUgdHdvICJhZHZhbmNlZCIgZnVuY3Rpb25zIGZyb20gYWJvdmUKICAgIGlmICggdGhpcy5fX0xvZ0NvcmVfaXNMZXZlbEVuYWJsZWQgKSB7CglMb2dDb3JlX2lzTGV2ZWxFbmFibGVkID0gX19Mb2dDb3JlX2lzTGV2ZWxFbmFibGVkOwoJZGVsZXRlIHRoaXMuX19Mb2dDb3JlX2lzTGV2ZWxFbmFibGVkOwogICAgfSBlbHNlIHsKCS8vIER1bW15IGZ1bmN0aW9uIC0gYWxsIGlzIHRydWUKCUxvZ0NvcmVfaXNMZXZlbEVuYWJsZWQgPSBmdW5jdGlvbiggbGV2ZWwgKSB7IHJldHVybiB0cnVlOyB9CiAgICAgICAgLy8gbWJkOiAyMDEzLTEwLTMxCiAgICAgICAgLy8gVGhlIEMrKyBsb2dnaW5nIGZyYW1ld29yayBkb2VzIG5vdCwgYW5kIHByb2JhYmx5IHdpbGwgbm90LCBzdXBwb3J0IHNvbWV0aGluZwogICAgICAgIC8vIGxpa2UgaXNMZXZlbEVuYWJsZWQsIGFuZCBpdCBpcyBhbHNvIHNwZWVkeSBlbm91Z2ggdG8gbm90IG1hdHRlci4KICAgICAgICAvLyBUaGUgY2hlY2sgdGhlbiBlbmRzIHVwIGFkZGluZyBhIGxvdCBvZiBub2lzZSBpbnRvIHNvbWUgYXBwbGljYXRpb25zLCBzdWNoIGFzIAogICAgICAgIC8vIGVzZ2Fyb3RoLCB3aGVyZSBhIHdhcm5pbmcgaXMgbG9nZ2VkIGZvciBlYWNoIEphdmFTY3JpcHQgZW52aXJvbm1lbnQgY3JlYXRlZC4KICAgICAgICAvLyBTbywgaXQgaXMgYmVzdCBub3QgdG8gZG8gdGhpcyBjaGVjayB1bmRlciBDKysuCiAgICAgICAgLy8gQnV0LCBpZiB0aGlzIGlzIEphdmEsIGNoZWNrIGlmIHRoZSBwZXJmb3JtYW5jZSBjb3VsZCBiZSBpbXByb3ZlZCBieSAKICAgICAgICAvLyBhZGRpbmcgYSAibmF0aXZlIiBfX0xvZ0NvcmVfaXNMZXZlbEVuYWJsZWQgZnVuY3Rpb24uCiAgICAgICAgLy8gVGhpcyBjaGVjayBpcyBhbiBleGNlcHRpb24gdG8gdGhlIHJ1bGUgdGhhdCB3ZSBkbyBub3QgY2hlY2sgZm9yIHBsYXRmb3JtcyBpbiBub24gKkNvcmUgbW9kdWxlcy4KICAgICAgICAvLyBZb3UgYXJlIG5vdCBlbnRpdGxlZCB0byBkbyB0aGlzIG90aGVyIHBsYWNlcy4gRmVlbCBmcmVlIHRvIGNvbXBsYWluIGFib3V0IHRoaXMgdW5mYWlybmVzcyBvZiBsaWZlCiAgICAgICAgLy8gb24geW91ciBmYXZvcml0ZSBzb2NpYWwgbmV0d29yaywgb3Igc29tZXRoaW5nLCBhcyBsb25nIGFzIHlvdSBkb24ndCBleHBlY3QgYW55b25lIHRvIGNhcmUuLi4gOy0pCiAgICAgICAgaWYgKCBHbG9iYWwuUGFja2FnZXMgJiYgR2xvYmFsLlBhY2thZ2VzLmphdmEgKSB7CiAgICAgICAgICAgIHRoYXQud2FybiggIkphdmEgaW50ZXJwcmVudGVyIGRldGVjdGVkLCBhbmQgTG9nQ29yZSBtb2R1bGUgZG9lcyBub3QgZXhwb3J0IF9fTG9nQ29yZV9pc0xldmVsRW5hYmxlZCAtIG1heSBpbXBhY3QgbG9nZ2luZyBwZXJmb3JtYW5jZSIgKTsKICAgICAgICB9IAogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBUZXN0IHRoZSBjb2xsZWN0IGZ1bmN0aW9uLiAKICAgIFVuaXRUZXN0LmFkZEZpeHR1cmUoICJkZXZlbC5Mb2cgaW50ZXJuYWwiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGNvbFdyYXAgPSBmdW5jdGlvbigpIHsgcmV0dXJuIGNvbGxlY3QoIGFyZ3VtZW50cyApOyB9OwogICAgICAgIEFzc2VydC5lcXVhbFZhbHVlKCAiY29sbGVjdCwgZW1wdHkgYXJndW1lbnRzIiwgY29sV3JhcCgpLCAiIiApOwogICAgICAgIEFzc2VydC5lcXVhbFZhbHVlKCAiY29sbGVjdCwgb25lIGFyZ3VtZW50IiwgY29sV3JhcCggImhlaiIgKSwgImhlaiIgKTsKICAgICAgICBBc3NlcnQuZXF1YWxWYWx1ZSggImNvbGxlY3QsIHR3byBhcmd1bWVudHMiLCBjb2xXcmFwKCAiaGVqIiwgNDIgKSwgImhlajQyIiApOwogICAgICAgIEFzc2VydC5lcXVhbFZhbHVlKCAiY29sbGVjdCwgbXVsdGlwbGUgYXJndW1lbnQiLCBjb2xXcmFwKCAiaGVqIiwgNDMsICJtZWQiLCAyLzIgKSwgImhlajQzbWVkMSIgKTsKICAgIH0pOwogICAgCiAgICAvLyBSZXR1cm4gdGhlIExvZyBvYmplY3QKICAgIHJldHVybiB0aGF0Owp9KCApOwoKVW5pdFRlc3QuYWRkRml4dHVyZSggImRldmVsLkxvZyBtb2R1bGUiLCBmdW5jdGlvbiggKSB7CiAgICAgICAgLy8gVGhpcyBtb3N0bHkgY2hlY2tzIGlmIHRoZSBsb2cgZG9lcyBub3QgdGhyb3cgZXJyb3JzLCAKICAgICAgICAvLyBzZWUgYnVnIDE0Mzk5CiAgICAgICAgX19Mb2dfdXQgPSB7fTsKICAgICAgICBfX0xvZ191dC5mb28gPSB7fQogICAgICAgIF9fTG9nX3V0LmZvby5hID0gImEiOwogICAgICAgIF9fTG9nX3V0LmZvby5mb28gPSBudWxsOwogICAgICAgIF9fTG9nX3V0LmZvby5iYXIgPSB1bmRlZmluZWQ7CgogICAgICAgIEFzc2VydC5lcXVhbCggIkxvZy5kZWJ1ZyB3aXRoIG9iamVjdCIsICdMb2cuZGVidWcoIF9fTG9nX3V0ICknLCB1bmRlZmluZWQgKTsKICAgICAgICBBc3NlcnQuZXF1YWwoICJMb2cuZGVidWcgd2l0aCB2YWx1ZSIsICdMb2cuZGVidWcoIF9fTG9nX3V0LmZvby5hICknLCB1bmRlZmluZWQgKTsKICAgICAgICBBc3NlcnQuZXF1YWwoICJMb2cuZGVidWcgd2l0aCBudWxsIiwgJ0xvZy5kZWJ1ZyggX19Mb2dfdXQuZm9vLmZvbyApJywgdW5kZWZpbmVkICk7CiAgICAgICAgQXNzZXJ0LmVxdWFsKCAiTG9nLmRlYnVnIHdpdGggdW5kZWZpbmVkIiwgJ0xvZy5kZWJ1ZyggX19Mb2dfdXQuZm9vLmJhciApJywgdW5kZWZpbmVkICk7CgogICAgICAgIGRlbGV0ZSBfX0xvZ191dDsKICAgIH0gKTsK", "moduleName": "Log"}, {"javascript": "Ly8gTG9nQ29yZSBtb2R1bGUgLSBpbXBsZW1lbnRzIGEgX19Mb2dDb3JlX2xvZyggbGV2ZWwsIGFyZ3MgKSBmdW5jdGlvbgoKLyogSmF2YSBNYXZlbiBkZXBzIG5lZWRlZDoKCiAgICAgICAgICAgICAgICA8IS0tIExPR0dJTkcgLS0+CiAgICAgICAgICAgICAgICA8IS0tIEluIG9yZGVyIHRvIHN1cHBvcnQgZGlmZmVyZW50IGxvZyBmcmFtZXdvcmtzLCB3ZSB1c2UgYSBmYWNhZGUgcGF0dGVybiAKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGxvZ2dpbmcgVGhlIGFjdHVhbCBmYWNhZGUgcGF0dGVybiBpcyBzbGY0aiwgd2hpY2ggaXMgd2hhdCBkYmMtY29tbW9ucyAKICAgICAgICAgICAgICAgICAgICAgICAgaXMgZ29pbmcgdG8gdXNlIHRvby4gRm9yIGFjdHVhbCBsb2dnaW5nIGluIHRoZSBkZXBsb3ltZW50LCB3ZSB1c2UgbG9nNGouIC0tPgogICAgICAgICAgICAgICAgPGRlcGVuZGVuY3k+CiAgICAgICAgICAgICAgICAgICAgICAgIDxncm91cElkPm9yZy5zbGY0ajwvZ3JvdXBJZD4KICAgICAgICAgICAgICAgICAgICAgICAgPGFydGlmYWN0SWQ+c2xmNGotYXBpPC9hcnRpZmFjdElkPgogICAgICAgICAgICAgICAgICAgICAgICA8dmVyc2lvbj4xLjYuMTwvdmVyc2lvbj4KICAgICAgICAgICAgICAgIDwvZGVwZW5kZW5jeT4KICAgICAgICAgICAgICAgIDxkZXBlbmRlbmN5PgogICAgICAgICAgICAgICAgICAgICAgICA8Z3JvdXBJZD5vcmcuc2xmNGo8L2dyb3VwSWQ+CiAgICAgICAgICAgICAgICAgICAgICAgIDxhcnRpZmFjdElkPnNsZjRqLWV4dDwvYXJ0aWZhY3RJZD4KICAgICAgICAgICAgICAgICAgICAgICAgPHZlcnNpb24+MS42LjE8L3ZlcnNpb24+CiAgICAgICAgICAgICAgICA8L2RlcGVuZGVuY3k+IAoqLwoKLyogWW91IG1heSBhbHNvIHdhbnQgdG8gYWN0dWFsbHkgYmluZCB0byBlLmcuIGxvZzRqOgoKICAgICAgICAgICAgICAgIDwhLS0gVGhpcyBvbmUgYmluZHMgdG8gbG9nNGogaW4gdGhlIGRlcGxveW1lbnQuIC0tPgogICAgICAgICAgICAgICAgPGRlcGVuZGVuY3k+CiAgICAgICAgICAgICAgICAgICAgICAgIDxncm91cElkPm9yZy5zbGY0ajwvZ3JvdXBJZD4KICAgICAgICAgICAgICAgICAgICAgICAgPGFydGlmYWN0SWQ+c2xmNGotbG9nNGoxMjwvYXJ0aWZhY3RJZD4KICAgICAgICAgICAgICAgICAgICAgICAgPHZlcnNpb24+MS42LjE8L3ZlcnNpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzY29wZT5ydW50aW1lPC9zY29wZT4KICAgICAgICAgICAgICAgIDwvZGVwZW5kZW5jeT4KICAgICAgICAgICAgICAgIDwhLS0gSW4gbG9nIHdlIHRydXN0IDogaHR0cDovL2xvZ2dpbmcuYXBhY2hlLm9yZy9sb2c0ai8gLS0+CiAgICAgICAgICAgICAgICA8ZGVwZW5kZW5jeT4KICAgICAgICAgICAgICAgICAgICAgICAgPGdyb3VwSWQ+bG9nNGo8L2dyb3VwSWQ+CiAgICAgICAgICAgICAgICAgICAgICAgIDxhcnRpZmFjdElkPmxvZzRqPC9hcnRpZmFjdElkPgogICAgICAgICAgICAgICAgICAgICAgICA8dmVyc2lvbj4xLjIuMTY8L3ZlcnNpb24+CiAgICAgICAgICAgICAgICA8L2RlcGVuZGVuY3k+CiAgICAgICAgICAgICAgICA8IS0tIEVORCBMT0dHSU5HIC0tPgoqLwoKCi8vIFdlIGV4cG9ydCB0aGlzIHN5bWJvbCwgd2hpY2ggd2UgZXhwZWN0IHRvIGJlIHVzZWQgZnJvbSBhIExvZyBtb2R1bGUuCkVYUE9SVEVEX1NZTUJPTFMgPSBbICdfX0xvZ0NvcmVfbG9nJywgJ19fTG9nQ29yZV9pc0xldmVsRW5hYmxlZCcgXTsKCi8vIEFjdHVhbCBsb2cgZnVuY3Rpb24KdmFyIF9fTG9nQ29yZV9sb2cgPSBmdW5jdGlvbiggbGV2ZWwsIG1zZyApIHsKICAgIG1zZyA9ICJKUzogIiArIG1zZzsKICAgIC8vIFJoaW5vIHNwZWNpZmljIGJpbmRpbmdzIHV0aWxpemVkLgogICAgc3dpdGNoKCBsZXZlbCApIHsKICAgIGNhc2UgInRyYWNlIiA6IF9fTG9nQ29yZV9sb2cubG9nZ2VyLnRyYWNlKCBtc2cgKTsgYnJlYWs7CiAgICBjYXNlICJkZWJ1ZyIgOiBfX0xvZ0NvcmVfbG9nLmxvZ2dlci5kZWJ1ZyggbXNnICk7IGJyZWFrOwogICAgY2FzZSAiaW5mbyIgIDogX19Mb2dDb3JlX2xvZy5sb2dnZXIuaW5mbyggbXNnICk7IGJyZWFrOwogICAgY2FzZSAid2FybiIgIDogX19Mb2dDb3JlX2xvZy5sb2dnZXIud2FybiggbXNnICk7IGJyZWFrOwogICAgY2FzZSAiZXJyb3IiIDogX19Mb2dDb3JlX2xvZy5sb2dnZXIuZXJyb3IoIG1zZyApOyBicmVhazsKICAgIGNhc2UgImZhdGFsIiA6IF9fTG9nQ29yZV9sb2cubG9nZ2VyLmVycm9yKCAiRkFUQUw6ICIgKyBtc2cgKTsgYnJlYWs7CiAgICBkZWZhdWx0ICAgICAgOiBfX0xvZ0NvcmVfbG9nLmxvZ2dlci5lcnJvciggIlVOS05PV04gTE9HTEVWRUw6ICIgKyBsZXZlbCArICIgOiAiICsgbXNnICk7IGJyZWFrOwogICAgfQp9OwoKLy8gQ2hlY2sgbGV2ZWwgZXhwb3J0Cl9fTG9nQ29yZV9pc0xldmVsRW5hYmxlZCA9IGZ1bmN0aW9uICggbGV2ZWwgKSB7CiAgICBzd2l0Y2ggKCBsZXZlbCApIHsKICAgIGNhc2UgInRyYWNlIiA6IHJldHVybiBfX0xvZ0NvcmVfbG9nLmxvZ2dlci5pc1RyYWNlRW5hYmxlZCgpOwogICAgY2FzZSAiZGVidWciIDogcmV0dXJuIF9fTG9nQ29yZV9sb2cubG9nZ2VyLmlzRGVidWdFbmFibGVkKCk7CiAgICBjYXNlICJpbmZvIiAgOiByZXR1cm4gX19Mb2dDb3JlX2xvZy5sb2dnZXIuaXNJbmZvRW5hYmxlZCgpOwogICAgY2FzZSAid2FybiIgIDogcmV0dXJuIF9fTG9nQ29yZV9sb2cubG9nZ2VyLmlzV2FybkVuYWJsZWQoKTsKICAgIGNhc2UgImVycm9yIiA6IHJldHVybiBfX0xvZ0NvcmVfbG9nLmxvZ2dlci5pc0Vycm9yRW5hYmxlZCgpOwogICAgZGVmYXVsdDogcmV0dXJuIHRydWU7CiAgICB9Owp9CgoKLy8gQXR0YWNoIHRoZSBsb2dnZXIgdmFyaWFibGUgdG8gdGhlIGdsb2JhbCBsb2dnZXIgb25seSBvbmNlLCBub3QgZm9yIGVhY2gKLy8gZnVuY3Rpb24gY2FsbC4KLy8gU29ydCBvZiB0aGUgc3RhdGljIHdheSB0byBkbyBpdC4KCi8vIFRoZSBuZXh0IGxpbmUgY2FuIGJpbmQgKmRpcmVjdGx5KiB0byBsb2c0ai4gSXQgaXMgb25seSBpbmNsdWRlZCBmb3IKLy8gcmVmZXJlbmNlLCBhcwovLyB0aGUgZmFjYWRlIGJlbG93IGlzIHRoZSByZWNvbW1lbmRlZCB3YXkgdG8gZG8gaXQuCi8vIF9fTG9nQ29yZV9sb2cubG9nZ2VyID0gUGFja2FnZXMub3JnLmFwYWNoZS5sb2c0ai5Mb2dnZXIuZ2V0TG9nZ2VyKAovLyAiSmF2YVNjcmlwdC5Mb2dnZXIiICk7CgovLyBCaW5kaW5nIHRvIHRoZSBzbGY0aiBmYWNhZGUuCl9fTG9nQ29yZV9sb2cubG9nZ2VyID0gUGFja2FnZXMub3JnLnNsZjRqLkxvZ2dlckZhY3RvcnkKICAgIC5nZXRMb2dnZXIoICJKYXZhU2NyaXB0LkxvZ2dlciIgKTsK", "moduleName": "LogCore"}, {"javascript": "LyoqIEBmaWxlIFVuZGVyc2NvcmUgbW9kdWxlLCBleHRlcm5hbCBmaWxlICovCkVYUE9SVEVEX1NZTUJPTFMgPSBbIl8iXTsKLy8gICAgIFVuZGVyc2NvcmUuanMgMS4xLjQKLy8gICAgIChjKSAyMDExIEplcmVteSBBc2hrZW5hcywgRG9jdW1lbnRDbG91ZCBJbmMuCi8vICAgICBVbmRlcnNjb3JlIGlzIGZyZWVseSBkaXN0cmlidXRhYmxlIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4KLy8gICAgIFBvcnRpb25zIG9mIFVuZGVyc2NvcmUgYXJlIGluc3BpcmVkIG9yIGJvcnJvd2VkIGZyb20gUHJvdG90eXBlLAovLyAgICAgT2xpdmVyIFN0ZWVsZSdzIEZ1bmN0aW9uYWwsIGFuZCBKb2huIFJlc2lnJ3MgTWljcm8tVGVtcGxhdGluZy4KLy8gICAgIEZvciBhbGwgZGV0YWlscyBhbmQgZG9jdW1lbnRhdGlvbjoKLy8gICAgIGh0dHA6Ly9kb2N1bWVudGNsb3VkLmdpdGh1Yi5jb20vdW5kZXJzY29yZQoKKGZ1bmN0aW9uKCkgewoKICAvLyBCYXNlbGluZSBzZXR1cAogIC8vIC0tLS0tLS0tLS0tLS0tCgogIC8vIEVzdGFibGlzaCB0aGUgcm9vdCBvYmplY3QsIGB3aW5kb3dgIGluIHRoZSBicm93c2VyLCBvciBgZ2xvYmFsYCBvbiB0aGUgc2VydmVyLgogIHZhciByb290ID0gdGhpczsKCiAgLy8gU2F2ZSB0aGUgcHJldmlvdXMgdmFsdWUgb2YgdGhlIGBfYCB2YXJpYWJsZS4KICB2YXIgcHJldmlvdXNVbmRlcnNjb3JlID0gcm9vdC5fOwoKICAvLyBFc3RhYmxpc2ggdGhlIG9iamVjdCB0aGF0IGdldHMgcmV0dXJuZWQgdG8gYnJlYWsgb3V0IG9mIGEgbG9vcCBpdGVyYXRpb24uCiAgdmFyIGJyZWFrZXIgPSB7fTsKCiAgLy8gU2F2ZSBieXRlcyBpbiB0aGUgbWluaWZpZWQgKGJ1dCBub3QgZ3ppcHBlZCkgdmVyc2lvbjoKICB2YXIgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZSwgT2JqUHJvdG8gPSBPYmplY3QucHJvdG90eXBlLCBGdW5jUHJvdG8gPSBGdW5jdGlvbi5wcm90b3R5cGU7CgogIC8vIENyZWF0ZSBxdWljayByZWZlcmVuY2UgdmFyaWFibGVzIGZvciBzcGVlZCBhY2Nlc3MgdG8gY29yZSBwcm90b3R5cGVzLgogIHZhciBzbGljZSAgICAgICAgICAgID0gQXJyYXlQcm90by5zbGljZSwKICAgICAgdW5zaGlmdCAgICAgICAgICA9IEFycmF5UHJvdG8udW5zaGlmdCwKICAgICAgdG9TdHJpbmcgICAgICAgICA9IE9ialByb3RvLnRvU3RyaW5nLAogICAgICBoYXNPd25Qcm9wZXJ0eSAgID0gT2JqUHJvdG8uaGFzT3duUHJvcGVydHk7CgogIC8vIEFsbCAqKkVDTUFTY3JpcHQgNSoqIG5hdGl2ZSBmdW5jdGlvbiBpbXBsZW1lbnRhdGlvbnMgdGhhdCB3ZSBob3BlIHRvIHVzZQogIC8vIGFyZSBkZWNsYXJlZCBoZXJlLgogIHZhcgogICAgbmF0aXZlRm9yRWFjaCAgICAgID0gQXJyYXlQcm90by5mb3JFYWNoLAogICAgbmF0aXZlTWFwICAgICAgICAgID0gQXJyYXlQcm90by5tYXAsCiAgICBuYXRpdmVSZWR1Y2UgICAgICAgPSBBcnJheVByb3RvLnJlZHVjZSwKICAgIG5hdGl2ZVJlZHVjZVJpZ2h0ICA9IEFycmF5UHJvdG8ucmVkdWNlUmlnaHQsCiAgICBuYXRpdmVGaWx0ZXIgICAgICAgPSBBcnJheVByb3RvLmZpbHRlciwKICAgIG5hdGl2ZUV2ZXJ5ICAgICAgICA9IEFycmF5UHJvdG8uZXZlcnksCiAgICBuYXRpdmVTb21lICAgICAgICAgPSBBcnJheVByb3RvLnNvbWUsCiAgICBuYXRpdmVJbmRleE9mICAgICAgPSBBcnJheVByb3RvLmluZGV4T2YsCiAgICBuYXRpdmVMYXN0SW5kZXhPZiAgPSBBcnJheVByb3RvLmxhc3RJbmRleE9mLAogICAgbmF0aXZlSXNBcnJheSAgICAgID0gQXJyYXkuaXNBcnJheSwKICAgIG5hdGl2ZUtleXMgICAgICAgICA9IE9iamVjdC5rZXlzLAogICAgbmF0aXZlQmluZCAgICAgICAgID0gRnVuY1Byb3RvLmJpbmQ7CgogIC8vIENyZWF0ZSBhIHNhZmUgcmVmZXJlbmNlIHRvIHRoZSBVbmRlcnNjb3JlIG9iamVjdCBmb3IgdXNlIGJlbG93LgogIHZhciBfID0gZnVuY3Rpb24ob2JqKSB7IHJldHVybiBuZXcgd3JhcHBlcihvYmopOyB9OwoKICAvLyBFeHBvcnQgdGhlIFVuZGVyc2NvcmUgb2JqZWN0IGZvciAqKkNvbW1vbkpTKiosIHdpdGggYmFja3dhcmRzLWNvbXBhdGliaWxpdHkKICAvLyBmb3IgdGhlIG9sZCBgcmVxdWlyZSgpYCBBUEkuIElmIHdlJ3JlIG5vdCBpbiBDb21tb25KUywgYWRkIGBfYCB0byB0aGUKICAvLyBnbG9iYWwgb2JqZWN0LgogIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykgewogICAgbW9kdWxlLmV4cG9ydHMgPSBfOwogICAgXy5fID0gXzsKICB9IGVsc2UgewogICAgcm9vdC5fID0gXzsKICB9CgogIC8vIEN1cnJlbnQgdmVyc2lvbi4KICBfLlZFUlNJT04gPSAnMS4xLjQnOwoKICAvLyBDb2xsZWN0aW9uIEZ1bmN0aW9ucwogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogIC8vIFRoZSBjb3JuZXJzdG9uZSwgYW4gYGVhY2hgIGltcGxlbWVudGF0aW9uLCBha2EgYGZvckVhY2hgLgogIC8vIEhhbmRsZXMgb2JqZWN0cyBpbXBsZW1lbnRpbmcgYGZvckVhY2hgLCBhcnJheXMsIGFuZCByYXcgb2JqZWN0cy4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgZm9yRWFjaGAgaWYgYXZhaWxhYmxlLgogIHZhciBlYWNoID0gXy5lYWNoID0gXy5mb3JFYWNoID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkgewogICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm47CiAgICBpZiAobmF0aXZlRm9yRWFjaCAmJiBvYmouZm9yRWFjaCA9PT0gbmF0aXZlRm9yRWFjaCkgewogICAgICBvYmouZm9yRWFjaChpdGVyYXRvciwgY29udGV4dCk7CiAgICB9IGVsc2UgaWYgKF8uaXNOdW1iZXIob2JqLmxlbmd0aCkpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBvYmoubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgaWYgKGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgb2JqW2ldLCBpLCBvYmopID09PSBicmVha2VyKSByZXR1cm47CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIGlmIChpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9ialtrZXldLCBrZXksIG9iaikgPT09IGJyZWFrZXIpIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9OwoKICAvLyBSZXR1cm4gdGhlIHJlc3VsdHMgb2YgYXBwbHlpbmcgdGhlIGl0ZXJhdG9yIHRvIGVhY2ggZWxlbWVudC4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgbWFwYCBpZiBhdmFpbGFibGUuCiAgXy5tYXAgPSBmdW5jdGlvbihvYmosIGl0ZXJhdG9yLCBjb250ZXh0KSB7CiAgICB2YXIgcmVzdWx0cyA9IFtdOwogICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0czsKICAgIGlmIChuYXRpdmVNYXAgJiYgb2JqLm1hcCA9PT0gbmF0aXZlTWFwKSByZXR1cm4gb2JqLm1hcChpdGVyYXRvciwgY29udGV4dCk7CiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIHJlc3VsdHNbcmVzdWx0cy5sZW5ndGhdID0gaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0czsKICB9OwoKICAvLyAqKlJlZHVjZSoqIGJ1aWxkcyB1cCBhIHNpbmdsZSByZXN1bHQgZnJvbSBhIGxpc3Qgb2YgdmFsdWVzLCBha2EgYGluamVjdGAsCiAgLy8gb3IgYGZvbGRsYC4gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYHJlZHVjZWAgaWYgYXZhaWxhYmxlLgogIF8ucmVkdWNlID0gXy5mb2xkbCA9IF8uaW5qZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgbWVtbywgY29udGV4dCkgewogICAgdmFyIGluaXRpYWwgPSBtZW1vICE9PSB2b2lkIDA7CiAgICBpZiAob2JqID09IG51bGwpIG9iaiA9IFtdOwogICAgaWYgKG5hdGl2ZVJlZHVjZSAmJiBvYmoucmVkdWNlID09PSBuYXRpdmVSZWR1Y2UpIHsKICAgICAgaWYgKGNvbnRleHQpIGl0ZXJhdG9yID0gXy5iaW5kKGl0ZXJhdG9yLCBjb250ZXh0KTsKICAgICAgcmV0dXJuIGluaXRpYWwgPyBvYmoucmVkdWNlKGl0ZXJhdG9yLCBtZW1vKSA6IG9iai5yZWR1Y2UoaXRlcmF0b3IpOwogICAgfQogICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICBpZiAoIWluaXRpYWwgJiYgaW5kZXggPT09IDApIHsKICAgICAgICBtZW1vID0gdmFsdWU7CiAgICAgICAgaW5pdGlhbCA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWVtbyA9IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgbWVtbywgdmFsdWUsIGluZGV4LCBsaXN0KTsKICAgICAgfQogICAgfSk7CiAgICBpZiAoIWluaXRpYWwpIHRocm93IG5ldyBUeXBlRXJyb3IoIlJlZHVjZSBvZiBlbXB0eSBhcnJheSB3aXRoIG5vIGluaXRpYWwgdmFsdWUiKTsKICAgIHJldHVybiBtZW1vOwogIH07CgogIC8vIFRoZSByaWdodC1hc3NvY2lhdGl2ZSB2ZXJzaW9uIG9mIHJlZHVjZSwgYWxzbyBrbm93biBhcyBgZm9sZHJgLgogIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGByZWR1Y2VSaWdodGAgaWYgYXZhaWxhYmxlLgogIF8ucmVkdWNlUmlnaHQgPSBfLmZvbGRyID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgbWVtbywgY29udGV4dCkgewogICAgaWYgKG9iaiA9PSBudWxsKSBvYmogPSBbXTsKICAgIGlmIChuYXRpdmVSZWR1Y2VSaWdodCAmJiBvYmoucmVkdWNlUmlnaHQgPT09IG5hdGl2ZVJlZHVjZVJpZ2h0KSB7CiAgICAgIGlmIChjb250ZXh0KSBpdGVyYXRvciA9IF8uYmluZChpdGVyYXRvciwgY29udGV4dCk7CiAgICAgIHJldHVybiBtZW1vICE9PSB2b2lkIDAgPyBvYmoucmVkdWNlUmlnaHQoaXRlcmF0b3IsIG1lbW8pIDogb2JqLnJlZHVjZVJpZ2h0KGl0ZXJhdG9yKTsKICAgIH0KICAgIHZhciByZXZlcnNlZCA9IChfLmlzQXJyYXkob2JqKSA/IG9iai5zbGljZSgpIDogXy50b0FycmF5KG9iaikpLnJldmVyc2UoKTsKICAgIHJldHVybiBfLnJlZHVjZShyZXZlcnNlZCwgaXRlcmF0b3IsIG1lbW8sIGNvbnRleHQpOwogIH07CgogIC8vIFJldHVybiB0aGUgZmlyc3QgdmFsdWUgd2hpY2ggcGFzc2VzIGEgdHJ1dGggdGVzdC4gQWxpYXNlZCBhcyBgZGV0ZWN0YC4KICBfLmZpbmQgPSBfLmRldGVjdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHsKICAgIHZhciByZXN1bHQ7CiAgICBhbnkob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHsKICAgICAgaWYgKGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSkgewogICAgICAgIHJlc3VsdCA9IHZhbHVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiByZXN1bHQ7CiAgfTsKCiAgLy8gUmV0dXJuIGFsbCB0aGUgZWxlbWVudHMgdGhhdCBwYXNzIGEgdHJ1dGggdGVzdC4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgZmlsdGVyYCBpZiBhdmFpbGFibGUuCiAgLy8gQWxpYXNlZCBhcyBgc2VsZWN0YC4KICBfLmZpbHRlciA9IF8uc2VsZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkgewogICAgdmFyIHJlc3VsdHMgPSBbXTsKICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHJlc3VsdHM7CiAgICBpZiAobmF0aXZlRmlsdGVyICYmIG9iai5maWx0ZXIgPT09IG5hdGl2ZUZpbHRlcikgcmV0dXJuIG9iai5maWx0ZXIoaXRlcmF0b3IsIGNvbnRleHQpOwogICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICBpZiAoaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSByZXN1bHRzW3Jlc3VsdHMubGVuZ3RoXSA9IHZhbHVlOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0czsKICB9OwoKICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyBmb3Igd2hpY2ggYSB0cnV0aCB0ZXN0IGZhaWxzLgogIF8ucmVqZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkgewogICAgdmFyIHJlc3VsdHMgPSBbXTsKICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHJlc3VsdHM7CiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIGlmICghaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSByZXN1bHRzW3Jlc3VsdHMubGVuZ3RoXSA9IHZhbHVlOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0czsKICB9OwoKICAvLyBEZXRlcm1pbmUgd2hldGhlciBhbGwgb2YgdGhlIGVsZW1lbnRzIG1hdGNoIGEgdHJ1dGggdGVzdC4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgZXZlcnlgIGlmIGF2YWlsYWJsZS4KICAvLyBBbGlhc2VkIGFzIGBhbGxgLgogIF8uZXZlcnkgPSBfLmFsbCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHsKICAgIGl0ZXJhdG9yID0gaXRlcmF0b3IgfHwgXy5pZGVudGl0eTsKICAgIHZhciByZXN1bHQgPSB0cnVlOwogICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0OwogICAgaWYgKG5hdGl2ZUV2ZXJ5ICYmIG9iai5ldmVyeSA9PT0gbmF0aXZlRXZlcnkpIHJldHVybiBvYmouZXZlcnkoaXRlcmF0b3IsIGNvbnRleHQpOwogICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICBpZiAoIShyZXN1bHQgPSByZXN1bHQgJiYgaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSkgcmV0dXJuIGJyZWFrZXI7CiAgICB9KTsKICAgIHJldHVybiByZXN1bHQ7CiAgfTsKCiAgLy8gRGV0ZXJtaW5lIGlmIGF0IGxlYXN0IG9uZSBlbGVtZW50IGluIHRoZSBvYmplY3QgbWF0Y2hlcyBhIHRydXRoIHRlc3QuCiAgLy8gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYHNvbWVgIGlmIGF2YWlsYWJsZS4KICAvLyBBbGlhc2VkIGFzIGBhbnlgLgogIHZhciBhbnkgPSBfLnNvbWUgPSBfLmFueSA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHsKICAgIGl0ZXJhdG9yID0gaXRlcmF0b3IgfHwgXy5pZGVudGl0eTsKICAgIHZhciByZXN1bHQgPSBmYWxzZTsKICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHJlc3VsdDsKICAgIGlmIChuYXRpdmVTb21lICYmIG9iai5zb21lID09PSBuYXRpdmVTb21lKSByZXR1cm4gb2JqLnNvbWUoaXRlcmF0b3IsIGNvbnRleHQpOwogICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICBpZiAocmVzdWx0ID0gaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSByZXR1cm4gYnJlYWtlcjsKICAgIH0pOwogICAgcmV0dXJuIHJlc3VsdDsKICB9OwoKICAvLyBEZXRlcm1pbmUgaWYgYSBnaXZlbiB2YWx1ZSBpcyBpbmNsdWRlZCBpbiB0aGUgYXJyYXkgb3Igb2JqZWN0IHVzaW5nIGA9PT1gLgogIC8vIEFsaWFzZWQgYXMgYGNvbnRhaW5zYC4KICBfLmluY2x1ZGUgPSBfLmNvbnRhaW5zID0gZnVuY3Rpb24ob2JqLCB0YXJnZXQpIHsKICAgIHZhciBmb3VuZCA9IGZhbHNlOwogICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gZm91bmQ7CiAgICBpZiAobmF0aXZlSW5kZXhPZiAmJiBvYmouaW5kZXhPZiA9PT0gbmF0aXZlSW5kZXhPZikgcmV0dXJuIG9iai5pbmRleE9mKHRhcmdldCkgIT0gLTE7CiAgICBhbnkob2JqLCBmdW5jdGlvbih2YWx1ZSkgewogICAgICBpZiAoZm91bmQgPSB2YWx1ZSA9PT0gdGFyZ2V0KSByZXR1cm4gdHJ1ZTsKICAgIH0pOwogICAgcmV0dXJuIGZvdW5kOwogIH07CgogIC8vIEludm9rZSBhIG1ldGhvZCAod2l0aCBhcmd1bWVudHMpIG9uIGV2ZXJ5IGl0ZW0gaW4gYSBjb2xsZWN0aW9uLgogIF8uaW52b2tlID0gZnVuY3Rpb24ob2JqLCBtZXRob2QpIHsKICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpOwogICAgcmV0dXJuIF8ubWFwKG9iaiwgZnVuY3Rpb24odmFsdWUpIHsKICAgICAgcmV0dXJuIChtZXRob2QgPyB2YWx1ZVttZXRob2RdIDogdmFsdWUpLmFwcGx5KHZhbHVlLCBhcmdzKTsKICAgIH0pOwogIH07CgogIC8vIENvbnZlbmllbmNlIHZlcnNpb24gb2YgYSBjb21tb24gdXNlIGNhc2Ugb2YgYG1hcGA6IGZldGNoaW5nIGEgcHJvcGVydHkuCiAgXy5wbHVjayA9IGZ1bmN0aW9uKG9iaiwga2V5KSB7CiAgICByZXR1cm4gXy5tYXAob2JqLCBmdW5jdGlvbih2YWx1ZSl7IHJldHVybiB2YWx1ZVtrZXldOyB9KTsKICB9OwoKICAvLyBSZXR1cm4gdGhlIG1heGltdW0gZWxlbWVudCBvciAoZWxlbWVudC1iYXNlZCBjb21wdXRhdGlvbikuCiAgXy5tYXggPSBmdW5jdGlvbihvYmosIGl0ZXJhdG9yLCBjb250ZXh0KSB7CiAgICBpZiAoIWl0ZXJhdG9yICYmIF8uaXNBcnJheShvYmopKSByZXR1cm4gTWF0aC5tYXguYXBwbHkoTWF0aCwgb2JqKTsKICAgIHZhciByZXN1bHQgPSB7Y29tcHV0ZWQgOiAtSW5maW5pdHl9OwogICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICB2YXIgY29tcHV0ZWQgPSBpdGVyYXRvciA/IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSA6IHZhbHVlOwogICAgICBjb21wdXRlZCA+PSByZXN1bHQuY29tcHV0ZWQgJiYgKHJlc3VsdCA9IHt2YWx1ZSA6IHZhbHVlLCBjb21wdXRlZCA6IGNvbXB1dGVkfSk7CiAgICB9KTsKICAgIHJldHVybiByZXN1bHQudmFsdWU7CiAgfTsKCiAgLy8gUmV0dXJuIHRoZSBtaW5pbXVtIGVsZW1lbnQgKG9yIGVsZW1lbnQtYmFzZWQgY29tcHV0YXRpb24pLgogIF8ubWluID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkgewogICAgaWYgKCFpdGVyYXRvciAmJiBfLmlzQXJyYXkob2JqKSkgcmV0dXJuIE1hdGgubWluLmFwcGx5KE1hdGgsIG9iaik7CiAgICB2YXIgcmVzdWx0ID0ge2NvbXB1dGVkIDogSW5maW5pdHl9OwogICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICB2YXIgY29tcHV0ZWQgPSBpdGVyYXRvciA/IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSA6IHZhbHVlOwogICAgICBjb21wdXRlZCA8IHJlc3VsdC5jb21wdXRlZCAmJiAocmVzdWx0ID0ge3ZhbHVlIDogdmFsdWUsIGNvbXB1dGVkIDogY29tcHV0ZWR9KTsKICAgIH0pOwogICAgcmV0dXJuIHJlc3VsdC52YWx1ZTsKICB9OwoKICAvLyBTb3J0IHRoZSBvYmplY3QncyB2YWx1ZXMgYnkgYSBjcml0ZXJpb24gcHJvZHVjZWQgYnkgYW4gaXRlcmF0b3IuCiAgXy5zb3J0QnkgPSBmdW5jdGlvbihvYmosIGl0ZXJhdG9yLCBjb250ZXh0KSB7CiAgICByZXR1cm4gXy5wbHVjayhfLm1hcChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICByZXR1cm4gewogICAgICAgIHZhbHVlIDogdmFsdWUsCiAgICAgICAgY3JpdGVyaWEgOiBpdGVyYXRvci5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdCkKICAgICAgfTsKICAgIH0pLnNvcnQoZnVuY3Rpb24obGVmdCwgcmlnaHQpIHsKICAgICAgdmFyIGEgPSBsZWZ0LmNyaXRlcmlhLCBiID0gcmlnaHQuY3JpdGVyaWE7CiAgICAgIHJldHVybiBhIDwgYiA/IC0xIDogYSA+IGIgPyAxIDogMDsKICAgIH0pLCAndmFsdWUnKTsKICB9OwoKICAvLyBVc2UgYSBjb21wYXJhdG9yIGZ1bmN0aW9uIHRvIGZpZ3VyZSBvdXQgYXQgd2hhdCBpbmRleCBhbiBvYmplY3Qgc2hvdWxkCiAgLy8gYmUgaW5zZXJ0ZWQgc28gYXMgdG8gbWFpbnRhaW4gb3JkZXIuIFVzZXMgYmluYXJ5IHNlYXJjaC4KICBfLnNvcnRlZEluZGV4ID0gZnVuY3Rpb24oYXJyYXksIG9iaiwgaXRlcmF0b3IpIHsKICAgIGl0ZXJhdG9yID0gaXRlcmF0b3IgfHwgXy5pZGVudGl0eTsKICAgIHZhciBsb3cgPSAwLCBoaWdoID0gYXJyYXkubGVuZ3RoOwogICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHsKICAgICAgdmFyIG1pZCA9IChsb3cgKyBoaWdoKSA+PiAxOwogICAgICBpdGVyYXRvcihhcnJheVttaWRdKSA8IGl0ZXJhdG9yKG9iaikgPyBsb3cgPSBtaWQgKyAxIDogaGlnaCA9IG1pZDsKICAgIH0KICAgIHJldHVybiBsb3c7CiAgfTsKCiAgLy8gU2FmZWx5IGNvbnZlcnQgYW55dGhpbmcgaXRlcmFibGUgaW50byBhIHJlYWwsIGxpdmUgYXJyYXkuCiAgXy50b0FycmF5ID0gZnVuY3Rpb24oaXRlcmFibGUpIHsKICAgIGlmICghaXRlcmFibGUpICAgICAgICAgICAgICAgIHJldHVybiBbXTsKICAgIGlmIChpdGVyYWJsZS50b0FycmF5KSAgICAgICAgIHJldHVybiBpdGVyYWJsZS50b0FycmF5KCk7CiAgICBpZiAoXy5pc0FycmF5KGl0ZXJhYmxlKSkgICAgICByZXR1cm4gaXRlcmFibGU7CiAgICBpZiAoXy5pc0FyZ3VtZW50cyhpdGVyYWJsZSkpICByZXR1cm4gc2xpY2UuY2FsbChpdGVyYWJsZSk7CiAgICByZXR1cm4gXy52YWx1ZXMoaXRlcmFibGUpOwogIH07CgogIC8vIFJldHVybiB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGFuIG9iamVjdC4KICBfLnNpemUgPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiBfLnRvQXJyYXkob2JqKS5sZW5ndGg7CiAgfTsKCiAgLy8gQXJyYXkgRnVuY3Rpb25zCiAgLy8gLS0tLS0tLS0tLS0tLS0tCgogIC8vIEdldCB0aGUgZmlyc3QgZWxlbWVudCBvZiBhbiBhcnJheS4gUGFzc2luZyAqKm4qKiB3aWxsIHJldHVybiB0aGUgZmlyc3QgTgogIC8vIHZhbHVlcyBpbiB0aGUgYXJyYXkuIEFsaWFzZWQgYXMgYGhlYWRgLiBUaGUgKipndWFyZCoqIGNoZWNrIGFsbG93cyBpdCB0byB3b3JrCiAgLy8gd2l0aCBgXy5tYXBgLgogIF8uZmlyc3QgPSBfLmhlYWQgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHsKICAgIHJldHVybiAobiAhPSBudWxsKSAmJiAhZ3VhcmQgPyBzbGljZS5jYWxsKGFycmF5LCAwLCBuKSA6IGFycmF5WzBdOwogIH07CgogIC8vIFJldHVybnMgZXZlcnl0aGluZyBidXQgdGhlIGZpcnN0IGVudHJ5IG9mIHRoZSBhcnJheS4gQWxpYXNlZCBhcyBgdGFpbGAuCiAgLy8gRXNwZWNpYWxseSB1c2VmdWwgb24gdGhlIGFyZ3VtZW50cyBvYmplY3QuIFBhc3NpbmcgYW4gKippbmRleCoqIHdpbGwgcmV0dXJuCiAgLy8gdGhlIHJlc3Qgb2YgdGhlIHZhbHVlcyBpbiB0aGUgYXJyYXkgZnJvbSB0aGF0IGluZGV4IG9ud2FyZC4gVGhlICoqZ3VhcmQqKgogIC8vIGNoZWNrIGFsbG93cyBpdCB0byB3b3JrIHdpdGggYF8ubWFwYC4KICBfLnJlc3QgPSBfLnRhaWwgPSBmdW5jdGlvbihhcnJheSwgaW5kZXgsIGd1YXJkKSB7CiAgICByZXR1cm4gc2xpY2UuY2FsbChhcnJheSwgKGluZGV4ID09IG51bGwpIHx8IGd1YXJkID8gMSA6IGluZGV4KTsKICB9OwoKICAvLyBHZXQgdGhlIGxhc3QgZWxlbWVudCBvZiBhbiBhcnJheS4KICBfLmxhc3QgPSBmdW5jdGlvbihhcnJheSkgewogICAgcmV0dXJuIGFycmF5W2FycmF5Lmxlbmd0aCAtIDFdOwogIH07CgogIC8vIFRyaW0gb3V0IGFsbCBmYWxzeSB2YWx1ZXMgZnJvbSBhbiBhcnJheS4KICBfLmNvbXBhY3QgPSBmdW5jdGlvbihhcnJheSkgewogICAgcmV0dXJuIF8uZmlsdGVyKGFycmF5LCBmdW5jdGlvbih2YWx1ZSl7IHJldHVybiAhIXZhbHVlOyB9KTsKICB9OwoKICAvLyBSZXR1cm4gYSBjb21wbGV0ZWx5IGZsYXR0ZW5lZCB2ZXJzaW9uIG9mIGFuIGFycmF5LgogIF8uZmxhdHRlbiA9IGZ1bmN0aW9uKGFycmF5KSB7CiAgICByZXR1cm4gXy5yZWR1Y2UoYXJyYXksIGZ1bmN0aW9uKG1lbW8sIHZhbHVlKSB7CiAgICAgIGlmIChfLmlzQXJyYXkodmFsdWUpKSByZXR1cm4gbWVtby5jb25jYXQoXy5mbGF0dGVuKHZhbHVlKSk7CiAgICAgIG1lbW9bbWVtby5sZW5ndGhdID0gdmFsdWU7CiAgICAgIHJldHVybiBtZW1vOwogICAgfSwgW10pOwogIH07CgogIC8vIFJldHVybiBhIHZlcnNpb24gb2YgdGhlIGFycmF5IHRoYXQgZG9lcyBub3QgY29udGFpbiB0aGUgc3BlY2lmaWVkIHZhbHVlKHMpLgogIF8ud2l0aG91dCA9IGZ1bmN0aW9uKGFycmF5KSB7CiAgICB2YXIgdmFsdWVzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOwogICAgcmV0dXJuIF8uZmlsdGVyKGFycmF5LCBmdW5jdGlvbih2YWx1ZSl7IHJldHVybiAhXy5pbmNsdWRlKHZhbHVlcywgdmFsdWUpOyB9KTsKICB9OwoKICAvLyBQcm9kdWNlIGEgZHVwbGljYXRlLWZyZWUgdmVyc2lvbiBvZiB0aGUgYXJyYXkuIElmIHRoZSBhcnJheSBoYXMgYWxyZWFkeQogIC8vIGJlZW4gc29ydGVkLCB5b3UgaGF2ZSB0aGUgb3B0aW9uIG9mIHVzaW5nIGEgZmFzdGVyIGFsZ29yaXRobS4KICAvLyBBbGlhc2VkIGFzIGB1bmlxdWVgLgogIF8udW5pcSA9IF8udW5pcXVlID0gZnVuY3Rpb24oYXJyYXksIGlzU29ydGVkKSB7CiAgICByZXR1cm4gXy5yZWR1Y2UoYXJyYXksIGZ1bmN0aW9uKG1lbW8sIGVsLCBpKSB7CiAgICAgIGlmICgwID09IGkgfHwgKGlzU29ydGVkID09PSB0cnVlID8gXy5sYXN0KG1lbW8pICE9IGVsIDogIV8uaW5jbHVkZShtZW1vLCBlbCkpKSBtZW1vW21lbW8ubGVuZ3RoXSA9IGVsOwogICAgICByZXR1cm4gbWVtbzsKICAgIH0sIFtdKTsKICB9OwoKICAvLyBQcm9kdWNlIGFuIGFycmF5IHRoYXQgY29udGFpbnMgZXZlcnkgaXRlbSBzaGFyZWQgYmV0d2VlbiBhbGwgdGhlCiAgLy8gcGFzc2VkLWluIGFycmF5cy4KICBfLmludGVyc2VjdCA9IGZ1bmN0aW9uKGFycmF5KSB7CiAgICB2YXIgcmVzdCA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKICAgIHJldHVybiBfLmZpbHRlcihfLnVuaXEoYXJyYXkpLCBmdW5jdGlvbihpdGVtKSB7CiAgICAgIHJldHVybiBfLmV2ZXJ5KHJlc3QsIGZ1bmN0aW9uKG90aGVyKSB7CiAgICAgICAgcmV0dXJuIF8uaW5kZXhPZihvdGhlciwgaXRlbSkgPj0gMDsKICAgICAgfSk7CiAgICB9KTsKICB9OwoKICAvLyBaaXAgdG9nZXRoZXIgbXVsdGlwbGUgbGlzdHMgaW50byBhIHNpbmdsZSBhcnJheSAtLSBlbGVtZW50cyB0aGF0IHNoYXJlCiAgLy8gYW4gaW5kZXggZ28gdG9nZXRoZXIuCiAgXy56aXAgPSBmdW5jdGlvbigpIHsKICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMpOwogICAgdmFyIGxlbmd0aCA9IF8ubWF4KF8ucGx1Y2soYXJncywgJ2xlbmd0aCcpKTsKICAgIHZhciByZXN1bHRzID0gbmV3IEFycmF5KGxlbmd0aCk7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSByZXN1bHRzW2ldID0gXy5wbHVjayhhcmdzLCAiIiArIGkpOwogICAgcmV0dXJuIHJlc3VsdHM7CiAgfTsKCiAgLy8gSWYgdGhlIGJyb3dzZXIgZG9lc24ndCBzdXBwbHkgdXMgd2l0aCBpbmRleE9mIChJJ20gbG9va2luZyBhdCB5b3UsICoqTVNJRSoqKSwKICAvLyB3ZSBuZWVkIHRoaXMgZnVuY3Rpb24uIFJldHVybiB0aGUgcG9zaXRpb24gb2YgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4KICAvLyBpdGVtIGluIGFuIGFycmF5LCBvciAtMSBpZiB0aGUgaXRlbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhlIGFycmF5LgogIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBpbmRleE9mYCBpZiBhdmFpbGFibGUuCiAgLy8gSWYgdGhlIGFycmF5IGlzIGxhcmdlIGFuZCBhbHJlYWR5IGluIHNvcnQgb3JkZXIsIHBhc3MgYHRydWVgCiAgLy8gZm9yICoqaXNTb3J0ZWQqKiB0byB1c2UgYmluYXJ5IHNlYXJjaC4KICBfLmluZGV4T2YgPSBmdW5jdGlvbihhcnJheSwgaXRlbSwgaXNTb3J0ZWQpIHsKICAgIGlmIChhcnJheSA9PSBudWxsKSByZXR1cm4gLTE7CiAgICB2YXIgaSwgbDsKICAgIGlmIChpc1NvcnRlZCkgewogICAgICBpID0gXy5zb3J0ZWRJbmRleChhcnJheSwgaXRlbSk7CiAgICAgIHJldHVybiBhcnJheVtpXSA9PT0gaXRlbSA/IGkgOiAtMTsKICAgIH0KICAgIGlmIChuYXRpdmVJbmRleE9mICYmIGFycmF5LmluZGV4T2YgPT09IG5hdGl2ZUluZGV4T2YpIHJldHVybiBhcnJheS5pbmRleE9mKGl0ZW0pOwogICAgZm9yIChpID0gMCwgbCA9IGFycmF5Lmxlbmd0aDsgaSA8IGw7IGkrKykgaWYgKGFycmF5W2ldID09PSBpdGVtKSByZXR1cm4gaTsKICAgIHJldHVybiAtMTsKICB9OwoKCiAgLy8gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYGxhc3RJbmRleE9mYCBpZiBhdmFpbGFibGUuCiAgXy5sYXN0SW5kZXhPZiA9IGZ1bmN0aW9uKGFycmF5LCBpdGVtKSB7CiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIC0xOwogICAgaWYgKG5hdGl2ZUxhc3RJbmRleE9mICYmIGFycmF5Lmxhc3RJbmRleE9mID09PSBuYXRpdmVMYXN0SW5kZXhPZikgcmV0dXJuIGFycmF5Lmxhc3RJbmRleE9mKGl0ZW0pOwogICAgdmFyIGkgPSBhcnJheS5sZW5ndGg7CiAgICB3aGlsZSAoaS0tKSBpZiAoYXJyYXlbaV0gPT09IGl0ZW0pIHJldHVybiBpOwogICAgcmV0dXJuIC0xOwogIH07CgogIC8vIEdlbmVyYXRlIGFuIGludGVnZXIgQXJyYXkgY29udGFpbmluZyBhbiBhcml0aG1ldGljIHByb2dyZXNzaW9uLiBBIHBvcnQgb2YKICAvLyB0aGUgbmF0aXZlIFB5dGhvbiBgcmFuZ2UoKWAgZnVuY3Rpb24uIFNlZQogIC8vIFt0aGUgUHl0aG9uIGRvY3VtZW50YXRpb25dKGh0dHA6Ly9kb2NzLnB5dGhvbi5vcmcvbGlicmFyeS9mdW5jdGlvbnMuaHRtbCNyYW5nZSkuCiAgXy5yYW5nZSA9IGZ1bmN0aW9uKHN0YXJ0LCBzdG9wLCBzdGVwKSB7CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8PSAxKSB7CiAgICAgIHN0b3AgPSBzdGFydCB8fCAwOwogICAgICBzdGFydCA9IDA7CiAgICB9CiAgICBzdGVwID0gYXJndW1lbnRzWzJdIHx8IDE7CgogICAgdmFyIGxlbiA9IE1hdGgubWF4KE1hdGguY2VpbCgoc3RvcCAtIHN0YXJ0KSAvIHN0ZXApLCAwKTsKICAgIHZhciBpZHggPSAwOwogICAgdmFyIHJhbmdlID0gbmV3IEFycmF5KGxlbik7CgogICAgd2hpbGUoaWR4IDwgbGVuKSB7CiAgICAgIHJhbmdlW2lkeCsrXSA9IHN0YXJ0OwogICAgICBzdGFydCArPSBzdGVwOwogICAgfQoKICAgIHJldHVybiByYW5nZTsKICB9OwoKICAvLyBGdW5jdGlvbiAoYWhlbSkgRnVuY3Rpb25zCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tCgogIC8vIENyZWF0ZSBhIGZ1bmN0aW9uIGJvdW5kIHRvIGEgZ2l2ZW4gb2JqZWN0IChhc3NpZ25pbmcgYHRoaXNgLCBhbmQgYXJndW1lbnRzLAogIC8vIG9wdGlvbmFsbHkpLiBCaW5kaW5nIHdpdGggYXJndW1lbnRzIGlzIGFsc28ga25vd24gYXMgYGN1cnJ5YC4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgRnVuY3Rpb24uYmluZGAgaWYgYXZhaWxhYmxlLgogIF8uYmluZCA9IGZ1bmN0aW9uKGZ1bmMsIG9iaikgewogICAgaWYgKG5hdGl2ZUJpbmQgJiYgZnVuYy5iaW5kID09PSBuYXRpdmVCaW5kKSByZXR1cm4gZnVuYy5iaW5kLmFwcGx5KGZ1bmMsIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7CiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkob2JqIHx8IHt9LCBhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpKTsKICAgIH07CiAgfTsKCiAgLy8gQmluZCBhbGwgb2YgYW4gb2JqZWN0J3MgbWV0aG9kcyB0byB0aGF0IG9iamVjdC4gVXNlZnVsIGZvciBlbnN1cmluZyB0aGF0CiAgLy8gYWxsIGNhbGxiYWNrcyBkZWZpbmVkIG9uIGFuIG9iamVjdCBiZWxvbmcgdG8gaXQuCiAgXy5iaW5kQWxsID0gZnVuY3Rpb24ob2JqKSB7CiAgICB2YXIgZnVuY3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7CiAgICBpZiAoZnVuY3MubGVuZ3RoID09IDApIGZ1bmNzID0gXy5mdW5jdGlvbnMob2JqKTsKICAgIGVhY2goZnVuY3MsIGZ1bmN0aW9uKGYpIHsgb2JqW2ZdID0gXy5iaW5kKG9ialtmXSwgb2JqKTsgfSk7CiAgICByZXR1cm4gb2JqOwogIH07CgogIC8vIE1lbW9pemUgYW4gZXhwZW5zaXZlIGZ1bmN0aW9uIGJ5IHN0b3JpbmcgaXRzIHJlc3VsdHMuCiAgXy5tZW1vaXplID0gZnVuY3Rpb24oZnVuYywgaGFzaGVyKSB7CiAgICB2YXIgbWVtbyA9IHt9OwogICAgaGFzaGVyID0gaGFzaGVyIHx8IF8uaWRlbnRpdHk7CiAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBrZXkgPSBoYXNoZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwobWVtbywga2V5KSA/IG1lbW9ba2V5XSA6IChtZW1vW2tleV0gPSBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogICAgfTsKICB9OwoKICAvLyBEZWxheXMgYSBmdW5jdGlvbiBmb3IgdGhlIGdpdmVuIG51bWJlciBvZiBtaWxsaXNlY29uZHMsIGFuZCB0aGVuIGNhbGxzCiAgLy8gaXQgd2l0aCB0aGUgYXJndW1lbnRzIHN1cHBsaWVkLgogIF8uZGVsYXkgPSBmdW5jdGlvbihmdW5jLCB3YWl0KSB7CiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IHJldHVybiBmdW5jLmFwcGx5KGZ1bmMsIGFyZ3MpOyB9LCB3YWl0KTsKICB9OwoKICAvLyBEZWZlcnMgYSBmdW5jdGlvbiwgc2NoZWR1bGluZyBpdCB0byBydW4gYWZ0ZXIgdGhlIGN1cnJlbnQgY2FsbCBzdGFjayBoYXMKICAvLyBjbGVhcmVkLgogIF8uZGVmZXIgPSBmdW5jdGlvbihmdW5jKSB7CiAgICByZXR1cm4gXy5kZWxheS5hcHBseShfLCBbZnVuYywgMV0uY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSkpOwogIH07CgogIC8vIEludGVybmFsIGZ1bmN0aW9uIHVzZWQgdG8gaW1wbGVtZW50IGBfLnRocm90dGxlYCBhbmQgYF8uZGVib3VuY2VgLgogIHZhciBsaW1pdCA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQsIGRlYm91bmNlKSB7CiAgICB2YXIgdGltZW91dDsKICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzOwogICAgICB2YXIgdGhyb3R0bGVyID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdGltZW91dCA9IG51bGw7CiAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTsKICAgICAgfTsKICAgICAgaWYgKGRlYm91bmNlKSBjbGVhclRpbWVvdXQodGltZW91dCk7CiAgICAgIGlmIChkZWJvdW5jZSB8fCAhdGltZW91dCkgdGltZW91dCA9IHNldFRpbWVvdXQodGhyb3R0bGVyLCB3YWl0KTsKICAgIH07CiAgfTsKCiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCB3aGVuIGludm9rZWQsIHdpbGwgb25seSBiZSB0cmlnZ2VyZWQgYXQgbW9zdCBvbmNlCiAgLy8gZHVyaW5nIGEgZ2l2ZW4gd2luZG93IG9mIHRpbWUuCiAgXy50aHJvdHRsZSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQpIHsKICAgIHJldHVybiBsaW1pdChmdW5jLCB3YWl0LCBmYWxzZSk7CiAgfTsKCiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCBhcyBsb25nIGFzIGl0IGNvbnRpbnVlcyB0byBiZSBpbnZva2VkLCB3aWxsIG5vdAogIC8vIGJlIHRyaWdnZXJlZC4gVGhlIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGFmdGVyIGl0IHN0b3BzIGJlaW5nIGNhbGxlZCBmb3IKICAvLyBOIG1pbGxpc2Vjb25kcy4KICBfLmRlYm91bmNlID0gZnVuY3Rpb24oZnVuYywgd2FpdCkgewogICAgcmV0dXJuIGxpbWl0KGZ1bmMsIHdhaXQsIHRydWUpOwogIH07CgogIC8vIFJldHVybnMgdGhlIGZpcnN0IGZ1bmN0aW9uIHBhc3NlZCBhcyBhbiBhcmd1bWVudCB0byB0aGUgc2Vjb25kLAogIC8vIGFsbG93aW5nIHlvdSB0byBhZGp1c3QgYXJndW1lbnRzLCBydW4gY29kZSBiZWZvcmUgYW5kIGFmdGVyLCBhbmQKICAvLyBjb25kaXRpb25hbGx5IGV4ZWN1dGUgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uLgogIF8ud3JhcCA9IGZ1bmN0aW9uKGZ1bmMsIHdyYXBwZXIpIHsKICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFyZ3MgPSBbZnVuY10uY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSk7CiAgICAgIHJldHVybiB3cmFwcGVyLmFwcGx5KHRoaXMsIGFyZ3MpOwogICAgfTsKICB9OwoKICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCBpcyB0aGUgY29tcG9zaXRpb24gb2YgYSBsaXN0IG9mIGZ1bmN0aW9ucywgZWFjaAogIC8vIGNvbnN1bWluZyB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBmdW5jdGlvbiB0aGF0IGZvbGxvd3MuCiAgXy5jb21wb3NlID0gZnVuY3Rpb24oKSB7CiAgICB2YXIgZnVuY3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cyk7CiAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMpOwogICAgICBmb3IgKHZhciBpPWZ1bmNzLmxlbmd0aC0xOyBpID49IDA7IGktLSkgewogICAgICAgIGFyZ3MgPSBbZnVuY3NbaV0uYXBwbHkodGhpcywgYXJncyldOwogICAgICB9CiAgICAgIHJldHVybiBhcmdzWzBdOwogICAgfTsKICB9OwoKICAvLyBPYmplY3QgRnVuY3Rpb25zCiAgLy8gLS0tLS0tLS0tLS0tLS0tLQoKICAvLyBSZXRyaWV2ZSB0aGUgbmFtZXMgb2YgYW4gb2JqZWN0J3MgcHJvcGVydGllcy4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgT2JqZWN0LmtleXNgCiAgXy5rZXlzID0gbmF0aXZlS2V5cyB8fCBmdW5jdGlvbihvYmopIHsKICAgIHZhciBrZXlzID0gW107CiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIGtleXNba2V5cy5sZW5ndGhdID0ga2V5OwogICAgcmV0dXJuIGtleXM7CiAgfTsKCiAgLy8gUmV0cmlldmUgdGhlIHZhbHVlcyBvZiBhbiBvYmplY3QncyBwcm9wZXJ0aWVzLgogIF8udmFsdWVzID0gZnVuY3Rpb24ob2JqKSB7CiAgICByZXR1cm4gXy5tYXAob2JqLCBfLmlkZW50aXR5KTsKICB9OwoKICAvLyBSZXR1cm4gYSBzb3J0ZWQgbGlzdCBvZiB0aGUgZnVuY3Rpb24gbmFtZXMgYXZhaWxhYmxlIG9uIHRoZSBvYmplY3QuCiAgLy8gQWxpYXNlZCBhcyBgbWV0aG9kc2AKICBfLmZ1bmN0aW9ucyA9IF8ubWV0aG9kcyA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuIF8uZmlsdGVyKF8ua2V5cyhvYmopLCBmdW5jdGlvbihrZXkpeyByZXR1cm4gXy5pc0Z1bmN0aW9uKG9ialtrZXldKTsgfSkuc29ydCgpOwogIH07CgogIC8vIEV4dGVuZCBhIGdpdmVuIG9iamVjdCB3aXRoIGFsbCB0aGUgcHJvcGVydGllcyBpbiBwYXNzZWQtaW4gb2JqZWN0KHMpLgogIF8uZXh0ZW5kID0gZnVuY3Rpb24ob2JqKSB7CiAgICBlYWNoKHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSwgZnVuY3Rpb24oc291cmNlKSB7CiAgICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSBvYmpbcHJvcF0gPSBzb3VyY2VbcHJvcF07CiAgICB9KTsKICAgIHJldHVybiBvYmo7CiAgfTsKCiAgLy8gRmlsbCBpbiBhIGdpdmVuIG9iamVjdCB3aXRoIGRlZmF1bHQgcHJvcGVydGllcy4KICBfLmRlZmF1bHRzID0gZnVuY3Rpb24ob2JqKSB7CiAgICBlYWNoKHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSwgZnVuY3Rpb24oc291cmNlKSB7CiAgICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSBpZiAob2JqW3Byb3BdID09IG51bGwpIG9ialtwcm9wXSA9IHNvdXJjZVtwcm9wXTsKICAgIH0pOwogICAgcmV0dXJuIG9iajsKICB9OwoKICAvLyBDcmVhdGUgYSAoc2hhbGxvdy1jbG9uZWQpIGR1cGxpY2F0ZSBvZiBhbiBvYmplY3QuCiAgXy5jbG9uZSA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuIF8uaXNBcnJheShvYmopID8gb2JqLnNsaWNlKCkgOiBfLmV4dGVuZCh7fSwgb2JqKTsKICB9OwoKICAvLyBJbnZva2VzIGludGVyY2VwdG9yIHdpdGggdGhlIG9iaiwgYW5kIHRoZW4gcmV0dXJucyBvYmouCiAgLy8gVGhlIHByaW1hcnkgcHVycG9zZSBvZiB0aGlzIG1ldGhvZCBpcyB0byAidGFwIGludG8iIGEgbWV0aG9kIGNoYWluLCBpbgogIC8vIG9yZGVyIHRvIHBlcmZvcm0gb3BlcmF0aW9ucyBvbiBpbnRlcm1lZGlhdGUgcmVzdWx0cyB3aXRoaW4gdGhlIGNoYWluLgogIF8udGFwID0gZnVuY3Rpb24ob2JqLCBpbnRlcmNlcHRvcikgewogICAgaW50ZXJjZXB0b3Iob2JqKTsKICAgIHJldHVybiBvYmo7CiAgfTsKCiAgLy8gUGVyZm9ybSBhIGRlZXAgY29tcGFyaXNvbiB0byBjaGVjayBpZiB0d28gb2JqZWN0cyBhcmUgZXF1YWwuCiAgXy5pc0VxdWFsID0gZnVuY3Rpb24oYSwgYikgewogICAgLy8gQ2hlY2sgb2JqZWN0IGlkZW50aXR5LgogICAgaWYgKGEgPT09IGIpIHJldHVybiB0cnVlOwogICAgLy8gRGlmZmVyZW50IHR5cGVzPwogICAgdmFyIGF0eXBlID0gdHlwZW9mKGEpLCBidHlwZSA9IHR5cGVvZihiKTsKICAgIGlmIChhdHlwZSAhPSBidHlwZSkgcmV0dXJuIGZhbHNlOwogICAgLy8gQmFzaWMgZXF1YWxpdHkgdGVzdCAod2F0Y2ggb3V0IGZvciBjb2VyY2lvbnMpLgogICAgaWYgKGEgPT0gYikgcmV0dXJuIHRydWU7CiAgICAvLyBPbmUgaXMgZmFsc3kgYW5kIHRoZSBvdGhlciB0cnV0aHkuCiAgICBpZiAoKCFhICYmIGIpIHx8IChhICYmICFiKSkgcmV0dXJuIGZhbHNlOwogICAgLy8gVW53cmFwIGFueSB3cmFwcGVkIG9iamVjdHMuCiAgICBpZiAoYS5fY2hhaW4pIGEgPSBhLl93cmFwcGVkOwogICAgaWYgKGIuX2NoYWluKSBiID0gYi5fd3JhcHBlZDsKICAgIC8vIE9uZSBvZiB0aGVtIGltcGxlbWVudHMgYW4gaXNFcXVhbCgpPwogICAgaWYgKGEuaXNFcXVhbCkgcmV0dXJuIGEuaXNFcXVhbChiKTsKICAgIC8vIENoZWNrIGRhdGVzJyBpbnRlZ2VyIHZhbHVlcy4KICAgIGlmIChfLmlzRGF0ZShhKSAmJiBfLmlzRGF0ZShiKSkgcmV0dXJuIGEuZ2V0VGltZSgpID09PSBiLmdldFRpbWUoKTsKICAgIC8vIEJvdGggYXJlIE5hTj8KICAgIGlmIChfLmlzTmFOKGEpICYmIF8uaXNOYU4oYikpIHJldHVybiBmYWxzZTsKICAgIC8vIENvbXBhcmUgcmVndWxhciBleHByZXNzaW9ucy4KICAgIGlmIChfLmlzUmVnRXhwKGEpICYmIF8uaXNSZWdFeHAoYikpCiAgICAgIHJldHVybiBhLnNvdXJjZSAgICAgPT09IGIuc291cmNlICYmCiAgICAgICAgICAgICBhLmdsb2JhbCAgICAgPT09IGIuZ2xvYmFsICYmCiAgICAgICAgICAgICBhLmlnbm9yZUNhc2UgPT09IGIuaWdub3JlQ2FzZSAmJgogICAgICAgICAgICAgYS5tdWx0aWxpbmUgID09PSBiLm11bHRpbGluZTsKICAgIC8vIElmIGEgaXMgbm90IGFuIG9iamVjdCBieSB0aGlzIHBvaW50LCB3ZSBjYW4ndCBoYW5kbGUgaXQuCiAgICBpZiAoYXR5cGUgIT09ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7CiAgICAvLyBDaGVjayBmb3IgZGlmZmVyZW50IGFycmF5IGxlbmd0aHMgYmVmb3JlIGNvbXBhcmluZyBjb250ZW50cy4KICAgIGlmIChhLmxlbmd0aCAmJiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKSkgcmV0dXJuIGZhbHNlOwogICAgLy8gTm90aGluZyBlbHNlIHdvcmtlZCwgZGVlcCBjb21wYXJlIHRoZSBjb250ZW50cy4KICAgIHZhciBhS2V5cyA9IF8ua2V5cyhhKSwgYktleXMgPSBfLmtleXMoYik7CiAgICAvLyBEaWZmZXJlbnQgb2JqZWN0IHNpemVzPwogICAgaWYgKGFLZXlzLmxlbmd0aCAhPSBiS2V5cy5sZW5ndGgpIHJldHVybiBmYWxzZTsKICAgIC8vIFJlY3Vyc2l2ZSBjb21wYXJpc29uIG9mIGNvbnRlbnRzLgogICAgZm9yICh2YXIga2V5IGluIGEpIGlmICghKGtleSBpbiBiKSB8fCAhXy5pc0VxdWFsKGFba2V5XSwgYltrZXldKSkgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHRydWU7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiBhcnJheSBvciBvYmplY3QgZW1wdHk/CiAgXy5pc0VtcHR5ID0gZnVuY3Rpb24ob2JqKSB7CiAgICBpZiAoXy5pc0FycmF5KG9iaikgfHwgXy5pc1N0cmluZyhvYmopKSByZXR1cm4gb2JqLmxlbmd0aCA9PT0gMDsKICAgIGZvciAodmFyIGtleSBpbiBvYmopIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHRydWU7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIERPTSBlbGVtZW50PwogIF8uaXNFbGVtZW50ID0gZnVuY3Rpb24ob2JqKSB7CiAgICByZXR1cm4gISEob2JqICYmIG9iai5ub2RlVHlwZSA9PSAxKTsKICB9OwoKICAvLyBJcyBhIGdpdmVuIHZhbHVlIGFuIGFycmF5PwogIC8vIERlbGVnYXRlcyB0byBFQ01BNSdzIG5hdGl2ZSBBcnJheS5pc0FycmF5CiAgXy5pc0FycmF5ID0gbmF0aXZlSXNBcnJheSB8fCBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5XSc7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YXJpYWJsZSBhbiBhcmd1bWVudHMgb2JqZWN0PwogIF8uaXNBcmd1bWVudHMgPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiAhIShvYmogJiYgaGFzT3duUHJvcGVydHkuY2FsbChvYmosICdjYWxsZWUnKSk7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIGZ1bmN0aW9uPwogIF8uaXNGdW5jdGlvbiA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuICEhKG9iaiAmJiBvYmouY29uc3RydWN0b3IgJiYgb2JqLmNhbGwgJiYgb2JqLmFwcGx5KTsKICB9OwoKICAvLyBJcyBhIGdpdmVuIHZhbHVlIGEgc3RyaW5nPwogIF8uaXNTdHJpbmcgPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiAhIShvYmogPT09ICcnIHx8IChvYmogJiYgb2JqLmNoYXJDb2RlQXQgJiYgb2JqLnN1YnN0cikpOwogIH07CgogIC8vIElzIGEgZ2l2ZW4gdmFsdWUgYSBudW1iZXI/CiAgXy5pc051bWJlciA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuICEhKG9iaiA9PT0gMCB8fCAob2JqICYmIG9iai50b0V4cG9uZW50aWFsICYmIG9iai50b0ZpeGVkKSk7CiAgfTsKCiAgLy8gSXMgdGhlIGdpdmVuIHZhbHVlIGBOYU5gPyBgTmFOYCBoYXBwZW5zIHRvIGJlIHRoZSBvbmx5IHZhbHVlIGluIEphdmFTY3JpcHQKICAvLyB0aGF0IGRvZXMgbm90IGVxdWFsIGl0c2VsZi4KICBfLmlzTmFOID0gZnVuY3Rpb24ob2JqKSB7CiAgICByZXR1cm4gb2JqICE9PSBvYmo7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIGJvb2xlYW4/CiAgXy5pc0Jvb2xlYW4gPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiBvYmogPT09IHRydWUgfHwgb2JqID09PSBmYWxzZTsKICB9OwoKICAvLyBJcyBhIGdpdmVuIHZhbHVlIGEgZGF0ZT8KICBfLmlzRGF0ZSA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuICEhKG9iaiAmJiBvYmouZ2V0VGltZXpvbmVPZmZzZXQgJiYgb2JqLnNldFVUQ0Z1bGxZZWFyKTsKICB9OwoKICAvLyBJcyB0aGUgZ2l2ZW4gdmFsdWUgYSByZWd1bGFyIGV4cHJlc3Npb24/CiAgXy5pc1JlZ0V4cCA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuICEhKG9iaiAmJiBvYmoudGVzdCAmJiBvYmouZXhlYyAmJiAob2JqLmlnbm9yZUNhc2UgfHwgb2JqLmlnbm9yZUNhc2UgPT09IGZhbHNlKSk7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBlcXVhbCB0byBudWxsPwogIF8uaXNOdWxsID0gZnVuY3Rpb24ob2JqKSB7CiAgICByZXR1cm4gb2JqID09PSBudWxsOwogIH07CgogIC8vIElzIGEgZ2l2ZW4gdmFyaWFibGUgdW5kZWZpbmVkPwogIF8uaXNVbmRlZmluZWQgPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiBvYmogPT09IHZvaWQgMDsKICB9OwoKICAvLyBVdGlsaXR5IEZ1bmN0aW9ucwogIC8vIC0tLS0tLS0tLS0tLS0tLS0tCgogIC8vIFJ1biBVbmRlcnNjb3JlLmpzIGluICpub0NvbmZsaWN0KiBtb2RlLCByZXR1cm5pbmcgdGhlIGBfYCB2YXJpYWJsZSB0byBpdHMKICAvLyBwcmV2aW91cyBvd25lci4gUmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QuCiAgXy5ub0NvbmZsaWN0ID0gZnVuY3Rpb24oKSB7CiAgICByb290Ll8gPSBwcmV2aW91c1VuZGVyc2NvcmU7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvLyBLZWVwIHRoZSBpZGVudGl0eSBmdW5jdGlvbiBhcm91bmQgZm9yIGRlZmF1bHQgaXRlcmF0b3JzLgogIF8uaWRlbnRpdHkgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlOwogIH07CgogIC8vIFJ1biBhIGZ1bmN0aW9uICoqbioqIHRpbWVzLgogIF8udGltZXMgPSBmdW5jdGlvbiAobiwgaXRlcmF0b3IsIGNvbnRleHQpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSBpdGVyYXRvci5jYWxsKGNvbnRleHQsIGkpOwogIH07CgogIC8vIEFkZCB5b3VyIG93biBjdXN0b20gZnVuY3Rpb25zIHRvIHRoZSBVbmRlcnNjb3JlIG9iamVjdCwgZW5zdXJpbmcgdGhhdAogIC8vIHRoZXkncmUgY29ycmVjdGx5IGFkZGVkIHRvIHRoZSBPT1Agd3JhcHBlciBhcyB3ZWxsLgogIF8ubWl4aW4gPSBmdW5jdGlvbihvYmopIHsKICAgIGVhY2goXy5mdW5jdGlvbnMob2JqKSwgZnVuY3Rpb24obmFtZSl7CiAgICAgIGFkZFRvV3JhcHBlcihuYW1lLCBfW25hbWVdID0gb2JqW25hbWVdKTsKICAgIH0pOwogIH07CgogIC8vIEdlbmVyYXRlIGEgdW5pcXVlIGludGVnZXIgaWQgKHVuaXF1ZSB3aXRoaW4gdGhlIGVudGlyZSBjbGllbnQgc2Vzc2lvbikuCiAgLy8gVXNlZnVsIGZvciB0ZW1wb3JhcnkgRE9NIGlkcy4KICB2YXIgaWRDb3VudGVyID0gMDsKICBfLnVuaXF1ZUlkID0gZnVuY3Rpb24ocHJlZml4KSB7CiAgICB2YXIgaWQgPSBpZENvdW50ZXIrKzsKICAgIHJldHVybiBwcmVmaXggPyBwcmVmaXggKyBpZCA6IGlkOwogIH07CgogIC8vIEJ5IGRlZmF1bHQsIFVuZGVyc2NvcmUgdXNlcyBFUkItc3R5bGUgdGVtcGxhdGUgZGVsaW1pdGVycywgY2hhbmdlIHRoZQogIC8vIGZvbGxvd2luZyB0ZW1wbGF0ZSBzZXR0aW5ncyB0byB1c2UgYWx0ZXJuYXRpdmUgZGVsaW1pdGVycy4KICBfLnRlbXBsYXRlU2V0dGluZ3MgPSB7CiAgICBldmFsdWF0ZSAgICA6IC88JShbXHNcU10rPyklPi9nLAogICAgaW50ZXJwb2xhdGUgOiAvPCU9KFtcc1xTXSs/KSU+L2cKICB9OwoKICAvLyBKYXZhU2NyaXB0IG1pY3JvLXRlbXBsYXRpbmcsIHNpbWlsYXIgdG8gSm9obiBSZXNpZydzIGltcGxlbWVudGF0aW9uLgogIC8vIFVuZGVyc2NvcmUgdGVtcGxhdGluZyBoYW5kbGVzIGFyYml0cmFyeSBkZWxpbWl0ZXJzLCBwcmVzZXJ2ZXMgd2hpdGVzcGFjZSwKICAvLyBhbmQgY29ycmVjdGx5IGVzY2FwZXMgcXVvdGVzIHdpdGhpbiBpbnRlcnBvbGF0ZWQgY29kZS4KICBfLnRlbXBsYXRlID0gZnVuY3Rpb24oc3RyLCBkYXRhKSB7CiAgICB2YXIgYyAgPSBfLnRlbXBsYXRlU2V0dGluZ3M7CiAgICB2YXIgdG1wbCA9ICd2YXIgX19wPVtdLHByaW50PWZ1bmN0aW9uKCl7X19wLnB1c2guYXBwbHkoX19wLGFyZ3VtZW50cyk7fTsnICsKICAgICAgJ3dpdGgob2JqfHx7fSl7X19wLnB1c2goXCcnICsKICAgICAgc3RyLnJlcGxhY2UoL1xcL2csICdcXFxcJykKICAgICAgICAgLnJlcGxhY2UoLycvZywgIlxcJyIpCiAgICAgICAgIC5yZXBsYWNlKGMuaW50ZXJwb2xhdGUsIGZ1bmN0aW9uKG1hdGNoLCBjb2RlKSB7CiAgICAgICAgICAgcmV0dXJuICInLCIgKyBjb2RlLnJlcGxhY2UoL1xcJy9nLCAiJyIpICsgIiwnIjsKICAgICAgICAgfSkKICAgICAgICAgLnJlcGxhY2UoYy5ldmFsdWF0ZSB8fCBudWxsLCBmdW5jdGlvbihtYXRjaCwgY29kZSkgewogICAgICAgICAgIHJldHVybiAiJyk7IiArIGNvZGUucmVwbGFjZSgvXFwnL2csICInIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1tcclxuXHRdL2csICcgJykgKyAiX19wLnB1c2goJyI7CiAgICAgICAgIH0pCiAgICAgICAgIC5yZXBsYWNlKC9cci9nLCAnXFxyJykKICAgICAgICAgLnJlcGxhY2UoL1xuL2csICdcXG4nKQogICAgICAgICAucmVwbGFjZSgvXHQvZywgJ1xcdCcpCiAgICAgICAgICsgIicpO31yZXR1cm4gX19wLmpvaW4oJycpOyI7CiAgICB2YXIgZnVuYyA9IG5ldyBGdW5jdGlvbignb2JqJywgdG1wbCk7CiAgICByZXR1cm4gZGF0YSA/IGZ1bmMoZGF0YSkgOiBmdW5jOwogIH07CgogIC8vIFRoZSBPT1AgV3JhcHBlcgogIC8vIC0tLS0tLS0tLS0tLS0tLQoKICAvLyBJZiBVbmRlcnNjb3JlIGlzIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLCBpdCByZXR1cm5zIGEgd3JhcHBlZCBvYmplY3QgdGhhdAogIC8vIGNhbiBiZSB1c2VkIE9PLXN0eWxlLiBUaGlzIHdyYXBwZXIgaG9sZHMgYWx0ZXJlZCB2ZXJzaW9ucyBvZiBhbGwgdGhlCiAgLy8gdW5kZXJzY29yZSBmdW5jdGlvbnMuIFdyYXBwZWQgb2JqZWN0cyBtYXkgYmUgY2hhaW5lZC4KICB2YXIgd3JhcHBlciA9IGZ1bmN0aW9uKG9iaikgeyB0aGlzLl93cmFwcGVkID0gb2JqOyB9OwoKICAvLyBFeHBvc2UgYHdyYXBwZXIucHJvdG90eXBlYCBhcyBgXy5wcm90b3R5cGVgCiAgXy5wcm90b3R5cGUgPSB3cmFwcGVyLnByb3RvdHlwZTsKCiAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnRpbnVlIGNoYWluaW5nIGludGVybWVkaWF0ZSByZXN1bHRzLgogIHZhciByZXN1bHQgPSBmdW5jdGlvbihvYmosIGNoYWluKSB7CiAgICByZXR1cm4gY2hhaW4gPyBfKG9iaikuY2hhaW4oKSA6IG9iajsKICB9OwoKICAvLyBBIG1ldGhvZCB0byBlYXNpbHkgYWRkIGZ1bmN0aW9ucyB0byB0aGUgT09QIHdyYXBwZXIuCiAgdmFyIGFkZFRvV3JhcHBlciA9IGZ1bmN0aW9uKG5hbWUsIGZ1bmMpIHsKICAgIHdyYXBwZXIucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMpOwogICAgICB1bnNoaWZ0LmNhbGwoYXJncywgdGhpcy5fd3JhcHBlZCk7CiAgICAgIHJldHVybiByZXN1bHQoZnVuYy5hcHBseShfLCBhcmdzKSwgdGhpcy5fY2hhaW4pOwogICAgfTsKICB9OwoKICAvLyBBZGQgYWxsIG9mIHRoZSBVbmRlcnNjb3JlIGZ1bmN0aW9ucyB0byB0aGUgd3JhcHBlciBvYmplY3QuCiAgXy5taXhpbihfKTsKCiAgLy8gQWRkIGFsbCBtdXRhdG9yIEFycmF5IGZ1bmN0aW9ucyB0byB0aGUgd3JhcHBlci4KICBlYWNoKFsncG9wJywgJ3B1c2gnLCAncmV2ZXJzZScsICdzaGlmdCcsICdzb3J0JywgJ3NwbGljZScsICd1bnNoaWZ0J10sIGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciBtZXRob2QgPSBBcnJheVByb3RvW25hbWVdOwogICAgd3JhcHBlci5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHsKICAgICAgbWV0aG9kLmFwcGx5KHRoaXMuX3dyYXBwZWQsIGFyZ3VtZW50cyk7CiAgICAgIHJldHVybiByZXN1bHQodGhpcy5fd3JhcHBlZCwgdGhpcy5fY2hhaW4pOwogICAgfTsKICB9KTsKCiAgLy8gQWRkIGFsbCBhY2Nlc3NvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuCiAgZWFjaChbJ2NvbmNhdCcsICdqb2luJywgJ3NsaWNlJ10sIGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciBtZXRob2QgPSBBcnJheVByb3RvW25hbWVdOwogICAgd3JhcHBlci5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHJlc3VsdChtZXRob2QuYXBwbHkodGhpcy5fd3JhcHBlZCwgYXJndW1lbnRzKSwgdGhpcy5fY2hhaW4pOwogICAgfTsKICB9KTsKCiAgLy8gU3RhcnQgY2hhaW5pbmcgYSB3cmFwcGVkIFVuZGVyc2NvcmUgb2JqZWN0LgogIHdyYXBwZXIucHJvdG90eXBlLmNoYWluID0gZnVuY3Rpb24oKSB7CiAgICB0aGlzLl9jaGFpbiA9IHRydWU7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvLyBFeHRyYWN0cyB0aGUgcmVzdWx0IGZyb20gYSB3cmFwcGVkIGFuZCBjaGFpbmVkIG9iamVjdC4KICB3cmFwcGVyLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMuX3dyYXBwZWQ7CiAgfTsKCn0pKCk7Cg==", "moduleName": "Underscore"}, {"javascript": "LyoqIEBmaWxlIE1vZHVsZSB0byBkbyB1bml0IHRlc3RzIGFuZCByZXBvcnQgdGhlbS4gKi8KCnVzZSggIlV0aWwiICk7CgpFWFBPUlRFRF9TWU1CT0xTID0gWyAnQXNzZXJ0JywgJ1VuaXRUZXN0JyBdOwoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8gR2xvYmFsIEFzc2VydCBvYmplY3QuIEFzIHRoaXMgbW9kdWxlIGNhbiBvbmx5IGJlIHVzZSdkIG9uY2UgcHIuIHByb2dyYW0sIHRoaXMgaXMgc2FmZToKLyoqCiAqIEFzc2VydCBvYmplY3QgdGhhdCBwcm92aWRlcyB1bml0IHRlc3QgbWV0aG9kcy4KICogCiAqIEFuIGluc3RhbmNlIG9mIHRoaXMgb2JqZWN0IHJlZmxlY3RzIGEgdGVzdCBmaXh0dXJlL2dyb3VwLCBhbmQgeW91IGNhbgogKiBjcmVhdGUgeW91ciBpbmRpdmlkdWFsIHRlc3RjYXNlcyBieSB1c2luZyB0aGUgZnVuY3Rpb25zIG9uIHRoaXMgb2JqZWN0LiAKICoKICogQHNlZSBVbml0VGVzdAogKiBAbmFtZSBBc3NlcnQKICogQG5hbWVzcGFjZSAKICovCnZhciBBc3NlcnQgPSB1bmRlZmluZWQ7CgovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwovLyBUaGUgbWFpbiBuYW1lc3BhY2UgdG8gY29udHJvbCB0ZXN0IGZpeHR1cmVzLgovKioKICogQ29udHJvbHMgdGhlIG92ZXJhbGwgVW5pdFRlc3Qgc3lzdGVtLgogKiAKICogVGhpcyBvYmplY3QgaXMgdXNlZCB0byBjb250cm9sIHRoZSB1c2Ugb2YgdGhlIFVuaXRUZXN0IHN5c3RlbSwgdGhhdCBpcwogKiBhZGRpbmcgYW5kIG1hbmFnaW5nIHRlc3QgZml4dHVyZXMuIEFjdHVhbCB0ZXN0cyBhcmUgZG9uZSBieSB0aGUgQXNzZXJ0CiAqIG9iamVjdC4gVGhlIG1haW4gbWV0aG9kIHRvIHVzZSBpcyB0aGUgYWRkRml4dHVyZSBtZXRob2QuIChTZWUgdGhlIGV4YW1wbGUpLgogKgogKiBXaGVuIHVzaW5nIHRoZSBVbml0VGVzdCBtb2R1bGUgbGlrZSBpbiB0aGUgZXhhbXBsZSwgeW91IG1heSBydW4gdGhlIHVuaXR0ZXN0cyBmb3IgYSBtb2R1bGUgYnkgImxvYWRpbmciIHRoZSBmaWxlLCB1c3VhbGx5IGJ5IHNwZWNpZnlpbmcgaXQgdG8gdGhlIGVudmlyb25tZW50IGFzIHRoZSBmaWxlIHlvdSB3aXNoIHRvIGV4ZWN1dGUuIFRoZSB0ZXN0cyB3aWxsIGJlIHJ1biwgYW5kIGEgcmVwb3J0IGVtaXR0ZWQgdXNpbmcgdGhlIFByaW50IG1vZHVsZS4gV2hlbiB0aGUgbW9kdWxlIGlzIHVzZSdkIHRoZSB1bml0IHRlc3RzIHdpbGwgbm90IGJlIHBlcmZvcm1lZCwgbm9yIHJlcG9ydGVkLgogKgogKiBJZiB0aGUgTG9nIG1vZHVsZSBpcyBsb2FkZWQsIHNvbWUgaGlnaCBsZXZlbCBsb2dnaW5nIHdpbGwgdGFrZSBwbGFjZSwgd2hlbiB0aGUgVW5pdFRlc3QgYXJlIHJ1bi4gVGhpcyBjYW4gaGVscCBkZWJ1Z2dpbmcgdGVzdHMgdGhhdCBmYWlscywgb3IgZHVyaW5nIGltcGxlbWVudGF0aW8uCiAqIAogKiBAZXhhbXBsZQovLyBUaGlzIGlzIGFuIGV4YW1wbGUgb2YgdGhlIHByZWZmZXJlZCB3YXkgdG8gdXNlIHRoZSBVbml0VGVzdCBtb2R1bGU6CnVzZSggIlVuaXRUZXN0IiApOyAKLy8gQWRkIGEgZml4dHVyZSBmb3IgdGhlIG1vZHVsZS4KVW5pdFRlc3QuYWRkRml4dHVyZSggIlRlc3QgTW9kdWxlIG1vZHVsZW5hbWUiLCBmdW5jdGlvbigpIHsgCiAgICAvLyBBZGQgYWxsIHRoZSB0ZXN0cwogICAgQXNzZXJ0LmV4Y2VwdGlvbiggInJlYWRGaWxlIG9uIG5vbiBleGlzdGFudCBmaWxlIiwgJ3JlYWRGaWxlKCJub3RoZXJlIiknICk7IAogICAgQXNzZXJ0LnRoYXQoICJjb21tZW50IiwgJ2V4cHJlc3Npb24gZXZhbHVhdGluZyB0byB0cnVlJyApOwogICAgQXNzZXJ0Lm5vdCggIlRoaXMgc2hvdWxkIGFsd2F5cyBiZSBmYWxzZSIsICdleHByZXNzaW9uIGV2YWx1YXRpbmcgdG8gZmFsc2UnICk7CiAgICBBc3NlcnQuZXF1YWwoICJ0ZXN0MCwgb3V0cHV0IiwgJ3Rlc3QwKCknLCAiVXNlclBhcmFtIHdhcyAwIiApOwogICAgQXNzZXJ0LmVxdWFsKCAidGVzdDEsIGFycmF5IG91dHB1dCIsICd0ZXN0MSgpLnNvcnQoKScsIFsxLDIsMyw0XSApOyAgIAp9KTsKICogCiAqCiAqIEBuYW1lIFVuaXRUZXN0CiAqIEBuYW1lc3BhY2UKICogQHNlZSBBc3NlcnQKICovCnZhciBVbml0VGVzdCA9IGZ1bmN0aW9uKCApIHsKICAgIHZhciB0aGF0ID0ge307CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGxvZyBzb21ldGhpbmcsIGlmIHdlIGNhbiBsb2cKCiAgICBmdW5jdGlvbiB1dExvZyggc3RyaW5nICkgewogICAgICAgIGlmICggKCB0eXBlb2YgTG9nID09PSAib2JqZWN0IiApICYmIExvZy50cmFjZSAmJiAoIHR5cGVvZiBMb2cudHJhY2UgPT09ICJmdW5jdGlvbiIgKSApIHsKICAgICAgICAgICAgTG9nLnRyYWNlKCAiVW5pdFRlc3Q6ICIgKyBzdHJpbmcgKTsKICAgICAgICB9CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDcmVhdGUgYW4gQXNzZXJ0IG9iamVjdCwgZWcuIGV2ZXJ5IHRpbWUgd2UgY3JlYXRlIGEgRml4dHVyZSwgYW4gQXNzZXJ0IG9iamVjdCBpcyBjcmVhdGVkLgoKICAgIGZ1bmN0aW9uIENyZWF0ZUFzc2VydE9iamVjdCggZml4dHVyZU5hbWUgKSB7CiAgICAgICAgdmFyIHRoYXQgPSB7fTsKCiAgICAgICAgLy8gU3RvcmUgcmVzdWx0cyBvZiB0ZXN0Y2FzZXMgaW4gaGVyZS4KICAgICAgICB2YXIgbV9yZXBvcnRzID0gWyBdOwoKICAgICAgICAvLyBUaW1lc3RhbXAgZm9yIGxhc3QgdGltZSBhIHRlc3QgZW5kZWQgLSBvciBpbml0aWFsIHN0YXJ0IG9mIHRoZSBhc3NlcnQuCiAgICAgICAgdmFyIG1fbGFzdEVuZDsKCiAgICAgICAgdGhhdC5BY3RpdmF0ZUFzc2VydE9iamVjdCA9IGZ1bmN0aW9uKCApIHsKICAgICAgICAgICAgbV9sYXN0RW5kID0gRGF0ZS5ub3coICk7CiAgICAgICAgfQogICAgICAgIHRoYXQuQWN0aXZhdGVBc3NlcnRPYmplY3QoICk7CgogICAgICAgIC8vIEEgc2luZ2xlIHRlc3RjYXNlIG9iamVjdAoKICAgICAgICBmdW5jdGlvbiBDcmVhdGVUZXN0Y2FzZU9iamVjdCggb2JqZWN0ICkgewogICAgICAgICAgICAvLyBPYmplY3QgbXVzdCBjb250YWluOgogICAgICAgICAgICAvLyB7IG51bWJlcjogdGVzdG51bSwgcGFzc2VkOiBwYXNzZWQsIGZpeHR1cmU6dGhpcy5uYW1lLCBkZXNjcmlwdGlvbjpkZXNjcmlwdGlvbiwgcmVwb3J0OiBwcmludGJ1ZmZlciwgZXhwcmVzc2lvbjpleHByX3N0ciwgZXhwZWN0ZWQ6ZXhwZWN0ZWQsIHR5cGVvZmV4cGVjdGVkOnR5cGVvZmV4cGVjdGVkLCByZXN1bHQ6cmVzLCB0eXBlb2ZyZXN1bHQ6dHlwZW9mcmVzLCB1cmw6dXJsIH0gKTsKICAgICAgICAgICAgdmFyIHRoYXQgPSBvYmplY3Q7CgogICAgICAgICAgICAvLyBBZGp1c3QgdGltZQoKICAgICAgICAgICAgLy8gVGFrZSB0d28gc3RyaW5ncywgYW5kIHJldHVybiBhIHN0cmluZyBkZXNjcmliaW5nIHRoZWlyIGRpZmZlcmVuY2UKICAgICAgICAgICAgdmFyIGNvbXBhcmVTdHJpbmdzID0gZnVuY3Rpb24oIGV4cGVjdGVkLCBhY3R1YWwsIGxlYWRpbiwgbWF4d2lkdGggKSB7CiAgICAgICAgICAgICAgICAvLyBGaW5kIGZpcnN0IGRpZmZlcmVuY2UKICAgICAgICAgICAgICAgIHZhciBtYXhfbGVuZ3RoID0gTWF0aC5tYXgoIGV4cGVjdGVkLmxlbmd0aCwgYWN0dWFsLmxlbmd0aCApOwogICAgICAgICAgICAgICAgdmFyIGkgPSAwOwogICAgICAgICAgICAgICAgd2hpbGUgKCBpIDwgbWF4X2xlbmd0aCAmJiBhY3R1YWwuY2hhckF0KCBpICkgPT0gZXhwZWN0ZWQuY2hhckF0KCBpICkgKSB7CiAgICAgICAgICAgICAgICAgICAgKytpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gQWRqdXN0IHRvICJ3aW5kb3ciCiAgICAgICAgICAgICAgICB2YXIgYmVnaW4gPSAoIGkgPiBsZWFkaW4gKSA/ICggaSAtIGxlYWRpbiApIDogMDsKICAgICAgICAgICAgICAgIHZhciBwcmVmaXggPSBiZWdpbiA+IDAgPyAiLi4uIiA6ICIiOwogICAgICAgICAgICAgICAgdmFyIHN1ZmZpeGUgPSAoIGJlZ2luICsgbWF4d2lkdGggPCBleHBlY3RlZC5sZW5ndGggKSA/ICIuLi4iIDogIiI7CiAgICAgICAgICAgICAgICB2YXIgc3VmZml4YSA9ICggYmVnaW4gKyBtYXh3aWR0aCA8IGFjdHVhbC5sZW5ndGggKSA/ICIuLi4iIDogIiI7CiAgICAgICAgICAgICAgICB2YXIgcmVzID0gIkV4cGVjdGVkIGFuZCBhY3R1YWwgZGlmZmVycyBhdCBwb3NpdGlvbiAiICsgaSArICI6XG4iOwogICAgICAgICAgICAgICAgcmVzICs9ICJFeHBlY3RlZDogIiArIHByZWZpeCArIGV4cGVjdGVkLnNsaWNlKCBiZWdpbiwgYmVnaW4gKyBtYXh3aWR0aCApLnJlcGxhY2UoICJcbiIsICJcXG4iICkucmVwbGFjZSggIlx0IiwgIlxcdCIgKSArIHN1ZmZpeGUgKyAiXG4iOwogICAgICAgICAgICAgICAgcmVzICs9ICJBY3R1YWwgIDogIiArIHByZWZpeCArIGFjdHVhbC5zbGljZSggYmVnaW4sIGJlZ2luICsgbWF4d2lkdGggKS5yZXBsYWNlKCAiXG4iLCAiXFxuIiApLnJlcGxhY2UoICJcdCIsICJcXHQiICkgKyBzdWZmaXhhICsgIlxuIjsKICAgICAgICAgICAgICAgIHJlcyArPSAoICIgICAgICAgICAgIiArIHByZWZpeCArIGFjdHVhbC5zbGljZSggYmVnaW4sIGkgKS5yZXBsYWNlKCAiXG4iLCAiXFxuIiApLnJlcGxhY2UoICJcdCIsICJcXHQiICkgKS5yZXBsYWNlKCAvW1xzXFNdL2csICIgIiApCiAgICAgICAgICAgICAgICByZXMgKz0gIl4iOwogICAgICAgICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhhdC50b1N0cmluZyA9IGZ1bmN0aW9uKCApIHsKICAgICAgICAgICAgICAgIHZhciByZXMgPSAiPj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4gZXF1YWwgPDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDxcbiI7CiAgICAgICAgICAgICAgICByZXMgKz0gIlRlc3QgbnVtYmVyIDogIiArICggdGhpcy5udW1iZXIgKSArICJcbiI7CiAgICAgICAgICAgICAgICByZXMgKz0gIlVSTCAgICAgICAgIDogIiArICggdGhpcy51cmwgKSArICJcbiI7CiAgICAgICAgICAgICAgICByZXMgKz0gIkRlc2NyaXB0aW9uIDogIiArICggdGhpcy5kZXNjcmlwdGlvbiApICsgIlxuIjsKICAgICAgICAgICAgICAgIHJlcyArPSAiRXZhbHVhdGVkICAgOiAiICsgKCB0aGlzLmV4cHJlc3Npb24gKSArICJcbiI7CiAgICAgICAgICAgICAgICByZXMgKz0gIlRpbWUgICAgICAgIDogIiArICggKCB0aGlzLnRpbWUgLyAxMDAwLjAgKS50b0ZpeGVkKCAzICkgKSArICJcbiI7CiAgICAgICAgICAgICAgICByZXMgKz0gIkV4cGVjdGVkICAgIDogIiArICggdGhpcy5leHBlY3RlZCApICsgIiAoIiArIHRoaXMudHlwZW9mZXhwZWN0ZWQgKyAiKVxuIjsKICAgICAgICAgICAgICAgIHJlcyArPSAiQWN0dWFsICAgICAgOiAiICsgKCB0aGlzLnJlc3VsdCApICsgIiAoIiArIHRoaXMudHlwZW9mcmVzdWx0ICsgIilcbiI7CiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuc3RhY2sgIT0gIiIgKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzICs9ICJTdGFja3RyYWNlICA6ICIgKyB0aGlzLnN0YWNrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKCAic3RyaW5nIiA9PSB0aGlzLnR5cGVvZmV4cGVjdGVkICYmICJzdHJpbmciID09IHRoaXMudHlwZW9mcmVzdWx0ICkgewogICAgICAgICAgICAgICAgICAgIHJlcyArPSAiU3RyaW5nIGRpZmYgOiAiICsgY29tcGFyZVN0cmluZ3MoIHRoaXMuZXhwZWN0ZWQsIHRoaXMucmVzdWx0LCAyMCwgODAgKSArICJcbiI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyBJZiB4bWwsIGNvbXBhcmUuIEJvdGggZXhwZWN0ZWQgYW5kIHJlc3VsdCBzaG91bGQgYmUgdG9Tb3VyY2Ugbm93LgogICAgICAgICAgICAgICAgaWYgKCAieG1sIiA9PSB0aGlzLnR5cGVvZmV4cGVjdGVkICYmICJ4bWwiID09IHRoaXMudHlwZW9mcmVzdWx0ICkgewogICAgICAgICAgICAgICAgICAgIHJlcyArPSAiWE1MIGRpZmYgICAgOiAiICsKICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFyZVN0cmluZ3MoIHRoaXMuZXhwZWN0ZWQsIHRoaXMucmVzdWx0LCAyMCwgODAgKSArICJcbiI7CiAgICAgICAgICAgICAgICB9CgoKICAgICAgICAgICAgICAgIHJlcyArPSAiUmVzdWx0ICAgICAgOiAiICsgKCBmdW5jdGlvbiggKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggdGhpcy5wYXNzZWQgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIlBBU1NFRCIKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiRkFJTEVEIgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSApKCApICsgIlxuIjsKICAgICAgICAgICAgICAgIHJlcyArPSAiPj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4gPDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDxcbiI7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoYXQuZXNjYXBlWG1sID0gZnVuY3Rpb24oIGFyZyApIHsKICAgICAgICAgICAgICAgIHJldHVybiBhcmcucmVwbGFjZSggIiYiLCAiJmFtcDsiLCAiZyIgKS5yZXBsYWNlKCAiPCIsICImbHQ7IiwgImciICkucmVwbGFjZSggIj4iLCAiJmd0OyIsICJnIiApLnJlcGxhY2UoICInIiwgIiZhcG9zOyIsICJnIiApCiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoICciJywgIiZxdW90OyIsICJnIiApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoYXQudG9KVW5pdFhtbCA9IGZ1bmN0aW9uKCApIHsKICAgICAgICAgICAgICAgIHZhciByZXMgPSAiIjsKICAgICAgICAgICAgICAgIHJlcyArPSAiPHRlc3RjYXNlIGNsYXNzbmFtZT0nIiArIHRoaXMuZXNjYXBlWG1sKCB0aGlzLmZpeHR1cmUgKSArICInIHRpbWU9JyIgKyAoICggdGhpcy50aW1lIC8gMTAwMC4wICkudG9GaXhlZCggMyApICkgKyAiJyBuYW1lPSciICsgdGhpcy5lc2NhcGVYbWwoIHRoaXMuZGVzY3JpcHRpb24gKSArICInIjsKICAgICAgICAgICAgICAgIGlmICggdGhpcy5wYXNzZWQgKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzICs9ICIvPlxuIjsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gRHJvcHBlZCBpbmRlbnQgb2YgZmFpbHVyZSBiZWNhdXNlIGl0IGdldHMgdG8gYmUgcGFydCBvZiB0aGUgdGV4dAogICAgICAgICAgICAgICAgICAgIHJlcyArPSAiPlxuPGZhaWx1cmUgdHlwZT0nQ29tcGFyZUVycm9yJz5cbiIgKwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVzY2FwZVhtbCggIkZpeHR1cmUgICAgIDogIiArIHRoaXMuZml4dHVyZSArICJcbiIgKwogICAgICAgICAgICAgICAgICAgICAgICAiVVJMICAgICAgICAgOiAiICsgKCB0aGlzLmVzY2FwZVhtbCggdGhpcy51cmwgKSApICsgIlxuIiArCiAgICAgICAgICAgICAgICAgICAgICAgICJEZXNjcmlwdGlvbiA6ICIgKyB0aGlzLmRlc2NyaXB0aW9uICsgIlxuIiArCiAgICAgICAgICAgICAgICAgICAgICAgICJFdmFsdWF0ZWQgICA6ICIgKyB0aGlzLmV4cHJlc3Npb24gKyAiXG4iICsKICAgICAgICAgICAgICAgICAgICAgICAgIkV4cGVjdGVkICAgIDogIiArIHRoaXMuZXhwZWN0ZWQgKyAiICgiICsgdGhpcy50eXBlb2ZleHBlY3RlZCArICIpXG4iICsKICAgICAgICAgICAgICAgICAgICAgICAgIkFjdHVhbCAgICAgIDogIiArIHRoaXMucmVzdWx0ICsgIiAoIiArIHRoaXMudHlwZW9mcmVzdWx0ICsgIilcbiIgKTsKICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMuc3RhY2sgIT0gIiIgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyArPSAiU3RhY2t0cmFjZSAgOiAiICsgdGhpcy5lc2NhcGVYbWwoIHRoaXMuc3RhY2sgKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKCAic3RyaW5nIiA9PSB0aGlzLnR5cGVvZmV4cGVjdGVkICYmICJzdHJpbmciID09IHRoaXMudHlwZW9mcmVzdWx0ICkgewogICAgICAgICAgICAgICAgICAgICAgICByZXMgKz0gdGhpcy5lc2NhcGVYbWwoICJTdHJpbmcgZGlmZiA6ICIgKyBjb21wYXJlU3RyaW5ncyggdGhpcy5leHBlY3RlZCwgdGhpcy5yZXN1bHQsIDQwLCAxMjAgKSArICJcbiIgKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy8gSWYgeG1sLCBjb21wYXJlLiBCb3RoIGV4cGVjdGVkIGFuZCByZXN1bHQgc2hvdWxkIGJlIHRvU291cmNlIG5vdy4KICAgICAgICAgICAgICAgICAgICBpZiAoICJ4bWwiID09IHRoaXMudHlwZW9mZXhwZWN0ZWQgJiYgInhtbCIgPT0gdGhpcy50eXBlb2ZyZXN1bHQgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyArPSB0aGlzLmVzY2FwZVhtbCggIlhNTCBkaWZmICAgIDogIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wYXJlU3RyaW5ncyggdGhpcy5leHBlY3RlZCwgdGhpcy5yZXN1bHQsIDIwLCA4MCApICsgIlxuIiApOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXMgKz0gIjwvZmFpbHVyZT5cbiI7CiAgICAgICAgICAgICAgICAgICAgcmVzICs9ICI8L3Rlc3RjYXNlPlxuIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRoYXQ7CiAgICAgICAgfQoKICAgICAgICB2YXIgbV90b3RhbFBhc3NlZCA9IDA7CiAgICAgICAgdmFyIG1fdG90YWxGYWlsZWQgPSAwOwoKICAgICAgICAvKioKICAgICAgICAgKiBUaGUgbnVtYmVyIG9mIHBhc3NlZCB0ZXN0cyBpbiB0aGlzIGZpeHR1cmUuCiAgICAgICAgICogCiAgICAgICAgICogCiAgICAgICAgICogQHN5bnRheCBBc3NlcnQudG90YWxQYXNzZWQoKQogICAgICAgICAqIEByZXR1cm4ge251bWJlcn0gVGhlIG51bWJlciBvZiBwYXNzZWQgdGVzdHMgaW4gdGhpcyBmaXh0dXJlCiAgICAgICAgICogQG5hbWUgQXNzZXJ0LnRvdGFsUGFzc2VkCiAgICAgICAgICogQG1ldGhvZAogICAgICAgICAqLwogICAgICAgIHRoYXQudG90YWxQYXNzZWQgPSBmdW5jdGlvbiggKSB7CiAgICAgICAgICAgIHJldHVybiBtX3RvdGFsUGFzc2VkOwogICAgICAgIH07CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiBjdXJyZW50bHkgZmFpbGVkIHRlc3RzLgogICAgICAgICAqIAogICAgICAgICAqIFRoaXMgaXMgbW9zdGx5IHVzZWQgYnkgc2NyaXB0cyB0aGF0IGRlZmluZXMgYSBudW1iZXIgb2YgbW9kdWxlcyB0bwogICAgICAgICAqIHVuaXR0ZXN0LiBJZiB5b3UgZW5kIHN1Y2ggYSBzY3JpcHQgd2l0aCBhIGNhbGwgdG8gdGhpcyBmdW5jdGlvbiwgaXQKICAgICAgICAgKiB3aWxsIHJldHVybiB0aGF0IHZhbHVlIHRvIHRoZSBjYWxsaW5nIHNoZWxsLCBhbmQgaXQgY2FuIGJlIHVzZWQgdG8KICAgICAgICAgKiBkZXRlY3QgYW55IGZhaWx1cmVzLiAKICAgICAgICAgKiAKICAgICAgICAgKiBAdHlwZSB7bWV0aG9kfQogICAgICAgICAqIEBzeW50YXggVW5pdFRlc3QudG90YWxGYWlsZWQoKQogICAgICAgICAqIEByZXR1cm4gVGhlIG51bWJlciBvZiBmYWlsZWQgdGVzdCBzbyBmYXIuCiAgICAgICAgICogQG5hbWUgVW5pdFRlc3QudG90YWxGYWlsZWQKICAgICAgICAgKiBAc291cmNlTmFtZSB0aGF0LnRvdGFsRmFpbGVkCiAgICAgICAgICogQHdyb25nbHlQbGFjZWRDb21tZW50IG1heWJlCiAgICAgICAgICogQG1ldGhvZAogICAgICAgICAqLwogICAgICAgIC8qKgogICAgICAgICAqIFRoZSBudW1iZXIgb2YgZmFpbGVkIHRlc3RzIGluIHRoaXMgZml4dHVyZS4KICAgICAgICAgKiAKICAgICAgICAgKiAKICAgICAgICAgKiBAdHlwZSB7cHJvcGVydHl9CiAgICAgICAgICogQHN5bnRheCBBc3NlcnQudG90YWxGYWlsZWQoKQogICAgICAgICAqIEByZXR1cm4ge251bWJlcn0gVGhlIG51bWJlciBvZiBmYWlsZWQgdGVzdHMgaW4gdGhpcyBmaXh0dXJlCiAgICAgICAgICogQG5hbWUgQXNzZXJ0LnRvdGFsRmFpbGVkCiAgICAgICAgICogQHNvdXJjZU5hbWUgdGhhdC50b3RhbEZhaWxlZAogICAgICAgICAqIEB3cm9uZ2x5UGxhY2VkQ29tbWVudCBtYXliZQogICAgICAgICAqIEBtZXRob2QKICAgICAgICAgKi8KICAgICAgICB0aGF0LnRvdGFsRmFpbGVkID0gZnVuY3Rpb24oICkgewogICAgICAgICAgICByZXR1cm4gbV90b3RhbEZhaWxlZDsKICAgICAgICB9OwoKICAgICAgICAvKioKICAgICAgICAgKiBUaGUgbmFtZSBvZiB0aGlzIGZpeHR1cmUuCiAgICAgICAgICogCiAgICAgICAgICogCiAgICAgICAgICogQHR5cGUge3Byb3BlcnR5fQogICAgICAgICAqIEBuYW1lIEFzc2VydC5uYW1lCiAgICAgICAgICogQG1ldGhvZAogICAgICAgICAqLwogICAgICAgIHRoYXQubmFtZSA9IG5ldyBTdHJpbmcoIGZpeHR1cmVOYW1lICk7CgogICAgICAgIC8qKgogICAgICAgICAqIEJ1aWxkIGEgcmVwb3J0IG9mIGFsbCB0ZXN0IGZpeHR1cmVzIGFuZCBhbGwgdGVzdCBjYXNlcyBpbiBlaXRoZXIgc3RyaW5nIG9yIFhtbCBmb3JtYXQuCiAgICAgICAgICogCiAgICAgICAgICogVGhpcyBidWlsZHMgYSByZXBvcnQgb2YgYWxsIGV4ZWN1dGVkIHRlc3QgZml4dHVyZXMsIHdpdGggYWxsIHRlc3QKICAgICAgICAgKiBjYXNlcy4gVGhlIHJlcG9ydCBpcyBmb3JtYXR0ZWQgaW4gWG1sIGZvcm1hdCBvciBzdHJpbmcgZm9ybWF0LAogICAgICAgICAqIGRlcGVuZGluZyBvbiB0aGUgdmFsdWUgb2YgdGhlIFVuaXRUZXN0Lm91dHB1dFhtbCB2YXJpYWJsZSAKICAgICAgICAgKiAKICAgICAgICAgKiBAdHlwZSB7bWV0aG9kfQogICAgICAgICAqIEBzeW50YXggVW5pdFRlc3QucmVwb3J0KCkKICAgICAgICAgKiBAcmV0dXJuIEEgc3RyaW5nIHdpdGggYSB0ZXN0IHJlcG9ydCwgc3VpdGFibGUgZm9yIHByaW50aW5nCiAgICAgICAgICogQG5hbWUgVW5pdFRlc3QucmVwb3J0CiAgICAgICAgICogQHNvdXJjZU5hbWUgdGhhdC5yZXBvcnQKICAgICAgICAgKiBAd3JvbmdseVBsYWNlZENvbW1lbnQgbWF5YmUKICAgICAgICAgKiBAbWV0aG9kCiAgICAgICAgICovCiAgICAgICAgLyoqCiAgICAgICAgICogUmV0dXJuIGEgcmVwb3J0IGZvciB0aGUgZml4dHVyZS4KICAgICAgICAgKiAKICAgICAgICAgKiBUaGlzIG1ldGhvZCByZXR1cm5zIGEgc3RyaW5nLCB0aGF0IGNvbnRhaW5zIGEgbGlzdCB3aXRoIGRldGFpbHMgYWJvdXQKICAgICAgICAgKiBlYWNoIHRlc3RjYXNlLiBCeSBkZWZhdWx0IG9ubHkgZmFpbGVkIHRlc3RjYXNlcyBhcmUgcmVwb3J0ZWQsIGJ1dCBpZgogICAgICAgICAqIHZlcmJvc2UgaXMgdHJ1ZSwgcGFzc2VkIHRlc3RjYXNlcyBhcmUgaW5jbHVkZWQgdG9vLiAKICAgICAgICAgKiAKICAgICAgICAgKiBAdHlwZSB7bWV0aG9kfQogICAgICAgICAqIEBzeW50YXggQXNzZXJ0LnJlcG9ydCggdmVyYm9zZSApOwogICAgICAgICAqIEBwYXJhbSB2ZXJib3NlIElmIHRydWUsIGluY2x1ZGUgcGFzc2VkIHRlc3RzIGluIHJlcG9ydCwgb3RoZXJ3aXNlIG9ubHkgZmFpbGVkIHRlc3RzCiAgICAgICAgICogQG5hbWUgQXNzZXJ0LnJlcG9ydAogICAgICAgICAqIEBzb3VyY2VOYW1lIHRoYXQucmVwb3J0CiAgICAgICAgICogQHdyb25nbHlQbGFjZWRDb21tZW50IG1heWJlCiAgICAgICAgICogQG1ldGhvZAogICAgICAgICAqLwogICAgICAgIHRoYXQucmVwb3J0ID0gZnVuY3Rpb24oIHZlcmJvc2UgKSB7CiAgICAgICAgICAgIHZhciByZXMgPSAiIjsKICAgICAgICAgICAgZm9yICggdmFyIHJlcG9ydGkgaW4gbV9yZXBvcnRzICkgewogICAgICAgICAgICAgICAgdmFyIHJlcG9ydCA9IG1fcmVwb3J0c1sgcmVwb3J0aSBdOwogICAgICAgICAgICAgICAgaWYgKCB2ZXJib3NlIHx8IHJlcG9ydC5wYXNzZWQgPT09IGZhbHNlICkgewogICAgICAgICAgICAgICAgICAgIHJlcyArPSByZXBvcnQudG9TdHJpbmcoICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCByZXMgIT09ICIiICkgewogICAgICAgICAgICAgICAgcmVzID0gIj4+Pj4+Pj4+Pj4+Pj4+ICIgKyB0aGlzLm5hbWUgKyAiXG4iICsgcmVzOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfTsKCiAgICAgICAgLyoqCiAgICAgICAgICogQnVpbGQgYSByZXBvcnQgb2YgYWxsIHRlc3QgZml4dHVyZXMgYW5kIGFsbCB0ZXN0IGNhc2VzIGluIEpVbml0IFhtbCBmb3JtYXQuCiAgICAgICAgICogCiAgICAgICAgICogVGhpcyBidWlsZHMgYSByZXBvcnQgb2YgYWxsIGV4ZWN1dGVkIHRlc3QgZml4dHVyZXMsIHdpdGggYWxsIHRlc3QKICAgICAgICAgKiBjYXNlcy4gVGhlIHJlcG9ydCBpcyBmb3JtYXR0ZWQgaW4gWG1sIGZvcm1hdCwgY29tcGF0aWJsZSB3aXRoIEpVbml0IAogICAgICAgICAqIAogICAgICAgICAqIEB0eXBlIHttZXRob2R9CiAgICAgICAgICogQHN5bnRheCBVbml0VGVzdC5yZXBvcnQoKQogICAgICAgICAqIEByZXR1cm4gQSBzdHJpbmcgd2l0aCBhIHRlc3QgcmVwb3J0LCBzdWl0YWJsZSBmb3IgcHJpbnRpbmcKICAgICAgICAgKiBAbmFtZSBVbml0VGVzdC5yZXBvcnRKVW5pdFhtbAogICAgICAgICAqIEBtZXRob2QKICAgICAgICAgKi8KICAgICAgICB0aGF0LnJlcG9ydEpVbml0WG1sID0gZnVuY3Rpb24oICkgewogICAgICAgICAgICB2YXIgcmVzID0gIiI7CiAgICAgICAgICAgIGZvciAoIHZhciByZXBvcnRpIGluIG1fcmVwb3J0cyApIHsKICAgICAgICAgICAgICAgIHJlcyArPSBtX3JlcG9ydHNbIHJlcG9ydGkgXS50b0pVbml0WG1sKCApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm4gYW4gYXJyYXkgb2YgbnVtYmVycyBmb3IgdGhlIGZhaWxlZCB0ZXN0Y2FzZXMuCiAgICAgICAgICogCiAgICAgICAgICogVGhpcyBtZXRob2QgcmV0dXJucyBhbiBhcnJheSBjb250YWluaW5nIG51bWJlcnMgb2YgdGhlIGZhaWxlZCB0ZXN0Y2FzZXMgCiAgICAgICAgICogCiAgICAgICAgICogQHR5cGUge21ldGhvZH0KICAgICAgICAgKiBAc3ludGF4IEFzc2VydC5mYWlsZWQoKQogICAgICAgICAqIEByZXR1cm4gQXJyYXkgd2l0aCBudW1iZXJzIG9mIGZhaWxlZCB0ZXN0Y2FzZXMKICAgICAgICAgKiBAbmFtZSBBc3NlcnQuZmFpbGVkCiAgICAgICAgICogQG1ldGhvZAogICAgICAgICAqLwogICAgICAgIHRoYXQuZmFpbGVkID0gZnVuY3Rpb24oICkgewogICAgICAgICAgICB2YXIgcmVzID0gWyBdOwogICAgICAgICAgICBmb3IgKCB2YXIgcmVwb3J0aSBpbiBtX3JlcG9ydHMgKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVwb3J0ID0gbV9yZXBvcnRzWyByZXBvcnRpIF07CiAgICAgICAgICAgICAgICBpZiAoIHJlcG9ydC5wYXNzZWQgPT09IGZhbHNlICkgewogICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKCByZXBvcnQubnVtYmVyICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICB9OwoKICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgICAgICAvLyBQdWJsaWMgaW50ZXJmYWNlIG9mIEFzc2VydCBvYmplY3QKCgogICAgICAgIC8vIEFzc2VydGZ1bmN0aW9uIGZvciB2YWx1ZXMgcmF0aGVyIHRoYW4gZXZhbCdlZCBzdHJpbmdzLgogICAgICAgIC8qKgogICAgICAgICAqIFRlc3QgdGhhdCB0d28gdmFsdWVzIGFyZSB0aGUgc2FtZS4KICAgICAgICAgKiAKICAgICAgICAgKiBTaW1pbGFyIHRvIEFzc2VydC5lcXVhbCwgZXhjZXB0IHRoYXQgdGhlIHBhcmFtZXRlciBpcyBhIHZhbHVlLCBhbmQgbm90CiAgICAgICAgICogYSBzdHJpbmcgdG8gYmUgZXZhbHVhdGVkLiAKICAgICAgICAgKiAKICAgICAgICAgKiBAc3ludGF4IEFzc2VydC5lcXVhbFZhbHVlKCBkZXNjcmlwdGlvbiwgdmFsdWUsIGV4cGVjdGVkICk7CiAgICAgICAgICogQHBhcmFtIGRlc2NyaXB0aW9uIFVzZWQgZm9yIGZlZWRiYWNrIGluIGNhc2Ugb2YgZXJyb3JzCiAgICAgICAgICogQHBhcmFtIHZhbHVlIFRoZSB2YWx1ZSB0byBjb21wYXJlLgogICAgICAgICAqIEBwYXJhbSBleHBlY3RlZCBUaGUgZXhwZWN0ZWQgcmVzdWx0LgogICAgICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdGVzdCBwYXNzZWQsIGZhbHNlIG90aGVyd2lzZQogICAgICAgICAqIEBleGFtcGxlIEFzc2VydC5lcXVhbFZhbHVlKCAiMiArIDIgaXMgNSIsIDIrMiwgNSkKICAgICAgICAgKiBAbmFtZSBBc3NlcnQuZXF1YWxWYWx1ZQogICAgICAgICAqIEBtZXRob2QKICAgICAgICAgKi8KICAgICAgICB0aGF0LmVxdWFsVmFsdWUgPSBmdW5jdGlvbiggZGVzYywgYSwgYiApIHsKICAgICAgICAgICAgaWYgKCB1bmV2YWwoIGEgKSA9PT0gdW5ldmFsKCBiICkgKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhhdC5lcXVhbCggZGVzYywgdHJ1ZSwgdHJ1ZSApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoYXQuZXF1YWwoIGRlc2MsIHVuZXZhbCggYSApLCBiICk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFRlc3RzIGlmIHR3byB2YWx1ZXMgYXJlIGRpZmZlcmVudC4uCiAgICAgICAgICogCiAgICAgICAgICogU2ltaWxhciB0byBBc3NlcnQuZXF1YWwsIGJ1dCB0ZXN0cyBmb3Igbm90IGVxdWFsLiAKICAgICAgICAgKiAKICAgICAgICAgKiBAc3ludGF4IEFzc2VydC5ub3RFcXVhbCggZGVzY3JpcHRpb24sIHZhbHVlLCBleHBlY3RlZCApOwogICAgICAgICAqIEBwYXJhbSBkZXNjcmlwdGlvbiBVc2VkIGZvciBmZWVkYmFjayBpbiBjYXNlIG9mIGVycm9ycwogICAgICAgICAqIEBwYXJhbSB2YWx1ZSBUaGUgdmFsdWUgdG8gY29tcGFyZS4KICAgICAgICAgKiBAcGFyYW0gZXhwZWN0ZWQgVGhlIGV4cGVjdGVkIHJlc3VsdC4KICAgICAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIHRlc3QgcGFzc2VkLCBmYWxzZSBvdGhlcndpc2UKICAgICAgICAgKiBAbmFtZSBBc3NlcnQubm90RXF1YWwKICAgICAgICAgKiBAbWV0aG9kCiAgICAgICAgICovCiAgICAgICAgdGhhdC5ub3RFcXVhbCA9IGZ1bmN0aW9uKCBkZXNjLCByZXN1bHQsIGV4cGVjdGVkICkgewogICAgICAgICAgICBpZiAoIGFyZ3VtZW50cy5sZW5ndGggIT09IDMgKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAibm90RXF1YWwgbmVlZHMgZGVzY3JpcHRpb24sIHJlc3VsdCwgYW5kIGV4cGVjdGVkIHZhbHVlIjsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBUaGUgY3VycmVudCBpbXBsZW1lbnRhdGlvbiBpcyBqdXN0IGEgcXVpY2sgaGFjaywgCiAgICAgICAgICAgIC8vIGFzIGl0IHdpbGwgYmUgcmVpbXBsZW10ZWQgd2hlbiB0aGUKICAgICAgICAgICAgLy8gdW5pdCB0ZXN0IHN5c3RlbSBpcyBkdWUgZm9yIHNvbWUgcmVmYWN0b3JpbmcsCiAgICAgICAgICAgIC8vIHNlZSBidWcgMTAzMjMuCiAgICAgICAgICAgIHJlc3VsdFN0cmluZyA9IHVuZXZhbCggVXRpbC5rZXlTb3J0ZWRPYmplY3QoIHJlc3VsdCApICk7CiAgICAgICAgICAgIGV4cGVjdGVkU3RyaW5nID0gdW5ldmFsKCBVdGlsLmtleVNvcnRlZE9iamVjdCggZXhwZWN0ZWQgKSApOwogICAgICAgICAgICBpZiAoIHJlc3VsdFN0cmluZyAhPT0gZXhwZWN0ZWRTdHJpbmcgKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhhdC5lcXVhbCggZGVzYywgMSwgMSApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoYXQuZXF1YWwoIGRlc2MsIHVuZXZhbCggcmVzdWx0U3RyaW5nICksICJub3QgIiArIGV4cGVjdGVkU3RyaW5nICk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFdoYXQgaXMgdXJsIGZvciB0aGUgY3VycmVudGx5IGxvYWRpbmcgbW9kdWxlIG9yIGEgc3RyaW5nIHNheWluZyAidW5hdmFpbGFibGUiCiAgICAgICAgdmFyIGdldFVybEZvckxvYWRpbmdNb2R1bGUgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHZhciBtb2R1bGUgPSBfX01vZHVsZXNJbmZvLmdldE1vZHVsZSggX19Nb2R1bGVzSW5mby5jdXJyZW50TG9hZGluZ01vZHVsZSgpICk7CiAgICAgICAgICAgICAgICBpZiAoIG1vZHVsZS51cmwgKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZS51cmw7CiAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAvLyBlYXQgdGhlIGV4Y2VwdGlvbiBzaWxlbnRseS4KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gIjx1bmFibGUgdG8gb2J0YWluPiI7CiAgICAgICAgfQoKCiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAgICAgLy8gVXNlIHdpdGggYSBzdHJpbmcgaW5jbHVkaW5nIGFuIGV4cHJlc3Npb24sIGFuZCB0aGUgZXhwZWN0ZWQgcmVzdWx0CiAgICAgICAgLy8gTm90ZSwgdGhlIHJlc3VsdCBvZiBleHByIG1heSBiZSBwcmludGVkLCBzbyBpdCBvbmx5IHdvcmtzIHdpdGggcHJpbnRhYmxlIHJlc3VsdHMKICAgICAgICAvKioKICAgICAgICAgKiBUZXN0IHRoYXQgdHdvIGV4cHJlc3Npb25zIGFyZSBlcXVhbC4KICAgICAgICAgKiAKICAgICAgICAgKiBUaGlzIG1ldGhvZCBpcyB0aGUgY29yZSBvZiB0aGUgdGVzdGluZyBzeXN0ZW0uIEl0IHRha2VzIGFuIGV4cHJlc3Npb24KICAgICAgICAgKiB0aGF0IGl0IGV2YWx1YXRlcywgYW5kIGNvbXBhcmVzIHRoZSByZXN1bHQgdG8gdGhlIGV4cGVjdGVkIHZhbHVlLiBJZgogICAgICAgICAqIHRoZSByZXN1bHRzIGFyZSBlcXVhbCwgYSBzdWNjZXNzIGlzIHJlcG9ydGVkLiBJZiB0aGUgcmVzdWx0cyBhcmUgbm90CiAgICAgICAgICogZXF1YWwsIGEgZmFpbHVyZSBpcyByZWNvcmRlZC4gVGhlIG9wdGlvbmFsIGRlc2NyaXB0aW9uIHBhcmFtZXRlciBpcwogICAgICAgICAqIHVzZWQgaW4gZXJyb3IgcmVwb3J0cywgYW5kIGluIGdlbmVyYWwgaXQgaXMgcmVjb21tZW5kZWQgdGhhdCB5b3UKICAgICAgICAgKiBwcm92aWRlIGEgZGVzY3JpcHRpb24gdG8gZmFjaWxpdGF0ZSBkZWJ1Z2dpbmcgd2hlbiB0ZXN0cyBmYWlscy4gWW91IGNhbgogICAgICAgICAqIHBhc3MgYXJyYXlzIHRvIHRoaXMgbWV0aG9kOyB0aGV5IHdpbGwgYmUgY29tcGFyZWQgZWxlbWVudHdpc2UuIEVsZW1lbnRzCiAgICAgICAgICogbmVlZCB0byBvY2N1ciBpbiB0aGUgc2FtZSBvcmRlciwgc28gWzEsMl0gIT09IFsyLDFdLiBVc2Ugc29ydCBpZiB5b3UKICAgICAgICAgKiBuZWVkIHNldC1saWtlIGNvbXBhcmlzaW9uLiBZb3UgY2FuIGFsc28gcGFzcyBvYmplY3RzIHRvIHRoaXMgbWV0aG9kLgogICAgICAgICAqIE9iamVjdHMgYXJlIGNvbXBhcmVkIGFzIGFycmF5cywgZXhjZXB0IGZvciB0aGUgbGVuZ3RoIHByb3BlcnR5LiBGb3IKICAgICAgICAgKiBib3RoLCBvbmx5IG93blByb3BlcnRpZXMgYXJlIGNvbXBhcmVkLiAKICAgICAgICAgKiAKICAgICAgICAgKiBAc3ludGF4IEFzc2VydC5lcXVhbCggW2Rlc2NyaXB0aW9uLCBdLCBleHByZXNzaW9uLCBleHBlY3RlZCApOwogICAgICAgICAqIEBwYXJhbSBkZXNjcmlwdGlvbiBPcHRpb25hbCBwYXJhbWV0ZXIsIHVzZWQgZm9yIGZlZWRiYWNrIGluIGNhc2Ugb2YgZXJyb3JzCiAgICAgICAgICogQHBhcmFtIGV4cHJlc3Npb24gVGhlIGV4cHJlc3Npb24gdG8gZXZhbHVhdGUuIFRoaXMgbXVzdCBiZSBhIHN0cmluZyB0aGF0IGNhbiBiZSBldmFsdWF0ZWQgb3IgdGhlIG1ldGhvZCB3aWxsIG5vdCB3b3JrIGFzIGV4cGVjdGVkLgogICAgICAgICAqIEBwYXJhbSBleHBlY3RlZCBUaGUgZXhwZWN0ZWQgdmFsdWUgZnJvbSB0aGUgZXZhbHVhdGVkIGV4cHJlc3Npb24uIE5vdGUsIHRoYXQgdGhpcyBpcyBub3QgZXZhbHVhdGVkLgogICAgICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdGVzdCBwYXNzZWQsIGZhbHNlIG90aGVyd2lzZQogICAgICAgICAqIEBub3RlIFRoZSBsYXN0IHBhcmFtZXRlciB0byB0aGlzIGZ1bmN0aW9uIGlzIG5vdCBldmFsdWF0ZWQuIFRoaXMgbWVhbnMgdGhhdCBlLmcuIEFzc2VydC5lcXVhbCggJ3RydWUnLCAndHJ1ZScgKSB3aWxsIGZhaWwsIGFzIHRoZSBsYXN0IGFyZ3VtZW50IGlzIGEgc3RyaW5nLCB3aGljaCBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgcmVzdWx0IG9mIGV2YWwoICd0cnVlJyApLgogICAgICAgICAqIEBuYW1lIEFzc2VydC5lcXVhbAogICAgICAgICAqIEBtZXRob2QKICAgICAgICAgKi8KICAgICAgICB0aGF0LmVxdWFsID0gZnVuY3Rpb24oIGRlc2NyaXB0aW9uLCBleHByLCBleHBlY3RlZCApIHsKICAgICAgICAgICAgdXRMb2coICJBc3NlcnQgZW50ZXJpbmcgZXF1YWwsIGRlc2M6ICIgKyBkZXNjcmlwdGlvbiApOwoKICAgICAgICAgICAgdmFyIHVuY2F1Z2h0ID0gZmFsc2U7CiAgICAgICAgICAgIHZhciBlcnJvcnN0cmluZzsKICAgICAgICAgICAgLy8gTWFzc2FnZSBhcmdzCiAgICAgICAgICAgIGlmICggYXJndW1lbnRzLmxlbmd0aCA8IDMgKSB7CiAgICAgICAgICAgICAgICBleHBlY3RlZCA9IGV4cHI7CiAgICAgICAgICAgICAgICBleHByID0gZGVzY3JpcHRpb247CiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICI8bm8gZGVzY3JpcHRpb24gb2YgdGVzdGNhc2U+IjsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgcmVzOyAvLyAiZXZhbHVhdGVkIiBleHByCiAgICAgICAgICAgIHZhciBleHByX3N0ciA9ICdVTkFWQUlMQUJMRSAobm90IGEgc3RyaW5nKSc7CiAgICAgICAgICAgIHZhciBzdGFjayA9ICIiOwogICAgICAgICAgICBpZiAoIHR5cGVvZiggZXhwciApID09PSAnc3RyaW5nJyApIHsKICAgICAgICAgICAgICAgIC8vIEV2YWwgdGhlIGV4cHJlc3Npb24uCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHJlcyA9IGV2YWwoIGV4cHIgKTsKICAgICAgICAgICAgICAgICAgICBleHByX3N0ciA9IGV4cHI7CiAgICAgICAgICAgICAgICB9IGNhdGNoICggZXJyb3IgKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzID0gIlJlY2VpdmVkIGV4Y2VwdGlvbjogIiArIGVycm9yLnRvU291cmNlKCApOwogICAgICAgICAgICAgICAgICAgIC8vIElmIGl0IGhhcyBhIHN0YWNrLCBhbmQgaXQgaXMgaW4gU3BpZGVyTW9ua2V5IGZvcm1hdCwgdHJ5IG1ha2luZyBpdCBtb3JlIHJlYWRhYmxlLgogICAgICAgICAgICAgICAgICAgIGlmICggZXJyb3Iuc3RhY2sgJiYgKCB0eXBlb2YgZXJyb3Iuc3RhY2sgPT0gInN0cmluZyIgKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2sgPSBlcnJvci5zdGFjay5yZXBsYWNlKCAvKEBbXjpcW10qOikvZywgIlxuJDEiICk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIE1heWJlIHRoZXJlIHdpbGwgc29tZXRpbWVzIGJlIGEgUmhpbm8gc3RhY2sgdGhlcmUgaGVyZS4gV2UgaG9wZS4uLgogICAgICAgICAgICAgICAgICAgIC8vIEl0IG5lZWRzIHRvIGJlIGNoYW5nZSBmcm9tIGEgamF2YS5sYW5nLlN0cmluZyBpbnRvIGEgSmF2YVNjcmlwdCBzdHJpbmcuCiAgICAgICAgICAgICAgICAgICAgaWYgKCBlcnJvci5yaGlub0V4Y2VwdGlvbiApIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2sgPSBTdHJpbmcoIGVycm9yLnJoaW5vRXhjZXB0aW9uLmdldFNjcmlwdFN0YWNrVHJhY2UoICkgKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZXJyb3JzdHJpbmcgPSBlcnJvcjsKICAgICAgICAgICAgICAgICAgICB1bmNhdWdodCA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBqdXN0ICJrZWVwIiB0aGUgZXhwcmVzc29uCiAgICAgICAgICAgICAgICByZXMgPSBleHByOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciB0aW1lID0gRGF0ZS5ub3coICkgLSBtX2xhc3RFbmQ7CgogICAgICAgICAgICAvLyB2YXIgcHJpbnRidWZmZXIgPSAiPHRlc3RjYXNlIGNsYXNzPVwiIiArIHRoaXMubmFtZSArICJcIiBuYW1lPVwiIiArIGRlc2NyaXB0aW9uICsgIlwiPlxuIjsKICAgICAgICAgICAgdmFyIHByaW50YnVmZmVyID0gIiI7CgogICAgICAgICAgICBmdW5jdGlvbiBwcmludGxuKCBhcmcgKSB7CiAgICAgICAgICAgICAgICBwcmludGJ1ZmZlciArPSBhcmcgKyAiXG4iOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgdHlwZW9mcmVzID0gVXRpbC5nZXRUeXBlKCByZXMgKTsKICAgICAgICAgICAgdmFyIHR5cGVvZmV4cGVjdGVkID0gVXRpbC5nZXRUeXBlKCBleHBlY3RlZCApOwogICAgICAgICAgICB2YXIgcGFzc2VkOwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHBhc3NlZCA9ICggcmVzID09PSBleHBlY3RlZCApIHx8ICggdW5ldmFsKCBVdGlsLmtleVNvcnRlZE9iamVjdCggcmVzICkgKSA9PT0gdW5ldmFsKCBVdGlsLmtleVNvcnRlZE9iamVjdCggZXhwZWN0ZWQgKSApICk7CiAgICAgICAgICAgICAgICAvLyBCdWcgMTc4ODQgLSBYTUwgbmVlZHMgYSBzcGVjaWFsIGNhc2UKICAgICAgICAgICAgICAgIGlmICggISBwYXNzZWQgJiYgdHlwZW9mcmVzID09ICJ4bWwiICYmIHR5cGVvZmV4cGVjdGVkID09ICJ4bWwiICkgewogICAgICAgICAgICAgICAgICAgIHBhc3NlZCA9ICggcmVzID09IGV4cGVjdGVkICk7CiAgICAgICAgICAgICAgICAgICAgLy8gU3RpbGwgbm90IGVxdWFsLiBMZXRzIHNlcmlhbGl6ZSBhbmQgdHJ5IGFnYWluLgogICAgICAgICAgICAgICAgICAgIGlmICggIXBhc3NlZCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhyZXMgPSBuZXcgWE1MKCByZXMudG9YTUxTdHJpbmcoKSApOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeGV4cGVjdGVkID0gbmV3IFhNTCggZXhwZWN0ZWQudG9YTUxTdHJpbmcoKSApOwogICAgICAgICAgICAgICAgICAgICAgICBwYXNzZWQgPSAoIHhyZXMgPT0geGV4cGVjdGVkICk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoICggZSApIHsKICAgICAgICAgICAgICAgIHBhc3NlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgdW5jYXVnaHQgPSB0cnVlOwogICAgICAgICAgICAgICAgZXJyb3JzdHJpbmcgPSAiR290IGV4Y2VwdGlvbiB3aGlsZSB0cnlpbmcgdG8gY29tcGFyZSByZXN1bHQgd2l0aCBleHBlY3RlZCAtIHRoaXMgdGVzdCBtYXkgb3IgbWF5IG5vdCBiZSBwYXNzZWQuIFRoaXMgaXMgbGlrZWx5IGR1ZSB0byBhIGdldHRlciB0aHJvd2luZyBhbiBleGNlcHRpb24uIFRoZSBleGNlcHRpb24gd2FzOiIgKyBlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgdGVzdG51bSA9IG1fdG90YWxQYXNzZWQgKyBtX3RvdGFsRmFpbGVkOwogICAgICAgICAgICAvLyBDcmVhdGUgYSByZXBvcnQKICAgICAgICAgICAgLy8gcHJpbnRsbiggIj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+IGVxdWFsIDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8IiApOwogICAgICAgICAgICAvLyB2YXIgc2luZ2xlTGluZUVycm9yID0gInVua25vd246MDpFcnJvcjogSlNVVDsgJyIgKyBkZXNjcmlwdGlvbiArICInIEV2YWx1YXRpbmc7ICciICsgZXhwcl9zdHIgKyAiJyAiOwogICAgICAgICAgICBpZiAoIHVuY2F1Z2h0ICkgewogICAgICAgICAgICAgICAgLy8gcHJpbnRsbiggIldBUk5JTkchISEhISEhIFVOQ0FVR0hUIEVYQ0VQVElPTjogJyIgKyBlcnJvcnN0cmluZyArICInIiApOwogICAgICAgICAgICAgICAgLy8gc2luZ2xlTGluZUVycm9yICs9ICJVTkNBVUdIVCBFWENFUFRJT047ICciICsgZXJyb3JzdHJpbmcgKyAiJyI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gcHJpbnRsbiggIlRlc3QgbnVtYmVyICA6ICIgICsgKCB0ZXN0bnVtICkgKTsKICAgICAgICAgICAgLy8gcHJpbnRsbiggIkRlc2NyaXB0aW9uICA6ICciICsgZGVzY3JpcHRpb24gKyAiJyIgKTsKICAgICAgICAgICAgLy8gcHJpbnRsbiggIkV2YWx1YXRpbmcgICA6ICciICsgZXhwcl9zdHIgKyAiJyIgKTsKICAgICAgICAgICAgaWYgKCBleHBlY3RlZCAhPSB1bmRlZmluZWQgKSB7CiAgICAgICAgICAgICAgICAvLyBIYXZlIHRvIHdyYXAgdGhpcyBpbiB0cnktY2F0Y2gsIGFzIFJoaW5vIGJhcmZzIG9uIHRvU291cmNlIGZyb20gVmFsdWVDaGVjawogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBleHBlY3RlZCA9IGV4cGVjdGVkLnRvU291cmNlKCApOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoIGUgKSB7CiAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWQgPSBleHBlY3RlZC50b1N0cmluZyggKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIHJlcyAhPSB1bmRlZmluZWQgKSB7CiAgICAgICAgICAgICAgICAvLyBIYXZlIHRvIHdyYXAgdGhpcyBpbiB0cnktY2F0Y2gsIGFzIFJoaW5vIGJhcmZzIG9uIHRvU291cmNlIGZyb20gVmFsdWVDaGVjawogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICByZXMgPSByZXMudG9Tb3VyY2UoICk7CiAgICAgICAgICAgICAgICB9IGNhdGNoICggZSApIHsKICAgICAgICAgICAgICAgICAgICByZXMgPSByZXMudG9TdHJpbmcoICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9wcmludGxuKCAiRXhwZWN0aW5nICAgIDogJyIgKyBleHBlY3RlZCArICInICgiICsgdHlwZW9mZXhwZWN0ZWQgKyAiKSIgKTsKICAgICAgICAgICAgLy8gc2luZ2xlTGluZUVycm9yICs9ICJFeHBlY3Rpbmc7ICciICsgZXhwZWN0ZWQgKyAiJyAoIiArIHR5cGVvZmV4cGVjdGVkICsgIikgIjsKICAgICAgICAgICAgLy8gcHJpbnRsbiggIkV2YWx1YXRlZCB0byA6ICciICsgcmVzICsgIicgKCIgKyB0eXBlb2ZyZXMgKyAiKSIgKTsKICAgICAgICAgICAgLy8gc2luZ2xlTGluZUVycm9yICs9ICJFdmFsdWF0ZWQgdG87ICciICsgcmVzICsgIicgKCIgKyB0eXBlb2ZyZXMgKyAiKSAiOwoKICAgICAgICAgICAgaWYgKCBwYXNzZWQgKSB7CiAgICAgICAgICAgICAgICBtX3RvdGFsUGFzc2VkKys7CiAgICAgICAgICAgICAgICAvLyBwcmludGxuKCAiUmVzdWx0ICAgICAgIDogUEFTU0VEIiApOyAKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmICggdW5jYXVnaHQgKSB7CiAgICAgICAgICAgICAgICAgICAgcHJpbnRsbiggIldBUk5JTkchISEhISEhIFVOQ0FVR0hUIEVYQ0VQVElPTjogJyIgKyBlcnJvcnN0cmluZyArICInIiApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcHJpbnRsbiggIkV4cGVjdGluZyAgICA6ICciICsgZXhwZWN0ZWQgKyAiJyAoIiArIHR5cGVvZmV4cGVjdGVkICsgIikiICk7CiAgICAgICAgICAgICAgICBwcmludGxuKCAiRXZhbHVhdGVkIHRvIDogJyIgKyByZXMgKyAiJyAoIiArIHR5cGVvZnJlcyArICIpIiApOwogICAgICAgICAgICAgICAgLy8gcHJpbnRsbiggIlJlc3VsdCAgICAgICA6IEZBSUxFRCIgKTsKICAgICAgICAgICAgICAgIC8vIHByaW50bG4oIHNpbmdsZUxpbmVFcnJvciApOyAKICAgICAgICAgICAgICAgIG1fdG90YWxGYWlsZWQrKzsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBwcmludGxuKCAiPC90ZXN0Y2FzZT5cbiIgKTsKICAgICAgICAgICAgLy8gcHJpbnRsbiggIj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+IDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8IiApOwogICAgICAgICAgICAvLyBBZGQgaXQgdG8gdGhlIGxpc3Qgb2YgcmVwb3J0cwogICAgICAgICAgICBtX3JlcG9ydHMucHVzaCggQ3JlYXRlVGVzdGNhc2VPYmplY3QoIHsKICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyOiB0ZXN0bnVtLAogICAgICAgICAgICAgICAgICAgICAgICBwYXNzZWQ6IHBhc3NlZCwKICAgICAgICAgICAgICAgICAgICAgICAgZml4dHVyZTogdGhpcy5uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydDogcHJpbnRidWZmZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb246IGV4cHJfc3RyLAogICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWQsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZmV4cGVjdGVkOiB0eXBlb2ZleHBlY3RlZCwKICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiByZXMsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZnJlc3VsdDogdHlwZW9mcmVzLAogICAgICAgICAgICAgICAgICAgICAgICBzdGFjazogc3RhY2ssCiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWU6IHRpbWUsIAogICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGdldFVybEZvckxvYWRpbmdNb2R1bGUoKQogICAgICAgICAgICAgICAgICAgIH0gKSApOwogICAgICAgICAgICB0aGlzLkFjdGl2YXRlQXNzZXJ0T2JqZWN0KCApOwogICAgICAgICAgICB1dExvZyggIkFzc2VydCBsZWF2aW5nIGVxdWFsLCBkZXNjOiAiICsgZGVzY3JpcHRpb24gKTsKICAgICAgICAgICAgcmV0dXJuIHBhc3NlZDsKICAgICAgICB9OyAvLyBlcXVhbCBmdW5jdGlvbi4KCiAgICAgICAgLyoqCiAgICAgICAgICogVGVzdCB0aGF0IGFuIGV4cHJlc3Npb24gZXZhbHV0ZXMgdG8gdHJ1ZS4KICAgICAgICAgKiAKICAgICAgICAgKiBBcyBlcXVhbCwgYnV0IGFzc3VtZXMgdGhhdCB0aGUgcmVzdWx0IG11c3QgZXZhbHVhdGUgdG8gdHJ1ZSAKICAgICAgICAgKiAKICAgICAgICAgKiBAc3ludGF4IEFzc2VydC50aGF0KCBbZGVzY3JpcHRpb24sIF0sIGV4cHJlc3Npb24gKTsKICAgICAgICAgKiBAcGFyYW0gZGVzY3JpcHRpb24gT3B0aW9uYWwgcGFyYW1ldGVyLCB1c2VkIGZvciBmZWVkYmFjayBpbiBjYXNlIG9mIGVycm9ycwogICAgICAgICAqIEBwYXJhbSBleHByZXNzaW9uIFRoZSBleHByZXNzaW9uIHRvIGV2YWx1YXRlLiBUaGlzIG11c3QgYmUgYSBzdHJpbmcgdGhhdCBjYW4gYmUgZXZhbCwgb3IgdGhlIGZlZWRiYWNrIHdpbGwgYmUgbGVzcyB1c2VmdWwKICAgICAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIHRlc3QgcGFzc2VkLCBmYWxzZSBvdGhlcndpc2UKICAgICAgICAgKiBAbmFtZSBBc3NlcnQudGhhdAogICAgICAgICAqIEBtZXRob2QKICAgICAgICAgKi8KICAgICAgICB0aGF0LnRoYXQgPSBmdW5jdGlvbiggZGVzY3JpcHRpb24sIGV4cHIgKSB7CiAgICAgICAgICAgIGlmICggYXJndW1lbnRzLmxlbmd0aCA8IDIgKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lcXVhbCggZGVzY3JpcHRpb24sIHRydWUgKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVxdWFsKCBkZXNjcmlwdGlvbiwgZXhwciwgdHJ1ZSApOwogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgLyoqCiAgICAgICAgICogVGVzdCB0aGF0IGFuIGV4cHJlc3Npb24gZXZhbHV0ZXMgdG8gZmFsc2UuCiAgICAgICAgICogCiAgICAgICAgICogQXMgZXF1YWwsIGJ1dCBhc3N1bWVzIHRoYXQgdGhlIHJlc3VsdCBtdXN0IGV2YWx1YXRlIHRvIGZhbHNlIAogICAgICAgICAqIAogICAgICAgICAqIEBzeW50YXggQXNzZXJ0Lm5vdCggW2Rlc2NyaXB0aW9uLCBdLCBleHByZXNzaW9uICk7CiAgICAgICAgICogQHBhcmFtIGRlc2NyaXB0aW9uIE9wdGlvbmFsIHBhcmFtZXRlciwgdXNlZCBmb3IgZmVlZGJhY2sgaW4gY2FzZSBvZiBlcnJvcnMKICAgICAgICAgKiBAcGFyYW0gZXhwcmVzc2lvbiBUaGUgZXhwcmVzc2lvbiB0byBldmFsdWF0ZS4gVGhpcyBtdXN0IGJlIGEgc3RyaW5nIHRoYXQgY2FuIGJlIGV2YWwsIG9yIHRoZSBmZWVkYmFjayB3aWxsIGJlIGxlc3MgdXNlZnVsCiAgICAgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSB0ZXN0IHBhc3NlZCwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgICAgICogQG5hbWUgQXNzZXJ0Lm5vdAogICAgICAgICAqIEBtZXRob2QKICAgICAgICAgKi8KICAgICAgICB0aGF0Lm5vdCA9IGZ1bmN0aW9uKCBkZXNjcmlwdGlvbiwgZXhwciApIHsKICAgICAgICAgICAgaWYgKCBhcmd1bWVudHMubGVuZ3RoIDwgMiApIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVxdWFsKCBkZXNjcmlwdGlvbiwgZmFsc2UgKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVxdWFsKCBkZXNjcmlwdGlvbiwgZXhwciwgZmFsc2UgKTsKICAgICAgICAgICAgfQogICAgICAgIH07CgoKCiAgICAgICAgLy8gRnVuY3Rpb24gdGhhdCBleHBlY3RzIGFuIGV4Y2VwdGlvbgogICAgICAgIC8vIElmIGV4Y2VwdGlvbiBpcyBleHBlY3RlZCwgY2FsbCB3aXRoICd0cnVlJyBmb3IgbGFzdCBhcmd1bWVudCwgJ2ZhbHNlJyBlbHNlCiAgICAgICAgLyoqCiAgICAgICAgICogVGVzdCB0aGF0IGFuIGV4cHJlc3Npb24gdGhyb3dzIGFuIGV4Y2VwdGlvbiB3aGVuIGV2YWx1YXRlZC4KICAgICAgICAgKiAKICAgICAgICAgKiBUaGlzIHRlc3QgY2hlY2tzIHRoYXQgZXZhbHVhdGluZyB0aGUgZXhwcmVzc2lvbiByYWlzZXMgYW4gZXhjZXB0aW9uLiAKICAgICAgICAgKiAKICAgICAgICAgKiBAc3ludGF4IEFzc2VydC5leGNlcHRpb24oIFtkZXNjcmlwdGlvbiwgXSwgZXhwcmVzc2lvbiApOwogICAgICAgICAqIEBwYXJhbSBkZXNjcmlwdGlvbiBPcHRpb25hbCBwYXJhbWV0ZXIsIHVzZWQgZm9yIGZlZWRiYWNrIGluIGNhc2Ugb2YgZXJyb3JzLgogICAgICAgICAqIEBwYXJhbSBleHByZXNzaW9uIFRoZSBleHByZXNzaW9uIHRvIGV2YWx1YXRlLiBUaGlzIG11c3QgYmUgYSBzdHJpbmcgdGhhdCBjYW4gYmUgZXZhbCwgb3IgdGhlIGZlZWRiYWNrIHdpbGwgYmUgbGVzcyB1c2VmdWwKICAgICAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIHRlc3QgcGFzc2VkLCBmYWxzZSBvdGhlcndpc2UKICAgICAgICAgKiBAbmFtZSBBc3NlcnQuZXhjZXB0aW9uCiAgICAgICAgICogQG1ldGhvZAogICAgICAgICAqLwogICAgICAgIHRoYXQuZXhjZXB0aW9uID0gZnVuY3Rpb24oIGRlc2NyaXB0aW9uLCBleHByICkgewogICAgICAgICAgICBpZiAoIGFyZ3VtZW50cy5sZW5ndGggPCAyICkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGhhdCggJ1wKICAgICAgICAgICAgICAgICAgICB2YXIgY2F1Z2h0ID0gZmFsc2U7XAogICAgICAgICAgICAgICAgICAgIHRyeSB7XAogICAgICAgICAgICAgICAgICAgICAgICAnICsgZGVzY3JpcHRpb24gKyAnO1wKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICggZSApIHtcCiAgICAgICAgICAgICAgICAgICAgICAgIGNhdWdodCA9IHRydWU7XAogICAgICAgICAgICAgICAgICAgIH1cCiAgICAgICAgICAgICAgICAgICAgY2F1Z2h0JyApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGhhdCggZGVzY3JpcHRpb24sICdcCiAgICAgICAgICAgICAgICAgICAgdmFyIGNhdWdodCA9IGZhbHNlO1wKICAgICAgICAgICAgICAgICAgICB0cnkge1wKICAgICAgICAgICAgICAgICAgICAgICAgJyArIGV4cHIgKyAnO1wKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICggZSApIHtcCiAgICAgICAgICAgICAgICAgICAgICAgIGNhdWdodCA9IHRydWU7XAogICAgICAgICAgICAgICAgICAgIH1cCiAgICAgICAgICAgICAgICAgICAgY2F1Z2h0JyApOwogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgLy8gUmV0dXJuIGNyZWF0ZWQgb2JqZWN0CiAgICAgICAgcmV0dXJuIHRoYXQ7CiAgICB9CiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQmFjayB0byBVbml0VGVzdCBmdW5jdGlvbgoKICAgIC8vIFNob3VsZCB1c2VyIGNhbGwgcmVwb3J0PwogICAgdmFyIGlzTG9hZGluZ0FzTW9kdWxlID0gZnVuY3Rpb24oICkgewogICAgICAgIHJldHVybiBfX01vZHVsZXNJbmZvLmlzTG9hZGluZ01vZHVsZSggKTsKICAgIH07CgogICAgLyoqCiAgICAgKiBTaG91bGQgY2xpZW50cyBhY3R1YWxseSBwZXJmb3JtIHRlc3RzLgogICAgICogCiAgICAgKiBDbGllbnRzIGNhbiBjYWxsIHRoaXMgbWV0aG9kIHByaW9yIHRvIHBlcmZvcm1pbmcgdGVzdHMsIGFsdGhvdWdoIGlmCiAgICAgKiB1c2luZyBhZGRGaXh0dXJlLCB0aGlzIGlzIGhhbmRsZWQgYXV0b21hdGljYWxseS4gCiAgICAgKiAKICAgICAqIEB0eXBlIHttZXRob2R9CiAgICAgKiBAc3ludGF4IFVuaXRUZXN0LmRvVGVzdHMoKQogICAgICogQHJldHVybiB0cnVlIGlmIGNsaWVudHMgc2hvdWxkIHBlcmZvcm0gdGVzdHMsIGZhbHNlIG90aGVyd2lzZS4KICAgICAqIEBuYW1lIFVuaXRUZXN0LmRvVGVzdHMKICAgICAqIEBtZXRob2QKICAgICAqLwogICAgdGhhdC5kb1Rlc3RzID0gZnVuY3Rpb24oICkgewogICAgICAgIHJldHVybiAhaXNMb2FkaW5nQXNNb2R1bGUoICk7CiAgICB9OwoKICAgIC8qKgogICAgICogU2hvdWxkIGNsaWVudHMgZW1pdCBhIHJlcG9ydC4KICAgICAqIAogICAgICogQ2xpZW50cyBjYW4gY2FsbCB0aGlzIG1ldGhvZCBwcmlvciB0byBlbWl0dGluZyBhIHRlc3QgcmVwb3J0LiBUaGlzIGlzCiAgICAgKiBoYW5kbGVkIGF1dG9tYXRpY2FsbHkgaWYgdXNpbmcgYWRkRml4dHVyZS4gCiAgICAgKiAKICAgICAqIEB0eXBlIHttZXRob2R9CiAgICAgKiBAc3ludGF4IFVuaXRUZXN0LmVtaXRSZXBvcnQoKQogICAgICogQHJldHVybiB0cnVlIGlmIGNsaWVudHMgc2hvdWxkIGVtaXQgYSByZXBvcnQsIGZhbHNlIG90aGVyd2lzZQogICAgICogQG5hbWUgVW5pdFRlc3QuZW1pdFJlcG9ydAogICAgICogQG1ldGhvZAogICAgICovCiAgICB0aGF0LmVtaXRSZXBvcnQgPSBmdW5jdGlvbiggKSB7CiAgICAgICAgcmV0dXJuICFpc0xvYWRpbmdBc01vZHVsZSggKTsKICAgIH07CgogICAgdGhhdC52ZXJib3NlID0gZmFsc2U7IC8vIFNldCB0byB0cnVlIGZvciB2ZXJib3NlLCBmYWxzZSBvbmx5IG91dHB1dCBvbiBlcnJvcgoKICAgIHRoYXQub3V0cHV0WG1sID0gZmFsc2U7IC8vIFNldCB0byB0cnVlIHRvIGdldCBvdXRwdXQgaW4geG1sIGZvciBKVW5pdAoKICAgIC8vIFN0b3JlIGFsbCB0aGUgQXNzZXJ0IG9iamVjdHMgaW4gaGVyZS4gVGhlIGRlZmF1bHQgb25lIGlzIGluZGV4IDAKICAgIHZhciBtX2ZpeHR1cmVzID0gWyBdOwoKICAgIC8vIFN0YWNrIHRvIGhvbGQgcmVmZXJlbmNlcyB0byBleGlzdGluZyBzZXNzaW9ucwogICAgdmFyIG1fZml4dHVyZVN0YWNrID0gWyBdOwoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvKioKICAgICAqIEJlZ2luIGEgbmV3IHRlc3QgZml4dHVyZS4KICAgICAqIAogICAgICogQmVnaW4gYSBuZXcgdGV4dCBmaXh0dXJlLCB0aGF0IGlzLCBhIHNldCBvZiB0ZXN0Y2FzZXMgdGhhdCBsb2dpY2FsbHkKICAgICAqIGJlbG9uZ3MgdG9nZXRoZXIuIE5vdGUsIHRoYXQgeW91IGNhbiAibmVzdCIgZml4dHVyZXMuIElmIHlvdSBoYXZlIG5vdAogICAgICogZXhwbGljaXRlbHkgY3JlYXRlZCBhIHRlc3QgZml4dHVyZSwgeW91IHdpbGwgYmUgdXNpbmcgdGhlIGRlZmF1bHQKICAgICAqICJnbG9iYWwiIHRlc3QgZml4dHVyZS4gSXQgaXMgcmVjb21tZW5kZWQgdG8gdXNlIGFkZEZpeHR1cmUgdG8gbWFuYWdlCiAgICAgKiB5b3VyIHRlc3QgZml4dHVyZXMuIAogICAgICogCiAgICAgKiBAdHlwZSB7bWV0aG9kfQogICAgICogQHN5bnRheCBVbml0VGVzdC5iZWdpbkZpeHR1cmUoIG5hbWUgKQogICAgICogQHBhcmFtIG5hbWUgVGhlIG5hbWUgb2YgdGhlIHRlc3QgZml4dHVyZQogICAgICogQG5hbWUgVW5pdFRlc3QuYmVnaW5GaXh0dXJlCiAgICAgKiBAbWV0aG9kCiAgICAgKi8KICAgIHRoYXQuYmVnaW5GaXh0dXJlID0gZnVuY3Rpb24oIG5hbWUgKSB7CiAgICAgICAgdXRMb2coICJiZWdpbkZpeHR1cmU6ICIgKyBuYW1lICk7CiAgICAgICAgLy8gTm8gY2hlY2tpbmcKICAgICAgICBpZiAoIEFzc2VydCAhPT0gdW5kZWZpbmVkICkgewogICAgICAgICAgICBtX2ZpeHR1cmVTdGFjay5wdXNoKCBBc3NlcnQgKTsKICAgICAgICB9CiAgICAgICAgQXNzZXJ0ID0gQ3JlYXRlQXNzZXJ0T2JqZWN0KCBuYW1lICk7CiAgICAgICAgbV9maXh0dXJlcy5wdXNoKCBBc3NlcnQgKTsKICAgIH07CgogICAgLyoqCiAgICAgKiBFbmQgdGhlIGN1cnJlbnQgdGVzdCBmaXh0dXJlLgogICAgICogCiAgICAgKiBFbmRzIHRoZSBjdXJyZW50IHRlc3QgZml4dHVyZSwgYW5kIHJldHVybnMgdG8gdGhlIHByZXZpb3VzbHkgYWN0aXZlCiAgICAgKiB0ZXN0IGZpeHR1cmUuIFlvdSBkbyBub3QgbmVlZCB0byBjYWxsIHRoaXMgbWV0aG9kLCBpZiB1c2luZyBhZGRGaXh0dXJlLiAKICAgICAqIAogICAgICogQHR5cGUge21ldGhvZH0KICAgICAqIEBzeW50YXggVW5pdFRlc3QuZW5kRml4dHVyZSgpCiAgICAgKiBAbmFtZSBVbml0VGVzdC5lbmRGaXh0dXJlCiAgICAgKiBAbWV0aG9kCiAgICAgKi8KICAgIHRoYXQuZW5kRml4dHVyZSA9IGZ1bmN0aW9uKCApIHsKICAgICAgICB1dExvZyggImVuZEZpeHR1cmUiICk7CiAgICAgICAgQXNzZXJ0ID0gbV9maXh0dXJlU3RhY2sucG9wKCApOwogICAgICAgIGlmICggQXNzZXJ0ICE9PSB1bmRlZmluZWQgKSB7CiAgICAgICAgICAgIEFzc2VydC5BY3RpdmF0ZUFzc2VydE9iamVjdCggKQogICAgICAgIH0KICAgIH07CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgZml4dHVyZSBhbmQgb3B0aW9uYWxseSBydW4gaXQuCiAgICAgKiAKICAgICAqIFRoaXMgaXMgdGhlIG1haW4gbWV0aG9kIHRvIHVzZSB0byBjcmVhdGUgYSB0ZXN0IGZpeHR1cmUgYW5kIGhhdmUgaXQKICAgICAqIGF1dG9tYXRpY2FsbHkgcnVuIGFuZCByZXBvcnQgYXMgbmVlZGVkLiAKICAgICAqIAogICAgICogQHR5cGUge21ldGhvZH0KICAgICAqIEBzeW50YXggVW5pdFRlc3QuYWRkRml4dHVyZSggbmFtZSwgZnVuYyApCiAgICAgKiBAcGFyYW0gbmFtZSBUaGUgbmFtZSBvZiB0aGUgdGVzdGZpeHR1cmUuIFVzZSBzb21ldGhpbmcgdGhhdCBpZGVudGlmaWVzIHRoZSBtb2R1bGUgb3Igc2V0IG9mIHRlc3RzCiAgICAgKiBAcGFyYW0gZnVuYyBBIGZ1bmN0aW9uIHRoYXQgaGFzIHRoZSBhY3R1YWwgdGVzdHMgKEFzc2VydHMpIGluIGl0CiAgICAgKiBAcmV0dXJuIFRoZSBudW1iZXIgb2YgZmFpbGVkIHRlc3RzLCBpZiBhbnkgd2FzIHJ1biwgMCBvdGhlcndpc2UgKGFsc28gMCBpZiBubyB0ZXN0cyBmYWlsZWQpLgogICAgICogQGV4YW1wbGUgVXNlIGl0IGxpa2UgdGhpczoKICAgICAqICAgVW5pdFRlc3QuYWRkRml4dHVyZSggIlRlc3QgTW9kdWxlIG1vZHVsZW5hbWUiLCBmdW5jdGlvbigpIHsgCiAgICAgKiAKICAgICAqICAgICBBc3NlcnQuZXhjZXB0aW9uKCAicmVhZEZpbGUgb24gbm9uIGV4aXN0YW50IGZpbGUiLCAncmVhZEZpbGUoIm5vdGhlcmUiKScgKTsgCiAgICAgKiAgICAgQXNzZXJ0LnRoYXQoICJjb21tZW50IiwgJ2V4cHJlc3Npb24gZXZhbHVhdGluZyB0byB0cnVlJyApOwogICAgICogICAgIEFzc2VydC5ub3QoICJUaGlzIHNob3VsZCBhbHdheXMgYmUgZmFsc2UiLCAnZXhwcmVzc2lvbiBldmFsdWF0aW5nIHRvIGZhbHNlJyApOwogICAgICogICAgIEFzc2VydC5lcXVhbCggInRlc3QwLCBvdXRwdXQiLCAndGVzdDAoKScsICJVc2VyUGFyYW0gd2FzIDAiICk7CiAgICAgKiAgICAgQXNzZXJ0LmVxdWFsKCAidGVzdDEsIGFycmF5IG91dHB1dCIsICd0ZXN0MSgpLnNvcnQoKScsIFsxLDIsMyw0XSApOwogICAgICogICAgIAogICAgICogICB9KTsKICAgICAqIEBuYW1lIFVuaXRUZXN0LmFkZEZpeHR1cmUKICAgICAqIEBtZXRob2QKICAgICAqLwogICAgdGhhdC5hZGRGaXh0dXJlID0gZnVuY3Rpb24oIG5hbWUsIGZ1bmMgKSB7CiAgICAgICAgdmFyIHJlcyA9IDA7CiAgICAgICAgaWYgKCB0aGlzLmRvVGVzdHMoICkgKSB7CiAgICAgICAgICAgIHRoaXMuYmVnaW5GaXh0dXJlKCBuYW1lICk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBmdW5jKCApOwogICAgICAgICAgICB9IGNhdGNoICggZSApIHsKICAgICAgICAgICAgICAgIC8vIFVwcywgbGVha2VkIGV4cGVjdGlvbiwgc3R1ZmYgaXQgaW50byB0aGUgdW5pdHRlc3Qgc3lzdGVtCiAgICAgICAgICAgICAgICBfX1VuaXRUZXN0X191dF9lID0gZTsKICAgICAgICAgICAgICAgIEFzc2VydC5lcXVhbCggIlRoZSB0ZXN0IGZpeHR1cmUgdGhyZXcgYW4gdW5leHBlY3RlZCBhbmQgdW5oYW5kbGVkIGV4Y2VwdGlvbiBvdXRzaWRlIGFuIEFzc2VydC4iLCAidGhyb3cgX19Vbml0VGVzdF9fdXRfZTsiLCAiRXhwZWN0ZWQgbm8gZXhjZXB0aW9ucyB0byBiZSB0aHJvd24uIiApOwogICAgICAgICAgICAgICAgZGVsZXRlIF9fVW5pdFRlc3RfX3V0X2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVzID0gQXNzZXJ0LnRvdGFsRmFpbGVkKCApOwogICAgICAgICAgICB0aGlzLmVuZEZpeHR1cmUoICk7CiAgICAgICAgICAgIC8vIE9ubHkgYXV0by1lbWl0IHJlcG9ydCwgaWYgd2UgYXJlIG5vdCBuZXN0ZWQgImJleW9uZCIgdGhlIEdsb2JhbCBkZWZhdWx0IGZpeHR1cmUuCiAgICAgICAgICAgIGlmICggdGhpcy5lbWl0UmVwb3J0KCApICYmIG1fZml4dHVyZVN0YWNrLmxlbmd0aCA8PSAxICkgewogICAgICAgICAgICAgICAgdXNlKCAiUHJpbnQiICk7CiAgICAgICAgICAgICAgICAvLyBwcmludCAoIHRoaXMucmVwb3J0SlVuaXRYbWwoKSArICJcbiIgKTsKICAgICAgICAgICAgICAgIHByaW50KCB0aGlzLnJlcG9ydCggKSArICJcbiIgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzOwogICAgfTsKCgogICAgdmFyIG1fcHJpbnRidWZmZXIgPSAiIjsKCiAgICBmdW5jdGlvbiBwcmludGxuKCBhcmcgKSB7CiAgICAgICAgbV9wcmludGJ1ZmZlciArPSBhcmcgKyAiXG4iOwogICAgfQoKCiAgICAvKioKICAgICAqIEJ1aWxkIGEgcmVwb3J0IG9mIGFsbCB0ZXN0IGZpeHR1cmVzIGFuZCBhbGwgdGVzdCBjYXNlcy4uCiAgICAgKiAKICAgICAqIFRoaXMgYnVpbGRzIGEgcmVwb3J0IG9mIGFsbCBleGVjdXRlZCB0ZXN0IGZpeHR1cmVzLCB3aXRoIGFsbCB0ZXN0CiAgICAgKiBjYXNlcy4gVGhlIHJlcG9ydCBpcyBhIHN0cmluZywgc3VpdGFibGUgZm9yIG91dHB1dHRpbmcgdG8gYSBjb25zb2xlIG9yCiAgICAgKiBzaW1pbGFyLiBCeSBkZWZhdWx0LCB5b3UgZ2V0IGEgc3VtbWFyeSBhbmQgYSByZXBvcnQgZm9yIGVhY2ggZmFpbGVkCiAgICAgKiB0ZXN0LiBZb3UgY2FuIGNvbnRyb2wgdGhlIGxldmVsIG9mIHZlcmJvc2l0eSB3aXRoIHRoZSB2YXJpYWJsZSB2ZXJib3NlOwogICAgICogaWYgc2V0IHRvIHRydWUsIGFsc28gbm9uLWZhaWxlZCB0ZXN0cyBhcmUgb3V0cHV0LiAKICAgICAqIAogICAgICogQHR5cGUge21ldGhvZH0KICAgICAqIEBzeW50YXggVW5pdFRlc3QucmVwb3J0KCkKICAgICAqIEByZXR1cm4gQSBzdHJpbmcgd2l0aCBhIHRlc3QgcmVwb3J0LCBzdWl0YWJsZSBmb3IgcHJpbnRpbmcKICAgICAqIEBuYW1lIFVuaXRUZXN0LnJlcG9ydFN0cmluZwogICAgICogQG1ldGhvZAogICAgICovCiAgICB0aGF0LnJlcG9ydFN0cmluZyA9IGZ1bmN0aW9uKCApIHsKICAgICAgICB2YXIgdG90YWxQYXNzZWQgPSAwOwogICAgICAgIHZhciB0b3RhbEZhaWxlZCA9IDA7CiAgICAgICAgbV9wcmludGJ1ZmZlciA9ICIiOwoKICAgICAgICAvLyBSZXBvcnQgaXMgc3BsaXR0ZWQgaW4gdHdvLCBmaXJzdCB0aGUgb3ZlcnZpZXcsIHRoZW4gdGhlIHN1bW1hcnkKICAgICAgICB2YXIgZGV0YWlscyA9ICIiOwogICAgICAgIGZvciAoIHZhciB4IGluIG1fZml4dHVyZXMgKSB7CiAgICAgICAgICAgIGRldGFpbHMgKz0gbV9maXh0dXJlc1sgeCBdLnJlcG9ydCggdGhpcy52ZXJib3NlICk7CiAgICAgICAgfQogICAgICAgIGlmICggZGV0YWlscyAhPT0gIiIgKSB7CiAgICAgICAgICAgIHByaW50bG4oICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IERFVEFJTFMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIgKTsKICAgICAgICAgICAgcHJpbnRsbiggZGV0YWlscyApOwogICAgICAgIH0KCiAgICAgICAgLy8gcHJpbnRsbiggIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gU1VNTUFSWSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IiApOwogICAgICAgIHZhciBjb3VudF9maXh0dXJlcyA9IDA7CiAgICAgICAgZm9yICggeCBpbiBtX2ZpeHR1cmVzICkgewogICAgICAgICAgICB2YXIgc2VzID0gbV9maXh0dXJlc1sgeCBdOwoKICAgICAgICAgICAgLy8gU2tpcCBkZWZhdWx0IGdsb2JhbCBmaXh0dXJlLCBpZiBubyB0ZXN0cyB3YXMgYWN0dWFsbHkgZG9uZSB1bmRlciB0aGlzIGZpeHR1cmUgKGJ1ZyA4OTY5KQogICAgICAgICAgICBpZiAoIHggPT09ICIwIiAmJiBzZXMudG90YWxQYXNzZWQoICkgPT09IDAgJiYgc2VzLnRvdGFsRmFpbGVkKCApID09PSAwICkgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY291bnRfZml4dHVyZXMgKz0gMTsKCiAgICAgICAgICAgIHRvdGFsUGFzc2VkICs9IHNlcy50b3RhbFBhc3NlZCggKTsKICAgICAgICAgICAgdG90YWxGYWlsZWQgKz0gc2VzLnRvdGFsRmFpbGVkKCApOwoKICAgICAgICAgICAgaWYgKCB0aGlzLnZlcmJvc2UgfHwgc2VzLnRvdGFsRmFpbGVkKCApID4gMCApIHsKICAgICAgICAgICAgICAgIHByaW50bG4oICItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIgKTsKICAgICAgICAgICAgICAgIHByaW50bG4oICJGaXh0dXJlOiAiICsgc2VzLm5hbWUgKTsKICAgICAgICAgICAgICAgIHZhciBmaXh0b3RhbCA9IHNlcy50b3RhbFBhc3NlZCggKSArIHNlcy50b3RhbEZhaWxlZCggKTsKICAgICAgICAgICAgICAgIHByaW50bG4oICJSZXN1bHQgOiAiICsgc2VzLnRvdGFsUGFzc2VkKCApICsgIiAvICIgKyBmaXh0b3RhbCArICIgcGFzc2VkICgiICsKICAgICAgICAgICAgICAgICAgICBzZXMudG90YWxQYXNzZWQoICkgLyBmaXh0b3RhbCAqIDEwMCArICIgJSkuIiApOwogICAgICAgICAgICAgICAgaWYgKCBzZXMudG90YWxGYWlsZWQoICkgPiAwICkgewogICAgICAgICAgICAgICAgICAgIHByaW50bG4oICJGYWlsZWQjOiAiICsgc2VzLmZhaWxlZCggKS5qb2luKCAiLCAiICkgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gUHJpbnQgc29tZSBpbmZvIGFib3V0IHRvdGFscwogICAgICAgIGlmICggY291bnRfZml4dHVyZXMgPiAwICkgewogICAgICAgICAgICBwcmludGxuKCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iICk7CiAgICAgICAgICAgIHByaW50bG4oICJUb3RhbHMgZm9yIGFsbCAiICsgY291bnRfZml4dHVyZXMgKyAiIGZpeHR1cmVzIGluIHRlc3QiICk7CiAgICAgICAgICAgIHZhciBzZXN0b3RhbCA9IHRvdGFsUGFzc2VkICsgdG90YWxGYWlsZWQ7CiAgICAgICAgICAgIHByaW50bG4oICJSZXN1bHQgOiAiICsgdG90YWxQYXNzZWQgKyAiIC8gIiArIHNlc3RvdGFsICsgIiBwYXNzZWQgKCIgKwogICAgICAgICAgICAgICAgdG90YWxQYXNzZWQgLyBzZXN0b3RhbCAqIDEwMCArICIgJSkuIiApOwogICAgICAgICAgICBwcmludGxuKCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iICk7CiAgICAgICAgfQogICAgICAgIGlmICggdG90YWxGYWlsZWQgIT09IDAgKSB7CiAgICAgICAgICAgIHByaW50bG4oICIhISEhISEhISEhIEZBSUxVUkVTIFdFUkUgUFJFU0VOVCAhISEhISEhISEhIiApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICggdG90YWxQYXNzZWQgPiAwICkgewogICAgICAgICAgICAgICAgcHJpbnRsbiggIkFsbCB0ZXN0cyBwYXNzZWQiICk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG1fcHJpbnRidWZmZXI7CiAgICB9OwoKICAgIHRoYXQucmVwb3J0SlVuaXRYbWwgPSBmdW5jdGlvbiggKSB7CiAgICAgICAgdmFyIHJlcyA9ICI8dGVzdHN1aXRlIHRlc3RzPVwiIiArIG1fZml4dHVyZXMubGVuZ3RoICsgIlwiPlxuIjsKICAgICAgICBmb3IgKCB2YXIgeCBpbiBtX2ZpeHR1cmVzICkgewogICAgICAgICAgICByZXMgKz0gbV9maXh0dXJlc1sgeCBdLnJlcG9ydEpVbml0WG1sKCApOwogICAgICAgIH0KICAgICAgICByZXMgKz0gIjwvdGVzdHN1aXRlPlxuIjsKICAgICAgICByZXR1cm4gcmVzOwogICAgfTsKCiAgICB0aGF0LnJlcG9ydCA9IGZ1bmN0aW9uKCApIHsKICAgICAgICBpZiAoIHRoaXMub3V0cHV0WG1sICkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5yZXBvcnRKVW5pdFhtbCggKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gdGhpcy5yZXBvcnRTdHJpbmcoICk7CiAgICAgICAgfQogICAgfQoKCgogICAgdGhhdC50b3RhbEZhaWxlZCA9IGZ1bmN0aW9uKCApIHsKICAgICAgICB2YXIgcmVzID0gMDsKICAgICAgICBmb3IgKCB2YXIgeCBpbiBtX2ZpeHR1cmVzICkgewogICAgICAgICAgICByZXMgKz0gbV9maXh0dXJlc1sgeCBdLnRvdGFsRmFpbGVkKCApOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzOwogICAgfTsKCiAgICByZXR1cm4gdGhhdDsKfSggKTsKCi8vIEFkZCBhIGRlZmF1bHQgZ2xvYmFsIEFzc2VydCBvYmplY3QKVW5pdFRlc3QuYmVnaW5GaXh0dXJlKCAiRGVmYXVsdCBnbG9iYWwgZml4dHVyZSIgKTsK", "moduleName": "UnitTest"}, {"javascript": "LyoqIEBmaWxlIFZhcmlvdXMgdXRpbGl0aWVzICovCgpFWFBPUlRFRF9TWU1CT0xTID0gWyAnVXRpbCcgXTsKdXNlKCAiVW5kZXJzY29yZSIgKTsKCi8qKgogKiBWYXJpb3VzIHV0aWxpdGllcy4KICogCiAqIFZhcmlvdXMgdXRpbGl0aWVzLCBtb3N0bHkgcmVsYXRlZCB0byBvYmplY3RzLgogKiAKICogQG5hbWUgVXRpbAogKiBAbmFtZXNwYWNlIAogKi8KdmFyIFV0aWwgPSBmdW5jdGlvbiggKSB7CgogICAgLyoqCiAgICAgKiBBZGQgYW4gb2JqZWN0IHRvIGFuIGFycmF5LCBpZiB0aGUgb2JqZWN0IGlzIG5vdCBhbHJlYWR5IGluIHRoZSBhcnJheQogICAgICogCiAgICAgKiBAdHlwZSB7ZnVuY3Rpb259CiAgICAgKiBAc3ludGF4IFV0aWwuYWRkVW5pcXVlT2JqZWN0VG9BcnJheSggYXJyYXksIG9iaiApOwogICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgQW4gYXJyYXkgb2Ygb2JqZWN0cyB0byBwdXNoIGFuIHVuaXF1ZSBvYmplY3QgdG8uCiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gcHVzaCB0byB0aGUgYXJyYXkuCiAgICAgKiBAcmV0dXJuIHtBcnJheSB9IHRoZSB1cGRhdGVkIGFycmF5LgogICAgICogQG5hbWUgVXRpbC5hZGRVbmlxdWVPYmplY3RUb0FycmF5CiAgICAgKiBAZXhhbXBsZSBVdGlsLmFkZFVuaXF1ZU9iamVjdFRvQXJyYXkoIFt7ICJmaXJzdE5hbWUiOiAiSGFucyIsICJmYW1pbHlOYW1lIjogIkplbnNlbiIgfSwgeyAiZmlyc3ROYW1lIjogIkplbnMiLCAiZmFtaWx5TmFtZSI6ICJIYW5zZW4ifSwgeyAiZmlyc3ROYW1lIjogIkplbnMiLCAiZmFtaWx5TmFtZSI6ICJKZW5zZW4iIH1dLCB7ICJmaXJzdE5hbWUiOiAiSGFucyIsImZhbWlseU5hbWUiOiAiSGFuc2VuIiB9ICk7IAogICAgICogLy9yZXR1cm5zIFt7ICJmaXJzdE5hbWUiOiAiSGFucyIsICJmYW1pbHlOYW1lIjogIkplbnNlbiIgfSwgeyAiZmlyc3ROYW1lIjogIkplbnMiLCAiZmFtaWx5TmFtZSI6ICJIYW5zZW4iIH0sIHsgImZpcnN0TmFtZSI6ICJKZW5zIiwgImZhbWlseU5hbWUiOiAiSmVuc2VuIiB9LCB7ICJmaXJzdE5hbWUiOiAiSGFucyIsImZhbWlseU5hbWUiOiAiSGFuc2VuIiB9IF0KICAgICAqIAogICAgICogQG1ldGhvZCAKICAgICAqLwoKICAgIGZ1bmN0aW9uIGFkZFVuaXF1ZU9iamVjdFRvQXJyYXkoIGFycmF5LCBvYmogKSB7CgogICAgICAgIHZhciBpc1VuaXF1ZSA9IHRydWU7CiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKysgKSB7CiAgICAgICAgICAgIGlmICggMCA9PT0gYXJyYXkubGVuZ3RoIHx8IHRydWUgPT09IF8uaXNFcXVhbCggYXJyYXlbIGkgXSwgb2JqICkgKSB7CiAgICAgICAgICAgICAgICB2YXIgaXNVbmlxdWUgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICggdHJ1ZSA9PT0gaXNVbmlxdWUgKSB7CiAgICAgICAgICAgIGFycmF5LnB1c2goIG9iaiApOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYXJyYXk7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgdGhlIGtleXMgZnJvbSBhbiBvYmplY3QgYXMgYW4gYXJyYXkuCiAgICAgKiAKICAgICAqIEdldCBhbiBhcnJheSBvZiBrZXlzIG9mIHRoZSBvYmplY3QsIHVzaW5nIHNvbWUgdHJpY2tzIGZyb20gdGhlIGJhZyBvZgogICAgICogUkpFIAogICAgICogCiAgICAgKiBAdHlwZSB7ZnVuY3Rpb259CiAgICAgKiBAc3ludGF4IFV0aWwuYXJyYXlPZktleXMob2JqKTsKICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBnZXQgdGhlIGtleXMgZm9yLgogICAgICogQHJldHVybiB7b2JqZWN0W119IFJldHVybnMgYSBuZXcgYXJyYXkgY29udGFpbmluZyBhbGwgdGhlIGtleXMgb2Ygb2JqLgogICAgICogQG5hbWUgVXRpbC5hcnJheU9mS2V5cwogICAgICogQGV4YW1wbGUKICAgICAqIFV0aWwuYXJyYXlPZktleXMoIHsgJ2VsZW1lbnROYW1lJzogJ3RpdGxlJywgJ2VsZW1lbnRWYWx1ZSc6ICdEZW4gZ2FtbGUgbWFuZCBvZyBoYXZldCcgfSApLAogICAgICogLy9yZXR1cm5zIFsgImVsZW1lbnROYW1lIiwgImVsZW1lbnRWYWx1ZSIgXQogICAgICogIAogICAgICogQG1ldGhvZCAqLwoKICAgIGZ1bmN0aW9uIGFycmF5T2ZLZXlzKCBvYmogKSB7CgogICAgICAgIHZhciByZXN1bHQgPSBbIF07CiAgICAgICAgZm9yICggdmFyIGVsZW0gaW4gb2JqICkKICAgICAgICAgICAgaWYgKCBvYmouaGFzT3duUHJvcGVydHkoIGVsZW0gKSApIHsKICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKCBlbGVtICk7CiAgICAgICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIG9iamVjdCB0aGF0IGhhcyB0aGUgYXJndW1lbnQgYXMgcHJvdG90eXBlCiAgICAgKiAKICAgICAqIFNlZSBDcm9ja2ZvcmQgcGFnZSAyMi4gSW4gc29tZSBvZiBDcm9ja2ZvcmRzIG5vdGVzLCB0aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCAKICAgICAqICJiZWdldCIuIFRoaXMgd2lsbCBiZWNvbWUgT2JqZWN0LmNyZWF0ZSBpbiBFUzUuCiAgICAgKiAgCiAgICAgKiBAdHlwZSB7ZnVuY3Rpb259CiAgICAgKiBAc3ludGF4IFV0aWwua2V5U29ydGVkT2JqZWN0KCBwcm90b3R5cGVfb2JqZWN0ICk7CiAgICAgKiBAcGFyYW0ge09iamVjdH0gCiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IAogICAgICogQG5hbWUgVXRpbC5jcmVhdGUKICAgICAqIEBtZXRob2QgKi8KCiAgICBmdW5jdGlvbiBjcmVhdGUoIHByb3RvdHlwZV9vYmplY3QgKSB7CiAgICAgICAgdmFyIEYgPSBmdW5jdGlvbiggKSB7fTsKICAgICAgICBGLnByb3RvdHlwZSA9IHByb3RvdHlwZV9vYmplY3Q7CiAgICAgICAgcmV0dXJuIG5ldyBGKCApOwogICAgfQoKICAgIC8qKgogICAgICogTWFwIGEgZnVuY3Rpb24gYWNyb3NzIHRoZSBtYXRjaGVzIG9mIGEgUmVnRXhwLiAKICAgICAqCiAgICAgKiAqKlRPRE86KiogUkpFIG5lZWRzIHRvIGRvY3VtZW50IHRoaXMsIGFuZCBnaXZlIGF0IGxlYXN0IG9uZSBleGFtcGxlIG9uIGhvdyB0byB1c2UgaXQuCiAgICAgKgogICAgICogQHR5cGUge2Z1bmN0aW9ufQogICAgICogQG1ldGhvZAogICAgICogQHBhcmFtIHtzdHJpbmd9IHN0ciBUaGUgc3RyaW5nIHRvIHNlYXJjaCBmb3IgbWF0Y2hlcy4KICAgICAqIEBwYXJhbSB7UmVnRXhwfSByZSBSZWd1bGFyIGV4cHJlc3Npb24gdG8gbWF0Y2ggYWdhaW5zdC4KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGZuIEZ1bmN0aW9uIHRvIG1hcCwgdGhpcyBnZXRzIHRoZSBtYXRjaGVkIHJlZ2V4LWdyb3VwcyBhcyBwYXJhbWV0ZXJzICh0aGUgZnVsbCBtYXRjaCBhcyB0aGUgZmlyc3Qgb2YgdGhlbSkuCiAgICAgKiBAbmFtZSBVdGlsLmZvckVhY2hHcm91cGVkUmVnRXhwTWF0Y2gKICAgICAqLwoKICAgIGZ1bmN0aW9uIGZvckVhY2hHcm91cGVkUmVnRXhwTWF0Y2goIHN0ciwgcmUsIGZuICkgewogICAgICAgIC8vIEphdmFTY3JpcHQgcXVpcmNrOiB0aGUgZWFzaWVzdCB3YXkgdG8gbWFwIGEgZnVuY3Rpb24gYWNyb3NzIHRoZSBfZ3JvdXBzXyBvZiB0aGUgbWF0Y2hlcyBvZiBhIHJlZ2V4IGlzIHRvIGNhbGwgcmVwbGFjZSBhbmQgdGhyb3cgdGhlIHJlc3VsdCBhd2F5LiAKICAgICAgICBzdHIucmVwbGFjZSggcmUsIGZuICk7CiAgICB9CgoKCiAgICAvKioKICAgICAqIEdldCB0aGUgdHlwZSBvZiBhbiBvYmplY3QuCiAgICAgKiAKICAgICAqIEdldCB0aGUgdHlwZSBvZiBhbiBvYmplY3QsIHVzaW5nIHNvbWUgdHJpY2tzIGZyb20gdGhlIGJhZyBvZiBSSkUuLi4KICAgICAqIAogICAgICogQHR5cGUge2Z1bmN0aW9ufQogICAgICogQHN5bnRheCBVdGlsLmdldFR5cGUob2JqKTsKICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBnZXQgdGhlIHR5cGUgZm9yLgogICAgICogQHJldHVybiB7c3RyaW5nfSB0eXBlb2Ygb2JqLCBvciBuYW1lIG9mIG9iai5jb25zdHJ1Y3RvciBpZiBhdmFpbGFibGUuCiAgICAgKiBAbmFtZSBVdGlsLmdldFR5cGUKICAgICAqIEBtZXRob2QKICAgICAqLwoKICAgIGZ1bmN0aW9uIGdldFR5cGUoIG9iaiApIHsKCiAgICAgICAgdmFyIHR5cGUgPSB0eXBlb2YoIG9iaiApOwogICAgICAgIGlmICggdHlwZSA9PT0gIm9iamVjdCIgJiYgb2JqICE9PSBudWxsICYmIG9iai5jb25zdHJ1Y3RvciApIHsKICAgICAgICAgICAgdmFyIG1hdGNoID0gUmVnRXhwKCAiZnVuY3Rpb24gKFteKF1bXihdKikiICkoIG9iai5jb25zdHJ1Y3Rvci50b1NvdXJjZSggKSApOwogICAgICAgICAgICBpZiAoIG1hdGNoICYmIG1hdGNoLmxlbmd0aCA9PSAyICkgewogICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoWyAxIF07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHR5cGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcmUgdHdvIG9iamVjdHMgdGhlIHNhbWUuCiAgICAgKiAKICAgICAqIENvbXBhcmVzIHR3byBvYmplY3RzIHRvIGRldGVybWluZSBpZiB0aGV5IGFyZSBlcXVhbC4KICAgICAqIAogICAgICogQHR5cGUge2Z1bmN0aW9ufQogICAgICogQHN5bnRheCBVdGlsLmlzRXF1YWwob2JqZWN0MSwgb2JqZWN0MikKICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvYmplY3QxIFRoZSBmaXJzdCBvYmplY3QgZm9yIHRoZSBjb21wYXJpc29uIHRlc3QKICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvYmplY3QyIFRoZSBzZWNvbmQgb2JqZWN0IGZvciB0aGUgY29tcGFyaXNvbiB0ZXN0CiAgICAgKiBAcmV0dXJuIHtib29sZWFufSB0cnVlIGlmIHRoZSB0d28gb2JqZWN0cyBhcmUgZXF1YWwsIG90aGVyd2lzZSBmYWxzZQogICAgICogQG5hbWUgVXRpbC5pc0VxdWFsCiAgICAgKiBAZXhhbXBsZQogICAgICogVXRpbC5pc0VxdWFsKCB7IGVsZW1lbnROYW1lOiAndGl0bGUnLCBlbGVtZW50VmFsdWU6ICdEZW4gZ2FtbGUgbWFuZCBvZyBoYXZldCcgfSwgeyBlbGVtZW50TmFtZTogJ3RpdGxlJywgZWxlbWVudFZhbHVlOiAnRGVuIGdhbWxlIG1hbmQgb2cgaGF2ZXQnIH0gKQogICAgICogLy9yZXR1cm5zIHRydWUKICAgICAqIAogICAgICogVXRpbC5pc0VxdWFsKCB7IGVsZW1lbnRWYWx1ZTogJ0RlbiBnYW1sZSBtYW5kIG9nIGhhdmV0JywgZWxlbWVudE5hbWU6ICd0aXRsZScgfSwgeyBlbGVtZW50TmFtZTogJ3RpdGxlJywgZWxlbWVudFZhbHVlOiAnRGVuIGdhbWxlIG1hbmQgb2cgaGF2ZXQnIH0gKQogICAgICogLy9yZXR1cm5zIHRydWUKICAgICAqIAogICAgICogVXRpbC5pc0VxdWFsKCB7IGVsZW1lbnROYW1lOiAndGl0bGUnLCBlbGVtZW50VmFsdWU6ICdEZW4gZ2FtbGUgbWFuZCBvZyBoYXZldCcgfSwgeyBlbGVtZW50TmFtZTogJ3RpdGxlJywgZWxlbWVudFZhbHVlOiAnRGVuIGdhbWxlIG1hbmQgb2cgaGF2ZXQnLCBlbGVtZW50UHJvcGVydHk6ICJmdWxsIiB9ICkKICAgICAqIC8vcmV0dXJucyBmYWxzZQogICAgICogCiAgICAgKiBAbWV0aG9kICovCgogICAgZnVuY3Rpb24gaXNFcXVhbCggb2JqZWN0MSwgb2JqZWN0MiApIHsKCiAgICAgICAgcmV0dXJuIF8uaXNFcXVhbCggb2JqZWN0MSwgb2JqZWN0MiApOwoKICAgIH0KCgoKICAgIC8qKgogICAgICogSXMgdGhpcyBhbiBvYmplY3QuIERvIG5vdCB1c2UgdGhpcyBmdW5jdGlvbiBpbiBuZXcgY29kZS4KICAgICAqIAogICAgICogRmlndXJlcyBvdXQgaWYgdGhpcyBpcyBhbiBvYmplY3QsIHVzaW5nIHNvbWUgdHJpY2tzIGZyb20gdGhlIGJhZyBvZiBSSkUuCiAgICAgKiAKICAgICAqIEB0eXBlIHtmdW5jdGlvbn0KICAgICAqIEBzeW50YXggVXRpbC5pc09iamVjdChvYmopOwogICAgICogQHBhcmFtIHtvYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIHRlc3QgZm9yIGJlZWluZyBhbiBvYmplY3QuCiAgICAgKiBAcmV0dXJuIHtib29sZWFufSB0cnVlIGlmIG9iaiBpcyBhbiBvYmplY3QgKG5vdCBudWxsIG9yIGFycmF5KQogICAgICogQG5hbWUgVXRpbC5pc09iamVjdAogICAgICogQG1ldGhvZCAqLwoKICAgIGZ1bmN0aW9uIGlzT2JqZWN0KCBvYmogKSB7CiAgICAgICAgdGhyb3cgImRlcHJlY2F0ZWQiOyAvL1RoaXMgaXMgcHJvYmFibHkgaW5zZXJ0ZWQgdG8gcHJldmVudCBhbnkgdXNlIG9mIHRoZSBmdW5jdGlvbgogICAgICAgIHJldHVybiBvYmogIT0gbnVsbCAmJiB0eXBlb2YoIG9iaiApID09PSAib2JqZWN0IiAmJiAhKCBvYmogaW5zdGFuY2VvZiBBcnJheSApICYmICEoIG9iaiBpbnN0YW5jZW9mIERhdGUgKTsKICAgIH0KCiAgICAvKioKICAgICAqIEdldCBhIG5ldyBvYmplY3Qgd2l0aCBzb3J0ZWQga2V5cy4KICAgICAqIAogICAgICogR2V0IGEgbmV3IG9iamVjdCB3aXRoIHRoZSBzYW1lIGtleXMvdmFsdWVzIGFzIHRoZSBvYmosIGJ1dCBpbnNlcnRlZCBpbgogICAgICogYWxwaGFiZXRpY2FsIG9yZGVyLCB1c2luZyBzb21lIHRyaWNrcyBmcm9tIHRoZSBiYWcgb2YgUkpFLgogICAgICogCiAgICAgKiBAdHlwZSB7ZnVuY3Rpb259CiAgICAgKiBAc3ludGF4IFV0aWwua2V5U29ydGVkT2JqZWN0KG9iaik7CiAgICAgKiBAcGFyYW0ge29iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gc29ydCBrZXlzIGZvci4KICAgICAqIEByZXR1cm4ge29iamVjdH0gQSBuZXcgb2JqZWN0IHdpdGggdGhlIHNhbWUga2V5cy92YWx1ZXMgYXMgdGhlIG9iaiwgYnV0IGluc2VydGVkIGluIGFscGhhYmV0aWNhbCBvcmRlcgogICAgICogQG5hbWUgVXRpbC5rZXlTb3J0ZWRPYmplY3QKICAgICAqIEBleGFtcGxlIFV0aWwua2V5U29ydGVkT2JqZWN0KCB7IGVsZW1lbnROYW1lOiAndGl0bGUnLCBlbGVtZW50VmFsdWU6ICdEZW4gZ2FtbGUgbWFuZCBvZyBoYXZldCcsIGVsZW1lbnRQcm9wZXJ0eTogImZ1bGwiIH0pOwogICAgICogLy9yZXR1cm5zIHsgZWxlbWVudE5hbWU6ICd0aXRsZScsIGVsZW1lbnRQcm9wZXJ0eTogImZ1bGwiLCBlbGVtZW50VmFsdWU6ICdEZW4gZ2FtbGUgbWFuZCBvZyBoYXZldCcgfQogICAgICogCiAgICAgKiBAbWV0aG9kICovCgogICAgZnVuY3Rpb24ga2V5U29ydGVkT2JqZWN0KCBvYmogKSB7CgogICAgICAgIGlmICggb2JqID09PSBudWxsIHx8IHR5cGVvZiggb2JqICkgIT09ICJvYmplY3QiIHx8ICggb2JqIGluc3RhbmNlb2YgQXJyYXkgKSB8fCAoIG9iaiBpbnN0YW5jZW9mIERhdGUgKSApIHsKICAgICAgICAgICAgcmV0dXJuIG9iajsKICAgICAgICB9CiAgICAgICAgdmFyIHJlc3VsdCA9IHt9OwogICAgICAgIF8ua2V5cyggb2JqICkuc29ydCggKS5mb3JFYWNoKCBmdW5jdGlvbigga2V5ICkgewogICAgICAgICAgICByZXN1bHRbIGtleSBdID0gb2JqWyBrZXkgXTsKICAgICAgICB9ICk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAvKioKICAgICAqIE1ldGhvZCB0aGF0IGhhbmRsZXMgbnVtZXJpYyBzb3J0aW5nIG9mIGFuIGFycmF5LgogICAgICoKICAgICAqIEB0eXBlIHtmdW5jdGlvbn0KICAgICAqIEBzeW50YXggVXRpbC5zb3J0QXJyYXlPZk51bWJlcnMoIGFycmF5LCBbbW9kZV0gKQogICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgQW4gYXJyYXkgY29udGFpbmluZyBudW1iZXJzLiBUaGUgbnVtYmVycyBhcmUgYWxzbyBhbGxvd2VkIGFzIHN0cmluZ3MuCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW21vZGVdIEEgImQiIGdpdmluZyBkZXNjZW5kaW5nIG9yZGVyIG9yIGFueXRoaW5nIGVsc2UgZ2l2aW5nIGFzY2VuZGluZyBvcmRlcgogICAgICogQHJldHVybiB7QXJyYXl9IEEgbmV3IGFycmF5IGNvbnRhaW5pbmcgc29ydGVkIG51bWJlcnMKICAgICAqIEBleGFtcGxlIFV0aWwuc29ydEFycmF5T2ZOdW1iZXJzKCBbIDMsIDcsIDEyLCAxLCAxMDAsIDQ3IF0sICJkIiApCiAgICAgKiAvL3JldHVybnMgWyAxMDAsIDQ3LCAxMiwgNywgMywgMSBdCiAgICAgKiAgCiAgICAgKiBAZXhhbXBsZSBVdGlsLnNvcnRBcnJheU9mTnVtYmVycyggWyAiMDIwIiwgIjMiLCAiNzUiICwiMzAxIiwgIjAwMSIgXSApCiAgICAgKiAvLyByZXR1cm5zIFsgIjAwMSIsICIzIiwgIjAyMCIsICI3NSIgLCIzMDEiIF0KICAgICAqIAogICAgICogQG1ldGhvZAogICAgICogQG5hbWUgVXRpbC5zb3J0QXJyYXlPZk51bWJlcnMKICAgICAqLwogICAgZnVuY3Rpb24gc29ydEFycmF5T2ZOdW1iZXJzKCBhcnJheSwgbW9kZSApIHsKCiAgICAgICAgYXJyYXkuc29ydCggZnVuY3Rpb24oIGEsIGIgKSB7CiAgICAgICAgICAgIGlmICggbW9kZSAhPT0gImQiICkgewogICAgICAgICAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGIgLSBhOwogICAgICAgICAgICB9CiAgICAgICAgfSApOwoKICAgICAgICByZXR1cm4gYXJyYXk7CgogICAgfQoKICAgIC8qKgogICAgICogTWV0aG9kIHRoYXQgaGFuZGxlcyBhbHBoYWJldGljYWwgc29ydGluZyBvbiBhIHNwZWNpZmllZCBwcm9wZXJ0eSBmb3IgYW4gYXJyYXkgb2Ygb2JqZWN0cy4KICAgICAqCiAgICAgKiBAdHlwZSB7ZnVuY3Rpb259CiAgICAgKiBAc3ludGF4IFV0aWwuc29ydEFycmF5T2ZPYmplY3RzKCBhcnJheSwgcHJvcGVydHkgKQogICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgQW4gYXJyYXkgY29udGFpbmluZyBvYmplY3RzCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvcGVydHkgVGhlIG5hbWUgb2YgdGhlIHByb3BlcnR5IHVzZWQgZm9yIHNvcnRpbmcKICAgICAqIEByZXR1cm4ge0FycmF5fSBBIG5ldyBhcnJheSBjb250YWluaW5nIHNvcnRlZCBvYmplY3RzCiAgICAgKiBAZXhhbXBsZSBVdGlsLnNvcnRBcnJheU9mT2JqZWN0cyggWyB7ICJ2YWx1ZSI6ICJoZXN0IiwgInR5cGUiOiAiYW5pbWFsIiB9LHsgInZhbHVlIjogImtvIiwgInR5cGUiOiAiYW5pbWFsIiB9LHsgInZhbHVlIjogImdyaXMiLCAidHlwZSI6ICJhbmltYWwiIH0gXSwgInZhbHVlIiApIAogICAgICogLy8gcmV0dXJucyBbIHsgInZhbHVlIjogImdyaXMiLCAidHlwZSI6ICJhbmltYWwiIH0sIHsgInZhbHVlIjogImhlc3QiLCAidHlwZSI6ICJhbmltYWwiIH0seyAidmFsdWUiOiAia28iLCAidHlwZSI6ICJhbmltYWwiIH0gXQogICAgICogCiAgICAgKiBAbWV0aG9kCiAgICAgKiBAbmFtZSBVdGlsLnNvcnRBcnJheU9mT2JqZWN0cwogICAgICovCiAgICBmdW5jdGlvbiBzb3J0QXJyYXlPZk9iamVjdHMoIGFycmF5LCBwcm9wZXJ0eSApIHsKCiAgICAgICAgTG9nLnRyYWNlKCAiRW50ZXJpbmc6IFV0aWwuc29ydEFycmF5T2ZPYmplY3RzIG1ldGhvZCIgKTsKCiAgICAgICAgdmFyIHNvcnRlZEFycmF5ID0gYXJyYXkuc29ydCggZnVuY3Rpb24oIGEsIGIgKSB7CiAgICAgICAgICAgIGlmICggYVsgcHJvcGVydHkgXSA8IGJbIHByb3BlcnR5IF0gKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCBhWyBwcm9wZXJ0eSBdID4gYlsgcHJvcGVydHkgXSApIHsKICAgICAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0gKTsKCiAgICAgICAgTG9nLnRyYWNlKCAiTGVhdmluZzogVXRpbC5zb3J0QXJyYXlPZk9iamVjdHMgbWV0aG9kIiApOwoKICAgICAgICByZXR1cm4gc29ydGVkQXJyYXk7CgogICAgfQoKICAgIC8qKgogICAgICogTWV0aG9kIHRoYXQgcmVtb3ZlcyBkdXBsaWNhdGUgb2JqZWN0cyBpbiBhbiBhcnJheS4KICAgICAqCiAgICAgKiBAdHlwZSB7ZnVuY3Rpb259CiAgICAgKiBAc3ludGF4IFV0aWwudW5pcXVlT2JqZWN0c0luQXJyYXkoIGFycmF5T2ZPYmplY3RzICkKICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IEFuIGFycmF5IGNvbnRhaW5pbmcgT2JqZWN0cwogICAgICogQHJldHVybiB7QXJyYXl9IEEgbmV3IGFycmF5IGNvbnRhaW5pbmcgb25seSB1bmlxdWUgb2JqZWN0cwogICAgICogQGV4YW1wbGUgVXRpbC51bmlxdWVPYmplY3RzSW5BcnJheSggWyB7ICJhbmltYWwiOiAiaG9yc2UiLCAiY29sb3VyIjogImJyb3duIiB9LHsgImFuaW1hbCI6ICJob3JzZSIsICJjb2xvdXIiOiAiYmxhY2siIH0seyAiYW5pbWFsIjogImhvcnNlIiwgImNvbG91ciI6ICJicm93biIgfSBdICkKICAgICAqIC8vcmV0dXJucyBbIHsgImFuaW1hbCI6ICJob3JzZSIsICJjb2xvdXIiOiAiYmxhY2siIH0seyAiYW5pbWFsIjogImhvcnNlIiwgImNvbG91ciI6ICJicm93biIgfSBdCiAgICAgKiAKICAgICAqIEBtZXRob2QKICAgICAqIEBuYW1lIFV0aWwudW5pcXVlT2JqZWN0c0luQXJyYXkKICAgICAqLwoKICAgIGZ1bmN0aW9uIHVuaXF1ZU9iamVjdHNJbkFycmF5KCBhcnJheU9mT2JqZWN0cyApIHsKCiAgICAgICAgdmFyIG51bWJlck9mT2JqZWN0cyA9IGFycmF5T2ZPYmplY3RzLmxlbmd0aDsKICAgICAgICB2YXIgYXJyYXlPZlVuaXF1ZU9iamVjdHMgPSBbIF07CiAgICAgICAgZm9yICggdmFyIGogPSAwOyBqIDwgYXJyYXlPZk9iamVjdHMubGVuZ3RoOyBqKysgKSB7CiAgICAgICAgICAgIHZhciByZXN0ID0gYXJyYXlPZk9iamVjdHMuc2xpY2UoIGogKyAxLCBudW1iZXJPZk9iamVjdHMgKQogICAgICAgICAgICB2YXIgY3VycmVudE9iamVjdCA9IGFycmF5T2ZPYmplY3RzWyBqIF07CiAgICAgICAgICAgIHZhciBpc1VuaXF1ZSA9IHRydWU7CiAgICAgICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IHJlc3QubGVuZ3RoOyBpKysgKSB7CiAgICAgICAgICAgICAgICBpZiAoIF8uaXNFcXVhbCggY3VycmVudE9iamVjdCwgcmVzdFsgaSBdICkgKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlzVW5pcXVlID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGlmICggdHJ1ZSA9PT0gaXNVbmlxdWUgKSB7CiAgICAgICAgICAgICAgICBhcnJheU9mVW5pcXVlT2JqZWN0cy5wdXNoKCBjdXJyZW50T2JqZWN0ICk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFycmF5T2ZVbmlxdWVPYmplY3RzOwogICAgfQoKCiAgICAvKioKICAgICAqIE1ldGhvZCB0aGF0IHJlbW92ZXMgZHVwbGljYXRlIHZhbHVlcyBpbiBhbiBhcnJheS4KICAgICAqIAogICAgICogQHR5cGUge2Z1bmN0aW9ufQogICAgICogQHN5bnRheCBVdGlsLnVuaXF1ZVZhbHVlcyggYXJyYXkgKQogICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIHNvcnRlZCBhcnJheSB3aGVyZSBkdXBsaWNhdGVzIG5lZWQgdG8gYmUgcmVtb3ZlZAogICAgICogQHJldHVybiB7QXJyYXl9IEFuIGFycmF5IGNvbnRhaW5pbmcgdW5pcXVlIHZhbHVlcwogICAgICogQGV4YW1wbGUgVXRpbC51bmlxdWVWYWx1ZXMoIFsgIjIwNyIsICIyMTciLCAiMjE3IiwgIjU4MyIsICIyMTciXSApCiAgICAgKiAvL3JldHVybnMgWyAiMjA3IiwgIjU4MyIsICIyMTciXQogICAgICogCiAgICAgKiBAbWV0aG9kCiAgICAgKiBAbmFtZSBVdGlsLnVuaXF1ZVZhbHVlcwogICAgICovCiAgICBmdW5jdGlvbiB1bmlxdWVWYWx1ZXMoIGFycmF5ICkgewoKICAgICAgICBMb2cudHJhY2UoICJFbnRlcmluZzogVXRpbC51bmlxdWVWYWx1ZXMgbWV0aG9kIiApOwoKICAgICAgICB2YXIgdW5pcXVlVmFsdWVBcnJheSA9IFsgXTsKICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKyApIHsKICAgICAgICAgICAgaWYgKCB1bmlxdWVWYWx1ZUFycmF5LmluZGV4T2YoIGFycmF5WyBpIF0gKSA8IDAgKSB7CiAgICAgICAgICAgICAgICB1bmlxdWVWYWx1ZUFycmF5LnB1c2goIGFycmF5WyBpIF0gKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgTG9nLnRyYWNlKCAiTGVhdmluZzogVXRpbC51bmlxdWVWYWx1ZXMgbWV0aG9kIiApOwoKICAgICAgICByZXR1cm4gdW5pcXVlVmFsdWVBcnJheTsKCiAgICB9CgogICAgcmV0dXJuIHsKCiAgICAgICAgYWRkVW5pcXVlT2JqZWN0VG9BcnJheTogYWRkVW5pcXVlT2JqZWN0VG9BcnJheSwKICAgICAgICBhcnJheU9mS2V5czogYXJyYXlPZktleXMsCiAgICAgICAgY3JlYXRlOiBjcmVhdGUsCQkKICAgICAgICBmb3JFYWNoR3JvdXBlZFJlZ0V4cE1hdGNoOiBmb3JFYWNoR3JvdXBlZFJlZ0V4cE1hdGNoLAogICAgICAgIGdldFR5cGU6IGdldFR5cGUsCiAgICAgICAgaXNFcXVhbDogaXNFcXVhbCwKCQlpc09iamVjdDogaXNPYmplY3QsCiAgICAgICAga2V5U29ydGVkT2JqZWN0OiBrZXlTb3J0ZWRPYmplY3QsCgkJc29ydEFycmF5T2ZOdW1iZXJzOiBzb3J0QXJyYXlPZk51bWJlcnMsCQkJCgkJc29ydEFycmF5T2ZPYmplY3RzOiBzb3J0QXJyYXlPZk9iamVjdHMsCQogICAgICAgIHVuaXF1ZU9iamVjdHNJbkFycmF5OiB1bmlxdWVPYmplY3RzSW5BcnJheSwKICAgICAgICB1bmlxdWVWYWx1ZXM6IHVuaXF1ZVZhbHVlcwoKICAgIH07Cgp9KCApOwoKLy8gdW5pdHRlc3RzIGFyZSBpbiBUZXN0VXRpbC51c2UuanMKLy8gKGJlY2F1c2UgdGhlIFVuaXRUZXN0IG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlIGZyb20gdGhpcyBtb2R1bGUpCg==", "moduleName": "Util"}, {"javascript": "LyoqIEBmaWxlIFByb3ZpZGUgYSBHbG9iYWwgc3ltYm9sICovCkVYUE9SVEVEX1NZTUJPTFMgPSBbICdHbG9iYWwnIF07CgovLyBJbXBvcnRhbnQgbm90ZTogVGhpcyBtb2R1bGUgY2FuIG5vdCB1c2UgdGhlIExvZyBtb2R1bGUsIGFzIHRoZSBMb2cKLy8gbW9kdWxlIHVzZXMgdGhpcyBtb2R1bGUuIEFuZCwgaG9uZXN0ZWx5LCB3aGF0IHdvdWxkIHlvdSBsb2c/Ci8vIFJpZ2h0LiBKdXN0IGRvbid0IGRvIGl0LiBOb3csIG1vdmUgYWxvbmcsIG5vdGhpbmcgdG8gc2VlIGhlcmUuCgovKioKICogUHJvdmlkZSBjb25zaXN0ZW50IGFjY2VzcyB0byB0aGUgR2xvYmFsIHZhcmlhYmxlLgogKgogKiBXaGVuIHVzZWQsIHRoaXMgbW9kdWxlIHdpbGwgaW50cm9kdWNlIGEgZ2xvYmFsIHZhcmlhYmxlIGNhbGxlZAogKiBgR2xvYmFsYCwgdGhhdCBpcyBhIHJlZmVyZW5jZSB0byB0aGUgdG9wbGV2ZWwgR2xvYmFsIG9iamVjdC4KICogCiAqIFRoaXMgbW9kdWxlIGRvZXMgbm90IHByb3ZpZGUgYW55IG1ldGhvZHMgb3IgbWVtYmVyLCBiZXNpZGVzIHRoZQogKiBHbG9iYWwgdmFyaWFibGUuCiAqCiAqIEB0eXBlIHtvYmplY3R9CiAqIEBleGFtcGxlCi8vIFRoaXMgbG9hZHMgdGhlIEdsb2JhbCBtb2R1bGUsIGFuZCBjcmVhdGVzIGEgdmFyaWFibGUgY2FsbGVkIEdsb2JhbAp1c2UoICJHbG9iYWwiICk7CiogQG5hbWVzcGFjZQogKiBAbmFtZSBHbG9iYWwgKi8KdmFyIEdsb2JhbCA9IGZ1bmN0aW9uKCApIHsKICAgIC8qKiBHZXQgYWNjZXNzIHRvIHRoZSBHbG9iYWwgdmFyaWFibGUuCiAgICAgKiAKICAgICAqIFRoaXMgZnVuY3Rpb24gcmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgdG9wbGV2ZWwgR2xvYmFsCiAgICAgKiB2YXJpYWJsZS4gSW4gbm9uLWJyb3dzZXIgZW52aXJvbm1lbnRzLCB0aGlzIGlzIGVxdWFsIHRvIHRoZQogICAgICogdGhpcyB2YXJpYWJsZSBhdCB0b3BsZXZlbCBzY29wZSwgYnV0IHJlcXVpcmVzIGEgYml0IG1vcmUgdG8gZ2V0CiAgICAgKiB0bywgaWYgbm90IGEgdG9wbGV2ZWwgc2NvcGUuCiAgICAgKiAKICAgICAqIEB0eXBle2Z1bmN0aW9ufQogICAgICogQHByaXZhdGUKICAgICAqIEByZXR1cm4ge29iamVjdH0gQSByZWZlcmVuY2UgdG8gdGhlIGdsb2JhbCBvYmplY3QgKi8KICAgIHZhciBnZXRHbG9iYWwgPSBmdW5jdGlvbiggKSB7CiAgICAgICAgcmV0dXJuICggZnVuY3Rpb24oICkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgIH0gKSggKTsKICAgIH07CiAgICAvLyByZXR1cm4gcmVzdWx0IG9mIGNhbGwgdG8gZ2V0R2xvYmFsLCBpLmUuIHJlZiB0byBnbG9iYWwKICAgIHJldHVybiBnZXRHbG9iYWwoICk7Cn0oICk7Cg==", "moduleName": "Global"}], "svnRevision": 82808, "requireCache": null, "invocationMethod": "flowComponentTwo", "invocationJavascriptName": "trunk/flowcomponentTwo.js", "svnProjectForInvocationJavascript": "dataio-js-test-projects"}, "version": 6}], "description": "Vi tester om vi kan lave et flow med flere flowkomponenter"}', 22);


--
-- PostgreSQL database dump complete
--

